{"version":3,"file":"docmanager.min.js","sources":["../node_modules/tslib/tslib.es6.js","../node_modules/@xbs/filemanager/codebase/filemanager.js","../node_modules/jet-restate/index.js","../sources/helpers/icons.js","../node_modules/jet-hotkey/index.js","../sources/helpers/dataview.js","../sources/views/cards.js","../sources/views/editor.js","../sources/views/excel.js","../sources/views/folders.js","../sources/views/history.js","../sources/views/list.js","../sources/views/menus/menubody.js","../sources/views/menus/popup.js","../sources/helpers/avatar.js","../sources/views/menus/sharepopup.js","../sources/helpers/common.js","../sources/views/menus/tagspopup.js","../sources/views/panel-double.js","../sources/views/panel.js","../sources/views/preview/comments.js","../sources/views/preview/index.js","../sources/views/preview/info.js","../sources/views/top.js","../sources/views/topbar.js","../sources/export_views.js","../sources/models/Backend.js","../sources/models/LocalData.js","../sources/models/Operations.js","../sources/models/Users.js","../sources/models/LocalUsers.js","../sources/models/Tags.js","../sources/models/LocalTags.js","../sources/models/Versions.js","../sources/app.js","../sources/locales/en.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/*\n@license\nWebix FileManager v.8.0.0\nThis software is covered by Webix Commercial License.\nUsage without proper license is prohibited.\n(c) XB Software Ltd.\n*/\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = global || self, factory(global.fileManager = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var NavigationBlocked = (function () {\n        function NavigationBlocked() {\n        }\n        return NavigationBlocked;\n    }());\n    var JetBase = (function () {\n        function JetBase(webix, config) {\n            this.webixJet = true;\n            this.webix = webix;\n            this._events = [];\n            this._subs = {};\n            this._data = {};\n            if (config && config.params)\n                webix.extend(this._data, config.params);\n        }\n        JetBase.prototype.getRoot = function () {\n            return this._root;\n        };\n        JetBase.prototype.destructor = function () {\n            this._detachEvents();\n            this._destroySubs();\n            this._events = this._container = this.app = this._parent = this._root = null;\n        };\n        JetBase.prototype.setParam = function (id, value, url) {\n            if (this._data[id] !== value) {\n                this._data[id] = value;\n                this._segment.update(id, value, 0);\n                if (url) {\n                    return this.show(null);\n                }\n            }\n        };\n        JetBase.prototype.getParam = function (id, parent) {\n            var value = this._data[id];\n            if (typeof value !== \"undefined\" || !parent) {\n                return value;\n            }\n            var view = this.getParentView();\n            if (view) {\n                return view.getParam(id, parent);\n            }\n        };\n        JetBase.prototype.getUrl = function () {\n            return this._segment.suburl();\n        };\n        JetBase.prototype.getUrlString = function () {\n            return this._segment.toString();\n        };\n        JetBase.prototype.getParentView = function () {\n            return this._parent;\n        };\n        JetBase.prototype.$$ = function (id) {\n            if (typeof id === \"string\") {\n                var root_1 = this.getRoot();\n                return root_1.queryView((function (obj) { return (obj.config.id === id || obj.config.localId === id) &&\n                    (obj.$scope === root_1.$scope); }), \"self\");\n            }\n            else {\n                return id;\n            }\n        };\n        JetBase.prototype.on = function (obj, name, code) {\n            var id = obj.attachEvent(name, code);\n            this._events.push({ obj: obj, id: id });\n            return id;\n        };\n        JetBase.prototype.contains = function (view) {\n            for (var key in this._subs) {\n                var kid = this._subs[key].view;\n                if (kid === view || kid.contains(view)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        JetBase.prototype.getSubView = function (name) {\n            var sub = this.getSubViewInfo(name);\n            if (sub) {\n                return sub.subview.view;\n            }\n        };\n        JetBase.prototype.getSubViewInfo = function (name) {\n            var sub = this._subs[name || \"default\"];\n            if (sub) {\n                return { subview: sub, parent: this };\n            }\n            if (name === \"_top\") {\n                this._subs[name] = { url: \"\", id: null, popup: true };\n                return this.getSubViewInfo(name);\n            }\n            if (this._parent) {\n                return this._parent.getSubViewInfo(name);\n            }\n            return null;\n        };\n        JetBase.prototype._detachEvents = function () {\n            var events = this._events;\n            for (var i = events.length - 1; i >= 0; i--) {\n                events[i].obj.detachEvent(events[i].id);\n            }\n        };\n        JetBase.prototype._destroySubs = function () {\n            for (var key in this._subs) {\n                var subView = this._subs[key].view;\n                if (subView) {\n                    subView.destructor();\n                }\n            }\n            this._subs = {};\n        };\n        JetBase.prototype._init_url_data = function () {\n            var url = this._segment.current();\n            this._data = {};\n            this.webix.extend(this._data, url.params, true);\n        };\n        JetBase.prototype._getDefaultSub = function () {\n            if (this._subs.default) {\n                return this._subs.default;\n            }\n            for (var key in this._subs) {\n                var sub = this._subs[key];\n                if (!sub.branch && sub.view && key !== \"_top\") {\n                    var child = sub.view._getDefaultSub();\n                    if (child) {\n                        return child;\n                    }\n                }\n            }\n        };\n        JetBase.prototype._routed_view = function () {\n            var parent = this.getParentView();\n            if (!parent) {\n                return true;\n            }\n            var sub = parent._getDefaultSub();\n            if (!sub && sub !== this) {\n                return false;\n            }\n            return parent._routed_view();\n        };\n        return JetBase;\n    }());\n    function parse(url) {\n        if (url[0] === \"/\") {\n            url = url.substr(1);\n        }\n        var parts = url.split(\"/\");\n        var chunks = [];\n        for (var i = 0; i < parts.length; i++) {\n            var test = parts[i];\n            var result = {};\n            var pos = test.indexOf(\":\");\n            if (pos === -1) {\n                pos = test.indexOf(\"?\");\n            }\n            if (pos !== -1) {\n                var params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\n                for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n                    var param = params_1[_i];\n                    var dchunk = param.split(\"=\");\n                    result[dchunk[0]] = decodeURIComponent(dchunk[1]);\n                }\n            }\n            chunks[i] = {\n                page: (pos > -1 ? test.substr(0, pos) : test),\n                params: result,\n                isNew: true\n            };\n        }\n        return chunks;\n    }\n    function url2str(stack) {\n        var url = [];\n        for (var _i = 0, stack_1 = stack; _i < stack_1.length; _i++) {\n            var chunk = stack_1[_i];\n            url.push(\"/\" + chunk.page);\n            var params = obj2str(chunk.params);\n            if (params) {\n                url.push(\"?\" + params);\n            }\n        }\n        return url.join(\"\");\n    }\n    function obj2str(obj) {\n        var str = [];\n        for (var key in obj) {\n            if (typeof obj[key] === \"object\")\n                continue;\n            if (str.length) {\n                str.push(\"&\");\n            }\n            str.push(key + \"=\" + encodeURIComponent(obj[key]));\n        }\n        return str.join(\"\");\n    }\n    var Route = (function () {\n        function Route(route, index) {\n            this._next = 1;\n            if (typeof route === \"string\") {\n                this.route = {\n                    url: parse(route),\n                    path: route\n                };\n            }\n            else {\n                this.route = route;\n            }\n            this.index = index;\n        }\n        Route.prototype.current = function () {\n            return this.route.url[this.index];\n        };\n        Route.prototype.next = function () {\n            return this.route.url[this.index + this._next];\n        };\n        Route.prototype.suburl = function () {\n            return this.route.url.slice(this.index);\n        };\n        Route.prototype.shift = function (params) {\n            var route = new Route(this.route, this.index + this._next);\n            route.setParams(route.route.url, params, route.index);\n            return route;\n        };\n        Route.prototype.setParams = function (url, params, index) {\n            if (params) {\n                var old = url[index].params;\n                for (var key in params)\n                    old[key] = params[key];\n            }\n        };\n        Route.prototype.refresh = function () {\n            var url = this.route.url;\n            for (var i = this.index + 1; i < url.length; i++) {\n                url[i].isNew = true;\n            }\n        };\n        Route.prototype.toString = function () {\n            var str = url2str(this.suburl());\n            return str ? str.substr(1) : \"\";\n        };\n        Route.prototype._join = function (path, kids) {\n            var url = this.route.url;\n            if (path === null) {\n                return url;\n            }\n            var old = this.route.url;\n            var reset = true;\n            url = old.slice(0, this.index + (kids ? this._next : 0));\n            if (path) {\n                url = url.concat(parse(path));\n                for (var i = 0; i < url.length; i++) {\n                    if (old[i]) {\n                        url[i].view = old[i].view;\n                    }\n                    if (reset && old[i] && url[i].page === old[i].page) {\n                        url[i].isNew = false;\n                    }\n                    else if (url[i].isNew) {\n                        reset = false;\n                    }\n                }\n            }\n            return url;\n        };\n        Route.prototype.append = function (path) {\n            var url = this._join(path, true);\n            this.route.path = url2str(url);\n            this.route.url = url;\n            return this.route.path;\n        };\n        Route.prototype.show = function (path, view, kids) {\n            var _this = this;\n            var url = this._join(path.url, kids);\n            this.setParams(url, path.params, this.index + (kids ? this._next : 0));\n            return new Promise(function (res, rej) {\n                var redirect = url2str(url);\n                var obj = {\n                    url: url,\n                    redirect: redirect,\n                    confirm: Promise.resolve()\n                };\n                var app = view ? view.app : null;\n                if (app) {\n                    var result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n                    if (!result) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                }\n                obj.confirm.catch(function (err) { return rej(err); }).then(function () {\n                    if (obj.redirect === null) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    if (obj.redirect !== redirect) {\n                        app.show(obj.redirect);\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    _this.route.path = redirect;\n                    _this.route.url = url;\n                    res();\n                });\n            });\n        };\n        Route.prototype.size = function (n) {\n            this._next = n;\n        };\n        Route.prototype.split = function () {\n            var route = {\n                url: this.route.url.slice(this.index + 1),\n                path: \"\"\n            };\n            if (route.url.length) {\n                route.path = url2str(route.url);\n            }\n            return new Route(route, 0);\n        };\n        Route.prototype.update = function (name, value, index) {\n            var chunk = this.route.url[this.index + (index || 0)];\n            if (!chunk) {\n                this.route.url.push({ page: \"\", params: {} });\n                return this.update(name, value, index);\n            }\n            if (name === \"\") {\n                chunk.page = value;\n            }\n            else {\n                chunk.params[name] = value;\n            }\n            this.route.path = url2str(this.route.url);\n        };\n        return Route;\n    }());\n    var JetView = (function (_super) {\n        __extends(JetView, _super);\n        function JetView(app, config) {\n            var _this = _super.call(this, app.webix) || this;\n            _this.app = app;\n            _this._children = [];\n            return _this;\n        }\n        JetView.prototype.ui = function (ui, config) {\n            config = config || {};\n            var container = config.container || ui.container;\n            var jetview = this.app.createView(ui);\n            this._children.push(jetview);\n            jetview.render(container, this._segment, this);\n            if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\n                return jetview;\n            }\n            else {\n                return jetview.getRoot();\n            }\n        };\n        JetView.prototype.show = function (path, config) {\n            config = config || {};\n            if (typeof path === \"object\") {\n                for (var key in path) {\n                    this.setParam(key, path[key]);\n                }\n                path = null;\n            }\n            else {\n                if (path.substr(0, 1) === \"/\") {\n                    return this.app.show(path, config);\n                }\n                if (path.indexOf(\"./\") === 0) {\n                    path = path.substr(2);\n                }\n                if (path.indexOf(\"../\") === 0) {\n                    var parent_1 = this.getParentView();\n                    if (parent_1) {\n                        return parent_1.show(path.substr(3), config);\n                    }\n                    else {\n                        return this.app.show(\"/\" + path.substr(3));\n                    }\n                }\n                var sub = this.getSubViewInfo(config.target);\n                if (sub) {\n                    if (sub.parent !== this) {\n                        return sub.parent.show(path, config);\n                    }\n                    else if (config.target && config.target !== \"default\") {\n                        return this._renderFrameLock(config.target, sub.subview, {\n                            url: path,\n                            params: config.params,\n                        });\n                    }\n                }\n                else {\n                    if (path) {\n                        return this.app.show(\"/\" + path, config);\n                    }\n                }\n            }\n            return this._show(this._segment, { url: path, params: config.params }, this);\n        };\n        JetView.prototype._show = function (segment, path, view) {\n            var _this = this;\n            return segment.show(path, view, true).then(function () {\n                _this._init_url_data();\n                return _this._urlChange();\n            }).then(function () {\n                if (segment.route.linkRouter) {\n                    _this.app.getRouter().set(segment.route.path, { silent: true });\n                    _this.app.callEvent(\"app:route\", [segment.route.path]);\n                }\n            });\n        };\n        JetView.prototype.init = function (_$view, _$) {\n        };\n        JetView.prototype.ready = function (_$view, _$url) {\n        };\n        JetView.prototype.config = function () {\n            this.app.webix.message(\"View:Config is not implemented\");\n        };\n        JetView.prototype.urlChange = function (_$view, _$url) {\n        };\n        JetView.prototype.destroy = function () {\n        };\n        JetView.prototype.destructor = function () {\n            this.destroy();\n            this._destroyKids();\n            if (this._root) {\n                this._root.destructor();\n                _super.prototype.destructor.call(this);\n            }\n        };\n        JetView.prototype.use = function (plugin, config) {\n            plugin(this.app, this, config);\n        };\n        JetView.prototype.refresh = function () {\n            var url = this.getUrl();\n            this.destroy();\n            this._destroyKids();\n            this._destroySubs();\n            this._detachEvents();\n            if (this._container.tagName) {\n                this._root.destructor();\n            }\n            this._segment.refresh();\n            return this._render(this._segment);\n        };\n        JetView.prototype.render = function (root, url, parent) {\n            var _this = this;\n            if (typeof url === \"string\") {\n                url = new Route(url, 0);\n            }\n            this._segment = url;\n            this._parent = parent;\n            this._init_url_data();\n            root = root || document.body;\n            var _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n            if (this._container !== _container) {\n                this._container = _container;\n                return this._render(url);\n            }\n            else {\n                return this._urlChange().then(function () { return _this.getRoot(); });\n            }\n        };\n        JetView.prototype._render = function (url) {\n            var _this = this;\n            var config = this.config();\n            if (config.then) {\n                return config.then(function (cfg) { return _this._render_final(cfg, url); });\n            }\n            else {\n                return this._render_final(config, url);\n            }\n        };\n        JetView.prototype._render_final = function (config, url) {\n            var _this = this;\n            var slot = null;\n            var container = null;\n            var show = false;\n            if (!this._container.tagName) {\n                slot = this._container;\n                if (slot.popup) {\n                    container = document.body;\n                    show = true;\n                }\n                else {\n                    container = this.webix.$$(slot.id);\n                }\n            }\n            else {\n                container = this._container;\n            }\n            if (!this.app || !container) {\n                return Promise.reject(null);\n            }\n            var response;\n            var current = this._segment.current();\n            var result = { ui: {} };\n            this.app.copyConfig(config, result.ui, this._subs);\n            this.app.callEvent(\"app:render\", [this, url, result]);\n            result.ui.$scope = this;\n            if (!slot && current.isNew && current.view) {\n                current.view.destructor();\n            }\n            try {\n                if (slot && !show) {\n                    var oldui = container;\n                    var parent_2 = oldui.getParentView();\n                    if (parent_2 && parent_2.name === \"multiview\" && !result.ui.id) {\n                        result.ui.id = oldui.config.id;\n                    }\n                }\n                this._root = this.app.webix.ui(result.ui, container);\n                var asWin = this._root;\n                if (show && asWin.setPosition && !asWin.isVisible()) {\n                    asWin.show();\n                }\n                if (slot) {\n                    if (slot.view && slot.view !== this && slot.view !== this.app) {\n                        slot.view.destructor();\n                    }\n                    slot.id = this._root.config.id;\n                    if (this.getParentView() || !this.app.app)\n                        slot.view = this;\n                    else {\n                        slot.view = this.app;\n                    }\n                }\n                if (current.isNew) {\n                    current.view = this;\n                    current.isNew = false;\n                }\n                response = Promise.resolve(this._init(this._root, url)).then(function () {\n                    return _this._urlChange().then(function () {\n                        _this._initUrl = null;\n                        return _this.ready(_this._root, url.suburl());\n                    });\n                });\n            }\n            catch (e) {\n                response = Promise.reject(e);\n            }\n            return response.catch(function (err) { return _this._initError(_this, err); });\n        };\n        JetView.prototype._init = function (view, url) {\n            return this.init(view, url.suburl());\n        };\n        JetView.prototype._urlChange = function () {\n            var _this = this;\n            this.app.callEvent(\"app:urlchange\", [this, this._segment]);\n            var waits = [];\n            for (var key in this._subs) {\n                var frame = this._subs[key];\n                var wait = this._renderFrameLock(key, frame, null);\n                if (wait) {\n                    waits.push(wait);\n                }\n            }\n            return Promise.all(waits).then(function () {\n                return _this.urlChange(_this._root, _this._segment.suburl());\n            });\n        };\n        JetView.prototype._renderFrameLock = function (key, frame, path) {\n            if (!frame.lock) {\n                var lock = this._renderFrame(key, frame, path);\n                if (lock) {\n                    frame.lock = lock.then(function () { return frame.lock = null; }, function () { return frame.lock = null; });\n                }\n            }\n            return frame.lock;\n        };\n        JetView.prototype._renderFrame = function (key, frame, path) {\n            var _this = this;\n            if (key === \"default\") {\n                if (this._segment.next()) {\n                    var params = path ? path.params : null;\n                    if (frame.params) {\n                        params = this.webix.extend(params || {}, frame.params);\n                    }\n                    return this._createSubView(frame, this._segment.shift(params));\n                }\n                else if (frame.view && frame.popup) {\n                    frame.view.destructor();\n                    frame.view = null;\n                }\n            }\n            if (path !== null) {\n                frame.url = path.url;\n                if (frame.params) {\n                    path.params = this.webix.extend(path.params || {}, frame.params);\n                }\n            }\n            if (frame.route) {\n                if (path !== null) {\n                    return frame.route.show(path, frame.view).then(function () {\n                        return _this._createSubView(frame, frame.route);\n                    });\n                }\n                if (frame.branch) {\n                    return;\n                }\n            }\n            var view = frame.view;\n            if (!view && frame.url) {\n                if (typeof frame.url === \"string\") {\n                    frame.route = new Route(frame.url, 0);\n                    if (path)\n                        frame.route.setParams(frame.route.route.url, path.params, 0);\n                    if (frame.params)\n                        frame.route.setParams(frame.route.route.url, frame.params, 0);\n                    return this._createSubView(frame, frame.route);\n                }\n                else {\n                    if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\n                        view = new (this.app._override(frame.url))(this.app, \"\");\n                    }\n                    if (!view) {\n                        view = frame.url;\n                    }\n                }\n            }\n            if (view) {\n                return view.render(frame, (frame.route || this._segment), this);\n            }\n        };\n        JetView.prototype._initError = function (view, err) {\n            if (this.app) {\n                this.app.error(\"app:error:initview\", [err, view]);\n            }\n            return true;\n        };\n        JetView.prototype._createSubView = function (sub, suburl) {\n            var _this = this;\n            return this.app.createFromURL(suburl.current()).then(function (view) {\n                return view.render(sub, suburl, _this);\n            });\n        };\n        JetView.prototype._destroyKids = function () {\n            var uis = this._children;\n            for (var i = uis.length - 1; i >= 0; i--) {\n                if (uis[i] && uis[i].destructor) {\n                    uis[i].destructor();\n                }\n            }\n            this._children = [];\n        };\n        return JetView;\n    }(JetBase));\n    var JetViewRaw = (function (_super) {\n        __extends(JetViewRaw, _super);\n        function JetViewRaw(app, config) {\n            var _this = _super.call(this, app, config) || this;\n            _this._ui = config.ui;\n            return _this;\n        }\n        JetViewRaw.prototype.config = function () {\n            return this._ui;\n        };\n        return JetViewRaw;\n    }(JetView));\n    var SubRouter = (function () {\n        function SubRouter(cb, config, app) {\n            this.path = \"\";\n            this.app = app;\n        }\n        SubRouter.prototype.set = function (path, config) {\n            this.path = path;\n            var a = this.app;\n            a.app.getRouter().set(a._segment.append(this.path), { silent: true });\n        };\n        SubRouter.prototype.get = function () {\n            return this.path;\n        };\n        return SubRouter;\n    }());\n    var _once = true;\n    var JetAppBase = (function (_super) {\n        __extends(JetAppBase, _super);\n        function JetAppBase(config) {\n            var _this = this;\n            var webix = (config || {}).webix || window.webix;\n            config = webix.extend({\n                name: \"App\",\n                version: \"1.0\",\n                start: \"/home\"\n            }, config, true);\n            _this = _super.call(this, webix, config) || this;\n            _this.config = config;\n            _this.app = _this.config.app;\n            _this.ready = Promise.resolve();\n            _this._services = {};\n            _this.webix.extend(_this, _this.webix.EventSystem);\n            return _this;\n        }\n        JetAppBase.prototype.getUrl = function () {\n            return this._subSegment.suburl();\n        };\n        JetAppBase.prototype.getUrlString = function () {\n            return this._subSegment.toString();\n        };\n        JetAppBase.prototype.getService = function (name) {\n            var obj = this._services[name];\n            if (typeof obj === \"function\") {\n                obj = this._services[name] = obj(this);\n            }\n            return obj;\n        };\n        JetAppBase.prototype.setService = function (name, handler) {\n            this._services[name] = handler;\n        };\n        JetAppBase.prototype.destructor = function () {\n            this.getSubView().destructor();\n            _super.prototype.destructor.call(this);\n        };\n        JetAppBase.prototype.copyConfig = function (obj, target, config) {\n            if (obj instanceof JetBase ||\n                (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\n                obj = { $subview: obj };\n            }\n            if (typeof obj.$subview != \"undefined\") {\n                return this.addSubView(obj, target, config);\n            }\n            var isArray = obj instanceof Array;\n            target = target || (isArray ? [] : {});\n            for (var method in obj) {\n                var point = obj[method];\n                if (typeof point === \"function\" && point.prototype instanceof JetBase) {\n                    point = { $subview: point };\n                }\n                if (point && typeof point === \"object\" &&\n                    !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n                    if (point instanceof Date) {\n                        target[method] = new Date(point);\n                    }\n                    else {\n                        var copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\n                        if (copy !== null) {\n                            if (isArray)\n                                target.push(copy);\n                            else\n                                target[method] = copy;\n                        }\n                    }\n                }\n                else {\n                    target[method] = point;\n                }\n            }\n            return target;\n        };\n        JetAppBase.prototype.getRouter = function () {\n            return this.$router;\n        };\n        JetAppBase.prototype.clickHandler = function (e, target) {\n            if (e) {\n                target = target || (e.target || e.srcElement);\n                if (target && target.getAttribute) {\n                    var trigger_1 = target.getAttribute(\"trigger\");\n                    if (trigger_1) {\n                        this._forView(target, function (view) { return view.app.trigger(trigger_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                    var route_1 = target.getAttribute(\"route\");\n                    if (route_1) {\n                        this._forView(target, function (view) { return view.show(route_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                }\n            }\n            var parent = target.parentNode;\n            if (parent) {\n                this.clickHandler(e, parent);\n            }\n        };\n        JetAppBase.prototype.getRoot = function () {\n            return this.getSubView().getRoot();\n        };\n        JetAppBase.prototype.refresh = function () {\n            var _this = this;\n            if (!this._subSegment) {\n                return Promise.resolve(null);\n            }\n            return this.getSubView().refresh().then(function (view) {\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return view;\n            });\n        };\n        JetAppBase.prototype.loadView = function (url) {\n            var _this = this;\n            var views = this.config.views;\n            var result = null;\n            if (url === \"\") {\n                return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\n            }\n            try {\n                if (views) {\n                    if (typeof views === \"function\") {\n                        result = views(url);\n                    }\n                    else {\n                        result = views[url];\n                    }\n                    if (typeof result === \"string\") {\n                        url = result;\n                        result = null;\n                    }\n                }\n                if (!result) {\n                    if (url === \"_hidden\") {\n                        result = { hidden: true };\n                    }\n                    else if (url === \"_blank\") {\n                        result = {};\n                    }\n                    else {\n                        url = url.replace(/\\./g, \"/\");\n                        result = this.require(\"jet-views\", url);\n                    }\n                }\n            }\n            catch (e) {\n                result = this._loadError(url, e);\n            }\n            if (!result.then) {\n                result = Promise.resolve(result);\n            }\n            result = result\n                .then(function (module) { return module.__esModule ? module.default : module; })\n                .catch(function (err) { return _this._loadError(url, err); });\n            return result;\n        };\n        JetAppBase.prototype._forView = function (target, handler) {\n            var view = this.webix.$$(target);\n            if (view) {\n                handler(view.$scope);\n            }\n        };\n        JetAppBase.prototype._loadViewDynamic = function (url) {\n            return null;\n        };\n        JetAppBase.prototype.createFromURL = function (chunk) {\n            var _this = this;\n            var view;\n            if (chunk.isNew || !chunk.view) {\n                view = this.loadView(chunk.page)\n                    .then(function (ui) { return _this.createView(ui, name, chunk.params); });\n            }\n            else {\n                view = Promise.resolve(chunk.view);\n            }\n            return view;\n        };\n        JetAppBase.prototype._override = function (ui) {\n            var over = this.config.override;\n            if (over) {\n                var dv = void 0;\n                while (ui) {\n                    dv = ui;\n                    ui = over.get(ui);\n                }\n                return dv;\n            }\n            return ui;\n        };\n        JetAppBase.prototype.createView = function (ui, name, params) {\n            ui = this._override(ui);\n            var obj;\n            if (typeof ui === \"function\") {\n                if (ui.prototype instanceof JetAppBase) {\n                    return new ui({ app: this, name: name, params: params, router: SubRouter });\n                }\n                else if (ui.prototype instanceof JetBase) {\n                    return new ui(this, { name: name, params: params });\n                }\n                else {\n                    ui = ui(this);\n                }\n            }\n            if (ui instanceof JetBase) {\n                obj = ui;\n            }\n            else {\n                obj = new JetViewRaw(this, { name: name, ui: ui });\n            }\n            return obj;\n        };\n        JetAppBase.prototype.show = function (url, config) {\n            if (url && this.app && url.indexOf(\"//\") == 0)\n                return this.app.show(url.substr(1), config);\n            return this.render(this._container, url || this.config.start, config);\n        };\n        JetAppBase.prototype.trigger = function (name) {\n            var rest = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                rest[_i - 1] = arguments[_i];\n            }\n            this.apply(name, rest);\n        };\n        JetAppBase.prototype.apply = function (name, data) {\n            this.callEvent(name, data);\n        };\n        JetAppBase.prototype.action = function (name) {\n            return this.webix.bind(function () {\n                var rest = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    rest[_i] = arguments[_i];\n                }\n                this.apply(name, rest);\n            }, this);\n        };\n        JetAppBase.prototype.on = function (name, handler) {\n            this.attachEvent(name, handler);\n        };\n        JetAppBase.prototype.use = function (plugin, config) {\n            plugin(this, null, config);\n        };\n        JetAppBase.prototype.error = function (name, er) {\n            this.callEvent(name, er);\n            this.callEvent(\"app:error\", er);\n            if (this.config.debug) {\n                for (var i = 0; i < er.length; i++) {\n                    console.error(er[i]);\n                    if (er[i] instanceof Error) {\n                        var text = er[i].message;\n                        if (text.indexOf(\"Module build failed\") === 0) {\n                            text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\n                            document.body.innerHTML = \"<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>\" + text + \"</pre>\";\n                        }\n                        else {\n                            text += \"<br><br>Check console for more details\";\n                            this.webix.message({ type: \"error\", text: text, expire: -1 });\n                        }\n                    }\n                }\n                debugger;\n            }\n        };\n        JetAppBase.prototype.render = function (root, url, config) {\n            var _this = this;\n            this._container = (typeof root === \"string\") ?\n                this.webix.toNode(root) :\n                (root || document.body);\n            var firstInit = !this.$router;\n            var path = null;\n            if (firstInit) {\n                if (_once && \"tagName\" in this._container) {\n                    this.webix.event(document.body, \"click\", function (e) { return _this.clickHandler(e); });\n                    _once = false;\n                }\n                if (typeof url === \"string\") {\n                    url = new Route(url, 0);\n                }\n                this._subSegment = this._first_start(url);\n                this._subSegment.route.linkRouter = true;\n            }\n            else {\n                if (typeof url === \"string\") {\n                    path = url;\n                }\n                else {\n                    if (this.app) {\n                        path = url.split().route.path || this.config.start;\n                    }\n                    else {\n                        path = url.toString();\n                    }\n                }\n            }\n            var params = config ? config.params : this.config.params || null;\n            var top = this.getSubView();\n            var segment = this._subSegment;\n            var ready = segment\n                .show({ url: path, params: params }, top)\n                .then(function () { return _this.createFromURL(segment.current()); })\n                .then(function (view) { return view.render(root, segment); })\n                .then(function (base) {\n                _this.$router.set(segment.route.path, { silent: true });\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return base;\n            });\n            this.ready = this.ready.then(function () { return ready; });\n            return ready;\n        };\n        JetAppBase.prototype.getSubView = function () {\n            if (this._subSegment) {\n                var view = this._subSegment.current().view;\n                if (view)\n                    return view;\n            }\n            return new JetView(this, {});\n        };\n        JetAppBase.prototype.require = function (type, url) { return null; };\n        JetAppBase.prototype._first_start = function (route) {\n            var _this = this;\n            this._segment = route;\n            var cb = function (a) { return setTimeout(function () {\n                _this.show(a).catch(function (e) {\n                    if (!(e instanceof NavigationBlocked))\n                        throw e;\n                });\n            }, 1); };\n            this.$router = new (this.config.router)(cb, this.config, this);\n            if (this._container === document.body && this.config.animation !== false) {\n                var node_1 = this._container;\n                this.webix.html.addCss(node_1, \"webixappstart\");\n                setTimeout(function () {\n                    _this.webix.html.removeCss(node_1, \"webixappstart\");\n                    _this.webix.html.addCss(node_1, \"webixapp\");\n                }, 10);\n            }\n            if (!route) {\n                var urlString = this.$router.get();\n                if (!urlString) {\n                    urlString = this.config.start;\n                    this.$router.set(urlString, { silent: true });\n                }\n                route = new Route(urlString, 0);\n            }\n            else if (this.app) {\n                var now = route.current().view;\n                route.current().view = this;\n                if (route.next()) {\n                    route.refresh();\n                    route = route.split();\n                }\n                else {\n                    route = new Route(this.config.start, 0);\n                }\n                route.current().view = now;\n            }\n            return route;\n        };\n        JetAppBase.prototype._loadError = function (url, err) {\n            this.error(\"app:error:resolve\", [err, url]);\n            return { template: \" \" };\n        };\n        JetAppBase.prototype.addSubView = function (obj, target, config) {\n            var url = obj.$subview !== true ? obj.$subview : null;\n            var name = obj.name || (url ? this.webix.uid() : \"default\");\n            target.id = obj.id || \"s\" + this.webix.uid();\n            var view = config[name] = {\n                id: target.id,\n                url: url,\n                branch: obj.branch,\n                popup: obj.popup,\n                params: obj.params\n            };\n            return view.popup ? null : target;\n        };\n        return JetAppBase;\n    }(JetBase));\n    var HashRouter = (function () {\n        function HashRouter(cb, config) {\n            var _this = this;\n            this.config = config || {};\n            this._detectPrefix();\n            this.cb = cb;\n            window.onpopstate = function () { return _this.cb(_this.get()); };\n        }\n        HashRouter.prototype.set = function (path, config) {\n            var _this = this;\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                for (var key in this.config.routes) {\n                    if (this.config.routes[key] === compare[0]) {\n                        path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                        break;\n                    }\n                }\n            }\n            if (this.get() !== path) {\n                window.history.pushState(null, null, this.prefix + this.sufix + path);\n            }\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        HashRouter.prototype.get = function () {\n            var path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n            path = (path !== \"/\" && path !== \"#\") ? path : \"\";\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                var key = this.config.routes[compare[0]];\n                if (key) {\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                }\n            }\n            return path;\n        };\n        HashRouter.prototype._detectPrefix = function () {\n            var sufix = this.config.routerPrefix;\n            this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n            this.prefix = document.location.href.split(\"#\", 2)[0];\n        };\n        HashRouter.prototype._getRaw = function () {\n            return document.location.href;\n        };\n        return HashRouter;\n    }());\n    var isPatched = false;\n    function patch(w) {\n        if (isPatched || !w) {\n            return;\n        }\n        isPatched = true;\n        var win = window;\n        if (!win.Promise) {\n            win.Promise = w.promise;\n        }\n        var version = w.version.split(\".\");\n        if (version[0] * 10 + version[1] * 1 < 53) {\n            w.ui.freeze = function (handler) {\n                var res = handler();\n                if (res && res.then) {\n                    res.then(function (some) {\n                        w.ui.$freeze = false;\n                        w.ui.resize();\n                        return some;\n                    });\n                }\n                else {\n                    w.ui.$freeze = false;\n                    w.ui.resize();\n                }\n                return res;\n            };\n        }\n        var baseAdd = w.ui.baselayout.prototype.addView;\n        var baseRemove = w.ui.baselayout.prototype.removeView;\n        var config = {\n            addView: function (view, index) {\n                if (this.$scope && this.$scope.webixJet && !view.queryView) {\n                    var jview_1 = this.$scope;\n                    var subs_1 = {};\n                    view = jview_1.app.copyConfig(view, {}, subs_1);\n                    baseAdd.apply(this, [view, index]);\n                    var _loop_1 = function (key) {\n                        jview_1._renderFrame(key, subs_1[key], null).then(function () {\n                            jview_1._subs[key] = subs_1[key];\n                        });\n                    };\n                    for (var key in subs_1) {\n                        _loop_1(key);\n                    }\n                    return view.id;\n                }\n                else {\n                    return baseAdd.apply(this, arguments);\n                }\n            },\n            removeView: function () {\n                baseRemove.apply(this, arguments);\n                if (this.$scope && this.$scope.webixJet) {\n                    var subs = this.$scope._subs;\n                    for (var key in subs) {\n                        var test = subs[key];\n                        if (!w.$$(test.id)) {\n                            test.view.destructor();\n                            delete subs[key];\n                        }\n                    }\n                }\n            }\n        };\n        w.extend(w.ui.layout.prototype, config, true);\n        w.extend(w.ui.baselayout.prototype, config, true);\n        w.protoUI({\n            name: \"jetapp\",\n            $init: function (cfg) {\n                this.$app = new this.app(cfg);\n                var id = w.uid().toString();\n                cfg.body = { id: id };\n                this.$ready.push(function () {\n                    this.callEvent(\"onInit\", [this.$app]);\n                    this.$app.render({ id: id });\n                });\n            }\n        }, w.ui.proxy, w.EventSystem);\n    }\n    var JetApp = (function (_super) {\n        __extends(JetApp, _super);\n        function JetApp(config) {\n            var _this = this;\n            config.router = config.router || HashRouter;\n            _this = _super.call(this, config) || this;\n            patch(_this.webix);\n            return _this;\n        }\n        JetApp.prototype.require = function (type, url) {\n            return require(type + \"/\" + url);\n        };\n        return JetApp;\n    }(JetAppBase));\n    var UrlRouter = (function (_super) {\n        __extends(UrlRouter, _super);\n        function UrlRouter() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        UrlRouter.prototype._detectPrefix = function () {\n            this.prefix = \"\";\n            this.sufix = this.config.routerPrefix || \"\";\n        };\n        UrlRouter.prototype._getRaw = function () {\n            return document.location.pathname + (document.location.search || \"\");\n        };\n        return UrlRouter;\n    }(HashRouter));\n    var EmptyRouter = (function () {\n        function EmptyRouter(cb, _$config) {\n            this.path = \"\";\n            this.cb = cb;\n        }\n        EmptyRouter.prototype.set = function (path, config) {\n            var _this = this;\n            this.path = path;\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        EmptyRouter.prototype.get = function () {\n            return this.path;\n        };\n        return EmptyRouter;\n    }());\n    function UnloadGuard(app, view, config) {\n        view.on(app, \"app:guard\", function (_$url, point, promise) {\n            if (point === view || point.contains(view)) {\n                var res_1 = config();\n                if (res_1 === false) {\n                    promise.confirm = Promise.reject(new NavigationBlocked());\n                }\n                else {\n                    promise.confirm = promise.confirm.then(function () { return res_1; });\n                }\n            }\n        });\n    }\n    function has(store, key) {\n        return Object.prototype.hasOwnProperty.call(store, key);\n    }\n    function forEach(obj, handler, context) {\n        for (var key in obj) {\n            if (has(obj, key)) {\n                handler.call((context || obj), obj[key], key, obj);\n            }\n        }\n    }\n    function trim(str) {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n    function warn(message) {\n        message = 'Warning: ' + message;\n        if (typeof console !== 'undefined') {\n            console.error(message);\n        }\n        try {\n            throw new Error(message);\n        }\n        catch (x) { }\n    }\n    var replace = String.prototype.replace;\n    var split = String.prototype.split;\n    var delimiter = '||||';\n    var russianPluralGroups = function (n) {\n        var end = n % 10;\n        if (n !== 11 && end === 1) {\n            return 0;\n        }\n        if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n            return 1;\n        }\n        return 2;\n    };\n    var pluralTypes = {\n        arabic: function (n) {\n            if (n < 3) {\n                return n;\n            }\n            var lastTwo = n % 100;\n            if (lastTwo >= 3 && lastTwo <= 10)\n                return 3;\n            return lastTwo >= 11 ? 4 : 5;\n        },\n        bosnian_serbian: russianPluralGroups,\n        chinese: function () { return 0; },\n        croatian: russianPluralGroups,\n        french: function (n) { return n > 1 ? 1 : 0; },\n        german: function (n) { return n !== 1 ? 1 : 0; },\n        russian: russianPluralGroups,\n        lithuanian: function (n) {\n            if (n % 10 === 1 && n % 100 !== 11) {\n                return 0;\n            }\n            return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n        },\n        czech: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            return (n >= 2 && n <= 4) ? 1 : 2;\n        },\n        polish: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            var end = n % 10;\n            return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n        },\n        icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n        slovenian: function (n) {\n            var lastTwo = n % 100;\n            if (lastTwo === 1) {\n                return 0;\n            }\n            if (lastTwo === 2) {\n                return 1;\n            }\n            if (lastTwo === 3 || lastTwo === 4) {\n                return 2;\n            }\n            return 3;\n        }\n    };\n    var pluralTypeToLanguages = {\n        arabic: ['ar'],\n        bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n        chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n        croatian: ['hr', 'hr-HR'],\n        german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n        french: ['fr', 'tl', 'pt-br'],\n        russian: ['ru', 'ru-RU'],\n        lithuanian: ['lt'],\n        czech: ['cs', 'cs-CZ', 'sk'],\n        polish: ['pl'],\n        icelandic: ['is'],\n        slovenian: ['sl-SL']\n    };\n    function langToTypeMap(mapping) {\n        var ret = {};\n        forEach(mapping, function (langs, type) {\n            forEach(langs, function (lang) {\n                ret[lang] = type;\n            });\n        });\n        return ret;\n    }\n    function pluralTypeName(locale) {\n        var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n        return langToPluralType[locale]\n            || langToPluralType[split.call(locale, /-/, 1)[0]]\n            || langToPluralType.en;\n    }\n    function pluralTypeIndex(locale, count) {\n        return pluralTypes[pluralTypeName(locale)](count);\n    }\n    function escape(token) {\n        return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    function constructTokenRegex(opts) {\n        var prefix = (opts && opts.prefix) || '%{';\n        var suffix = (opts && opts.suffix) || '}';\n        if (prefix === delimiter || suffix === delimiter) {\n            throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n        }\n        return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n    }\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$';\n    var defaultTokenRegex = /%\\{(.*?)\\}/g;\n    function transformPhrase(phrase, substitutions, locale, tokenRegex) {\n        if (typeof phrase !== 'string') {\n            throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n        }\n        if (substitutions == null) {\n            return phrase;\n        }\n        var result = phrase;\n        var interpolationRegex = tokenRegex || defaultTokenRegex;\n        var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n        if (options.smart_count != null && result) {\n            var texts = split.call(result, delimiter);\n            result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n        }\n        result = replace.call(result, interpolationRegex, function (expression, argument) {\n            if (!has(options, argument) || options[argument] == null) {\n                return expression;\n            }\n            return replace.call(options[argument], dollarRegex, dollarBillsYall);\n        });\n        return result;\n    }\n    function Polyglot(options) {\n        var opts = options || {};\n        this.phrases = {};\n        this.extend(opts.phrases || {});\n        this.currentLocale = opts.locale || 'en';\n        var allowMissing = opts.allowMissing ? transformPhrase : null;\n        this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n        this.warn = opts.warn || warn;\n        this.tokenRegex = constructTokenRegex(opts.interpolation);\n    }\n    Polyglot.prototype.locale = function (newLocale) {\n        if (newLocale)\n            this.currentLocale = newLocale;\n        return this.currentLocale;\n    };\n    Polyglot.prototype.extend = function (morePhrases, prefix) {\n        forEach(morePhrases, function (phrase, key) {\n            var prefixedKey = prefix ? prefix + '.' + key : key;\n            if (typeof phrase === 'object') {\n                this.extend(phrase, prefixedKey);\n            }\n            else {\n                this.phrases[prefixedKey] = phrase;\n            }\n        }, this);\n    };\n    Polyglot.prototype.unset = function (morePhrases, prefix) {\n        if (typeof morePhrases === 'string') {\n            delete this.phrases[morePhrases];\n        }\n        else {\n            forEach(morePhrases, function (phrase, key) {\n                var prefixedKey = prefix ? prefix + '.' + key : key;\n                if (typeof phrase === 'object') {\n                    this.unset(phrase, prefixedKey);\n                }\n                else {\n                    delete this.phrases[prefixedKey];\n                }\n            }, this);\n        }\n    };\n    Polyglot.prototype.clear = function () {\n        this.phrases = {};\n    };\n    Polyglot.prototype.replace = function (newPhrases) {\n        this.clear();\n        this.extend(newPhrases);\n    };\n    Polyglot.prototype.t = function (key, options) {\n        var phrase, result;\n        var opts = options == null ? {} : options;\n        if (typeof this.phrases[key] === 'string') {\n            phrase = this.phrases[key];\n        }\n        else if (typeof opts._ === 'string') {\n            phrase = opts._;\n        }\n        else if (this.onMissingKey) {\n            var onMissingKey = this.onMissingKey;\n            result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n        }\n        else {\n            this.warn('Missing translation for key: \"' + key + '\"');\n            result = key;\n        }\n        if (typeof phrase === 'string') {\n            result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n        }\n        return result;\n    };\n    Polyglot.prototype.has = function (key) {\n        return has(this.phrases, key);\n    };\n    Polyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n        return transformPhrase(phrase, substitutions, locale);\n    };\n    var webixPolyglot = Polyglot;\n    function Locale(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n        function setLangData(name, data, silent) {\n            if (data.__esModule) {\n                data = data.default;\n            }\n            var pconfig = { phrases: data };\n            if (config.polyglot) {\n                app.webix.extend(pconfig, config.polyglot);\n            }\n            var poly = service.polyglot = new webixPolyglot(pconfig);\n            poly.locale(name);\n            service._ = app.webix.bind(poly.t, poly);\n            lang = name;\n            if (storage) {\n                storage.put(\"lang\", lang);\n            }\n            if (config.webix) {\n                var locName = config.webix[name];\n                if (locName) {\n                    app.webix.i18n.setLocale(locName);\n                }\n            }\n            if (!silent) {\n                return app.refresh();\n            }\n            return Promise.resolve();\n        }\n        function getLang() { return lang; }\n        function setLang(name, silent) {\n            if (config.path === false) {\n                return;\n            }\n            var path = (config.path ? config.path + \"/\" : \"\") + name;\n            var data = app.require(\"jet-locales\", path);\n            setLangData(name, data, silent);\n        }\n        var service = {\n            getLang: getLang, setLang: setLang, setLangData: setLangData, _: null, polyglot: null\n        };\n        app.setService(\"locale\", service);\n        setLang(lang, true);\n    }\n    function show(view, config, value) {\n        var _a;\n        if (config.urls) {\n            value = config.urls[value] || value;\n        }\n        else if (config.param) {\n            value = (_a = {}, _a[config.param] = value, _a);\n        }\n        view.show(value);\n    }\n    function Menu(app, view, config) {\n        var frame = view.getSubViewInfo().parent;\n        var ui = view.$$(config.id || config);\n        var silent = false;\n        ui.attachEvent(\"onchange\", function () {\n            if (!silent) {\n                show(frame, config, this.getValue());\n            }\n        });\n        ui.attachEvent(\"onafterselect\", function () {\n            if (!silent) {\n                var id = null;\n                if (ui.setValue) {\n                    id = this.getValue();\n                }\n                else if (ui.getSelectedId) {\n                    id = ui.getSelectedId();\n                }\n                show(frame, config, id);\n            }\n        });\n        view.on(app, \"app:route\", function () {\n            var name = \"\";\n            if (config.param) {\n                name = view.getParam(config.param, true);\n            }\n            else {\n                var segment = frame.getUrl()[1];\n                if (segment) {\n                    name = segment.page;\n                }\n            }\n            if (name) {\n                silent = true;\n                if (ui.setValue && ui.getValue() !== name) {\n                    ui.setValue(name);\n                }\n                else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\n                    ui.select(name);\n                }\n                silent = false;\n            }\n        });\n    }\n    var baseicons = {\n        good: \"check\",\n        error: \"warning\",\n        saving: \"refresh fa-spin\"\n    };\n    var basetext = {\n        good: \"Ok\",\n        error: \"Error\",\n        saving: \"Connecting...\"\n    };\n    function Status(app, view, config) {\n        var status = \"good\";\n        var count = 0;\n        var iserror = false;\n        var expireDelay = config.expire;\n        if (!expireDelay && expireDelay !== false) {\n            expireDelay = 2000;\n        }\n        var texts = config.texts || basetext;\n        var icons = config.icons || baseicons;\n        if (typeof config === \"string\") {\n            config = { target: config };\n        }\n        function refresh(content) {\n            var area = view.$$(config.target);\n            if (area) {\n                if (!content) {\n                    content = \"<div class='status_\" +\n                        status +\n                        \"'><span class='webix_icon fa-\" +\n                        icons[status] + \"'></span> \" + texts[status] + \"</div>\";\n                }\n                area.setHTML(content);\n            }\n        }\n        function success() {\n            count--;\n            setStatus(\"good\");\n        }\n        function fail(err) {\n            count--;\n            setStatus(\"error\", err);\n        }\n        function start(promise) {\n            count++;\n            setStatus(\"saving\");\n            if (promise && promise.then) {\n                promise.then(success, fail);\n            }\n        }\n        function getStatus() {\n            return status;\n        }\n        function hideStatus() {\n            if (count === 0) {\n                refresh(\" \");\n            }\n        }\n        function setStatus(mode, err) {\n            if (count < 0) {\n                count = 0;\n            }\n            if (mode === \"saving\") {\n                status = \"saving\";\n                refresh();\n            }\n            else {\n                iserror = (mode === \"error\");\n                if (count === 0) {\n                    status = iserror ? \"error\" : \"good\";\n                    if (iserror) {\n                        app.error(\"app:error:server\", [err.responseText || err]);\n                    }\n                    else {\n                        if (expireDelay) {\n                            setTimeout(hideStatus, expireDelay);\n                        }\n                    }\n                    refresh();\n                }\n            }\n        }\n        function track(data) {\n            var dp = app.webix.dp(data);\n            if (dp) {\n                view.on(dp, \"onAfterDataSend\", start);\n                view.on(dp, \"onAfterSaveError\", function (_id, _obj, response) { return fail(response); });\n                view.on(dp, \"onAfterSave\", success);\n            }\n        }\n        app.setService(\"status\", {\n            getStatus: getStatus,\n            setStatus: setStatus,\n            track: track\n        });\n        if (config.remote) {\n            view.on(app.webix, \"onRemoteCall\", start);\n        }\n        if (config.ajax) {\n            view.on(app.webix, \"onBeforeAjax\", function (_mode, _url, _data, _request, _headers, _files, promise) {\n                start(promise);\n            });\n        }\n        if (config.data) {\n            track(config.data);\n        }\n    }\n    function Theme(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var theme = storage ?\n            (storage.get(\"theme\") || \"flat-default\")\n            :\n                (config.theme || \"flat-default\");\n        var service = {\n            getTheme: function () { return theme; },\n            setTheme: function (name, silent) {\n                var parts = name.split(\"-\");\n                var links = document.getElementsByTagName(\"link\");\n                for (var i = 0; i < links.length; i++) {\n                    var lname = links[i].getAttribute(\"title\");\n                    if (lname) {\n                        if (lname === name || lname === parts[0]) {\n                            links[i].disabled = false;\n                        }\n                        else {\n                            links[i].disabled = true;\n                        }\n                    }\n                }\n                app.webix.skin.set(parts[0]);\n                app.webix.html.removeCss(document.body, \"theme-\" + theme);\n                app.webix.html.addCss(document.body, \"theme-\" + name);\n                theme = name;\n                if (storage) {\n                    storage.put(\"theme\", name);\n                }\n                if (!silent) {\n                    app.refresh();\n                }\n            }\n        };\n        app.setService(\"theme\", service);\n        service.setTheme(theme, true);\n    }\n    function copyParams(data, url, route) {\n        for (var i = 0; i < route.length; i++) {\n            data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\n        }\n    }\n    function UrlParam(app, view, config) {\n        var route = config.route || config;\n        var data = {};\n        view.on(app, \"app:urlchange\", function (subview, segment) {\n            if (view === subview) {\n                copyParams(data, segment.suburl(), route);\n                segment.size(route.length + 1);\n            }\n        });\n        var os = view.setParam;\n        var og = view.getParam;\n        view.setParam = function (name, value, show) {\n            var index = route.indexOf(name);\n            if (index >= 0) {\n                data[name] = value;\n                this._segment.update(\"\", value, index + 1);\n                if (show) {\n                    return view.show(null);\n                }\n            }\n            else {\n                return os.call(this, name, value, show);\n            }\n        };\n        view.getParam = function (key, mode) {\n            var val = data[key];\n            if (typeof val !== \"undefined\") {\n                return val;\n            }\n            return og.call(this, key, mode);\n        };\n        copyParams(data, view.getUrl(), route);\n    }\n    function User(app, _view, config) {\n        config = config || {};\n        var login = config.login || \"/login\";\n        var logout = config.logout || \"/logout\";\n        var afterLogin = config.afterLogin || app.config.start;\n        var afterLogout = config.afterLogout || \"/login\";\n        var ping = config.ping || 5 * 60 * 1000;\n        var model = config.model;\n        var user = config.user;\n        var service = {\n            getUser: function () {\n                return user;\n            },\n            getStatus: function (server) {\n                if (!server) {\n                    return user !== null;\n                }\n                return model.status().catch(function () { return null; }).then(function (data) {\n                    user = data;\n                });\n            },\n            login: function (name, pass) {\n                return model.login(name, pass).then(function (data) {\n                    user = data;\n                    if (!data) {\n                        throw new Error(\"Access denied\");\n                    }\n                    app.callEvent(\"app:user:login\", [user]);\n                    app.show(afterLogin);\n                });\n            },\n            logout: function () {\n                user = null;\n                return model.logout().then(function (res) {\n                    app.callEvent(\"app:user:logout\", []);\n                    return res;\n                });\n            }\n        };\n        function canNavigate(url, obj) {\n            if (url === logout) {\n                service.logout();\n                obj.redirect = afterLogout;\n            }\n            else if (url !== login && !service.getStatus()) {\n                obj.redirect = login;\n            }\n        }\n        app.setService(\"user\", service);\n        app.attachEvent(\"app:guard\", function (url, _$root, obj) {\n            if (config.public && config.public(url)) {\n                return true;\n            }\n            if (typeof user === \"undefined\") {\n                obj.confirm = service.getStatus(true).then(function () { return canNavigate(url, obj); });\n            }\n            return canNavigate(url, obj);\n        });\n        if (ping) {\n            setInterval(function () { return service.getStatus(true); }, ping);\n        }\n    }\n    var webix$1 = window.webix;\n    if (webix$1) {\n        patch(webix$1);\n    }\n    var plugins = {\n        UnloadGuard: UnloadGuard, Locale: Locale, Menu: Menu, Theme: Theme, User: User, Status: Status, UrlParam: UrlParam\n    };\n    var w = window;\n    if (!w.Promise) {\n        w.Promise = w.webix.promise;\n    }\n\n    var index = 1;\n    function uid() {\n        return index++;\n    }\n    var empty = undefined;\n    var context = null;\n    function link(source, target, key) {\n        Object.defineProperty(target, key, {\n            get: function () { return source[key]; },\n            set: function (value) { return (source[key] = value); },\n        });\n    }\n    function createState(data, config) {\n        config = config || {};\n        var handlers = {};\n        var out = {};\n        var observe = function (mask, handler) {\n            var key = uid();\n            handlers[key] = { mask: mask, handler: handler };\n            if (mask === \"*\")\n                handler(out, empty, mask);\n            else\n                handler(out[mask], empty, mask);\n            return key;\n        };\n        var observeEnd = function (id) {\n            delete handlers[id];\n        };\n        var queue = [];\n        var waitInQueue = false;\n        var batch = function (code) {\n            if (typeof code !== \"function\") {\n                var values_1 = code;\n                code = function () {\n                    for (var key in values_1)\n                        out[key] = values_1[key];\n                };\n            }\n            waitInQueue = true;\n            code(out);\n            waitInQueue = false;\n            while (queue.length) {\n                var obj = queue.shift();\n                notify.apply(this, obj);\n            }\n        };\n        var notify = function (key, old, value, meta) {\n            if (waitInQueue) {\n                queue.push([key, old, value, meta]);\n                return;\n            }\n            var list = Object.keys(handlers);\n            for (var i = 0; i < list.length; i++) {\n                var obj = handlers[list[i]];\n                if (!obj)\n                    continue;\n                if (obj.mask === \"*\" || obj.mask === key) {\n                    obj.handler(value, old, key, meta);\n                }\n            }\n        };\n        for (var key2 in data) {\n            if (data.hasOwnProperty(key2)) {\n                var test = data[key2];\n                if (config.nested && typeof test === \"object\" && test) {\n                    out[key2] = createState(test, config);\n                }\n                else {\n                    reactive(out, test, key2, notify);\n                }\n            }\n        }\n        Object.defineProperty(out, \"$changes\", {\n            value: {\n                attachEvent: observe,\n                detachEvent: observeEnd,\n            },\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$observe\", {\n            value: observe,\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$batch\", {\n            value: batch,\n            enumerable: false,\n            configurable: false,\n        });\n        return out;\n    }\n    function reactive(obj, val, key, notify) {\n        Object.defineProperty(obj, key, {\n            get: function () {\n                return val;\n            },\n            set: function (value) {\n                var changed = false;\n                if (val === null || value === null) {\n                    changed = val !== value;\n                }\n                else {\n                    changed = val.valueOf() != value.valueOf();\n                }\n                if (changed) {\n                    var old = val;\n                    val = value;\n                    notify(key, old, value, context);\n                }\n            },\n            enumerable: true,\n            configurable: false,\n        });\n    }\n\n    function handler(view) {\n        return {\n            attachEvent: function (key, handler) {\n                webix.UIManager.addHotKey(key, handler, view);\n                return { key: key, handler: handler };\n            },\n            detachEvent: function (_a) {\n                var key = _a.key, handler = _a.handler;\n                return webix.UIManager.removeHotKey(key, handler, view);\n            },\n        };\n    }\n\n    var folderIcon = \"<span class='webix_icon wxi-folder'></span>\";\n    var backIcon = \"<span class='webix_icon wxi-angle-double-left webix_fmanager_back_icon'></span>\";\n    var folderCardIcon = \"<span class='webix_icon wxi-folder webix_fmanager_folder_icon'></span>\";\n    var menuIcon = \"<span class='webix_icon wxi-dots webix_fmanager_menu_icon'></span>\";\n    var gridMode = \"<span class='webix_fmanager_icon fmi-view-list webix_fmanager_mode_icon'></span>\";\n    var cardMode = \"<span class='webix_fmanager_icon fmi-view-grid webix_fmanager_mode_icon'></span>\";\n    var doubleMode = \"<span class='webix_fmanager_icon fmi-view-array webix_fmanager_mode_icon'></span>\";\n\n    var FOLDER = 0x01;\n    var MANY = 0x02;\n    var TEXT = 0x04;\n    var VIEW = 0x08;\n    var FULL = 0x10;\n    var TREE = 0x20;\n    var SEARCH = 0x40;\n    var MenuBodyView = (function (_super) {\n        __extends(MenuBodyView, _super);\n        function MenuBodyView(app, name, config) {\n            var _this = _super.call(this, app, name) || this;\n            _this.compact = !!config.compact;\n            _this.tree = !!config.tree;\n            return _this;\n        }\n        MenuBodyView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var options = [\n                {\n                    id: \"download\",\n                    value: _(\"Download\"),\n                    icon: \"wxi-download\",\n                    show: TREE,\n                    hotkey: \"Ctrl+D\",\n                },\n                {\n                    $template: \"Separator\",\n                    show: TREE,\n                },\n                {\n                    id: \"toggle-preview\",\n                    value: _(\"Preview\"),\n                    icon: \"wxi-eye\",\n                    show: FULL | FOLDER,\n                },\n                {\n                    id: \"locate\",\n                    value: _(\"Open item location\"),\n                    icon: \"wxi-folder\",\n                    hotkey: \"Ctrl+Alt+O\",\n                    show: FOLDER | SEARCH,\n                },\n                {\n                    id: \"open\",\n                    value: _(\"Open\"),\n                    icon: \"wxi-folder-open\",\n                    hotkey: \"Ctrl+O\",\n                    show: VIEW,\n                },\n                {\n                    $template: \"Separator\",\n                    show: VIEW,\n                },\n                {\n                    id: \"copy\",\n                    value: _(\"Copy\"),\n                    hotkey: \"Ctrl+C\",\n                    icon: \"fmi-content-copy\",\n                    show: FOLDER | MANY | TREE,\n                },\n                {\n                    id: \"cut\",\n                    value: _(\"Cut\"),\n                    hotkey: \"Ctrl+X\",\n                    icon: \"fmi-content-cut\",\n                    show: FOLDER | MANY | TREE,\n                },\n                {\n                    id: \"paste\",\n                    value: _(\"Paste\"),\n                    hotkey: \"Ctrl+V\",\n                    icon: \"fmi-content-paste\",\n                    show: FOLDER | TREE,\n                },\n                {\n                    $template: \"Separator\",\n                    show: FOLDER | MANY | TREE,\n                },\n                {\n                    id: \"rename\",\n                    value: _(\"Rename\"),\n                    icon: \"fmi-rename-box\",\n                    hotkey: \"Ctrl+R\",\n                    show: FOLDER,\n                },\n                {\n                    id: \"delete\",\n                    value: _(\"Delete\"),\n                    icon: \"wxi-close\",\n                    hotkey: \"Del / &#8592;\",\n                    show: FOLDER | MANY,\n                },\n            ];\n            if (this.app.config.editor) {\n                options.splice(5, 0, {\n                    id: \"edit\",\n                    value: _(\"Edit\"),\n                    icon: \"wxi-pencil\",\n                    hotkey: \"Ctrl+E\",\n                    show: TEXT,\n                });\n            }\n            var menu = {\n                view: \"menu\",\n                css: \"webix_fmanager_menu\",\n                layout: \"y\",\n                autoheight: true,\n                data: options,\n                template: function (obj) {\n                    return ((obj.icon\n                        ? \"<span class=\\\"webix_list_icon webix_icon \" + obj.icon + \"\\\"></span>\"\n                        : \"\") +\n                        obj.value +\n                        (obj.hotkey\n                            ? \"<span class=\\\"webix_fmanager_context-menu-hotkey\\\">\" + obj.hotkey + \"</span>\"\n                            : \"\"));\n                },\n                on: {\n                    onMenuItemClick: function (id) {\n                        _this.app.callEvent(\"app:action\", [id, _this.Files]);\n                        _this.app.callEvent(\"app:filemenu:click\");\n                    },\n                },\n            };\n            return menu;\n        };\n        MenuBodyView.prototype.FilterOptions = function (files) {\n            var _this = this;\n            this.Files = files;\n            var file = files[0];\n            var many = files.length > 1;\n            var vtypes = [\"image\", \"audio\", \"video\", \"code\", \"pdf\"];\n            var viewable = vtypes.find(function (t) { return t === file.type || t === file.$ext; });\n            var search = this.app.getState().search;\n            this.getRoot().define(\"width\", search && !many ? 270 : 200);\n            this.getRoot().filter(function (o) {\n                return !((many && !(o.show & MANY)) ||\n                    (file.type === \"folder\" && !(o.show & FOLDER)) ||\n                    (o.show & TEXT && file.type !== \"code\") ||\n                    (o.show & VIEW && !viewable) ||\n                    (o.show & FULL && !_this.compact) ||\n                    (o.show & TREE && _this.tree) ||\n                    (o.show & SEARCH && !search));\n            });\n        };\n        return MenuBodyView;\n    }(JetView));\n\n    var ContextMenuView = (function (_super) {\n        __extends(ContextMenuView, _super);\n        function ContextMenuView(app, name, config) {\n            var _this = _super.call(this, app, name) || this;\n            _this._config = config;\n            return _this;\n        }\n        ContextMenuView.prototype.config = function () {\n            var _this = this;\n            return {\n                view: \"context\",\n                body: {\n                    $subview: new (this.app.dynamic(MenuBodyView))(this.app, \"\", __assign({}, this._config)),\n                    name: \"options\",\n                },\n                on: {\n                    onBeforeShow: function (e) {\n                        var files = _this._Locate(e);\n                        if (files)\n                            _this.getSubView(\"options\").FilterOptions(files);\n                        else\n                            return false;\n                    },\n                },\n            };\n        };\n        ContextMenuView.prototype.init = function () {\n            var _this = this;\n            this.on(this.app, \"app:filemenu:click\", function () { return _this.getRoot().hide(); });\n        };\n        ContextMenuView.prototype.AttachTo = function (master, locate) {\n            this._Locate = locate;\n            this.getRoot().attachTo(master);\n        };\n        ContextMenuView.prototype.Show = function (trg) {\n            this.getRoot().show(trg, {\n                x: -trg.offsetX,\n                y: trg.target.offsetHeight - trg.offsetY,\n            });\n        };\n        return ContextMenuView;\n    }(JetView));\n\n    var DataViewBase = (function (_super) {\n        __extends(DataViewBase, _super);\n        function DataViewBase() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        DataViewBase.prototype.init = function () {\n            var _this = this;\n            this.State = this.getParam(\"state\");\n            this._Track = true;\n            this.WTable.attachEvent(\"onAfterSelect\", function () { return _this.ShiftFocus(); });\n            this.WTable.attachEvent(\"onSelectChange\", function () {\n                if (_this._Track) {\n                    var newIDs = []\n                        .concat(_this.WTable.getSelectedId(true).map(function (a) { return _this.WTable.getItem(a); }))\n                        .filter(function (a) { return a.value !== \"..\"; });\n                    if (newIDs.length || _this.State.selectedItem.length) {\n                        if (!newIDs.length)\n                            newIDs.$noSelect = true;\n                        _this.State.selectedItem = newIDs;\n                    }\n                }\n            });\n            this.on(this.State.$changes, \"path\", function (v, o) {\n                if (!_this.State.search) {\n                    v = _this.State.source === \"files\" ? v : _this.State.source;\n                    if (!o)\n                        _this.LoadData(v);\n                    else\n                        _this.app\n                            .getService(\"local\")\n                            .folders()\n                            .then(function (hierarchy) {\n                            _this.State.selectedItem = _this.GetPrevLocation(hierarchy, v, o);\n                            _this.LoadData(v);\n                        });\n                }\n                else if (o) {\n                    _this.State.$batch({\n                        search: \"\",\n                        searchStats: null,\n                    });\n                }\n            });\n            this.on(this.WTable.data, \"onStoreUpdated\", function (i, o, m) {\n                if (!m && _this.WTable.count() && _this.State.selectedItem.length) {\n                    _this.SelectActive();\n                }\n            });\n            this.AddHotkeys();\n            var compact = this.getParam(\"compact\", true);\n            this.Menu = this.ui(new (this.app.dynamic(ContextMenuView))(this.app, \"\", {\n                compact: compact,\n                state: this.State,\n            }));\n            this.Menu.AttachTo(this.WTable, function (e) {\n                var id = _this.WTable.locate(e);\n                if (!id)\n                    return false;\n                var item = _this.WTable.getItem(id);\n                if (item.value == \"..\")\n                    return false;\n                if (!_this.WTable.isSelected(id))\n                    _this.WTable.select(id);\n                var sel = _this.WTable.getSelectedId(true);\n                if (sel.length === 1)\n                    return [item];\n                return sel.map(function (s) { return _this.WTable.getItem(s); });\n            });\n            this.on(this.WTable, \"onAfterScroll\", function () { return webix.callEvent(\"onClick\"); });\n        };\n        DataViewBase.prototype.ShiftFocus = function () {\n            if (this.getParam(\"trackActive\", true))\n                this.State.isActive = true;\n        };\n        DataViewBase.prototype.Activate = function (item) {\n            if (!item)\n                return;\n            if (item.type === \"folder\") {\n                this.ShowSubFolder(item.value === \"..\" ? item.value : item.id);\n            }\n            else if (item.type === \"code\" && this.app.config.editor) {\n                this.app.callEvent(\"app:action\", [\"edit\", [item]]);\n            }\n            else {\n                this.app.callEvent(\"app:action\", [\"open\", [item]]);\n            }\n        };\n        DataViewBase.prototype.ShowSubFolder = function (id) {\n            var path;\n            if (id == \"..\") {\n                var t = this.State.path.split(\"/\");\n                path = \"/\" + t.slice(1, t.length - 1).join(\"/\");\n            }\n            else {\n                path = id;\n            }\n            this.State.path = path;\n        };\n        DataViewBase.prototype.GetPrevLocation = function (h, v, o) {\n            if (o === \"/\" || !h.exists(o))\n                return [];\n            if (v === \"/\")\n                v = \"../files\";\n            var id;\n            while (o) {\n                id = o;\n                o = h.getParentId(o);\n                if (o === v) {\n                    var obj = h.getItem(id);\n                    return [\n                        {\n                            id: obj.id,\n                            value: obj.value,\n                            type: \"folder\",\n                            date: new Date(obj.date),\n                        },\n                    ];\n                }\n            }\n            return [];\n        };\n        DataViewBase.prototype.GetTargetFolder = function (target) {\n            var targetItem = target ? this.WTable.getItem(target) : null;\n            var invalidTarget = !targetItem || targetItem.type !== \"folder\" || targetItem.value === \"..\";\n            var targetFolder = invalidTarget ? this.State.path : targetItem.id;\n            return targetFolder;\n        };\n        DataViewBase.prototype.SelectActive = function () {\n            var table = this.WTable;\n            if (this.State.isActive !== false && !table.getSelectedId()) {\n                var sel = this.State.selectedItem;\n                for (var i = 0; i < sel.length; i++) {\n                    if (table.exists(sel[i].id))\n                        table.select(sel[i].id, true);\n                }\n                if (!sel.$noSelect && !table.getSelectedId()) {\n                    var id = table.getFirstId();\n                    if (id) {\n                        table.select(id);\n                        sel.$noSelect = false;\n                    }\n                }\n                webix.delay(function () { return webix.UIManager.setFocus(table); });\n            }\n        };\n        DataViewBase.prototype.GetSelection = function () {\n            return this.WTable.getItem(this.WTable.getSelectedId());\n        };\n        DataViewBase.prototype.LoadData = function (path, search) {\n            var _this = this;\n            this._Track = false;\n            var table = this.WTable;\n            if (search) {\n                table.clearAll();\n                this.app\n                    .getService(\"backend\")\n                    .search(path, search)\n                    .then(function (data) {\n                    for (var i = 0; i < data.length; ++i)\n                        if (typeof data[i].date === \"number\")\n                            data[i].date = new Date(data[i].date * 1000);\n                    table.parse(data);\n                    _this.GetSearchStats(data);\n                });\n            }\n            else {\n                if (table.data.url !== path) {\n                    table.clearAll();\n                    this.app\n                        .getService(\"local\")\n                        .files(path)\n                        .then(function (data) {\n                        _this.RenderData(data);\n                        _this.SelectActive();\n                    });\n                }\n            }\n            this._Track = true;\n        };\n        DataViewBase.prototype.MoveFiles = function (source, target) {\n            this.app\n                .getService(\"operations\")\n                .move(source, this.GetTargetFolder(target));\n            return false;\n        };\n        DataViewBase.prototype.Icon = function (obj) {\n            return \"<img class=\\\"webix_fmanager_file-type-icon\\\" src=\\\"\" + this.app\n                .getService(\"backend\")\n                .icon(obj) + \"\\\" />\";\n        };\n        DataViewBase.prototype.DragMarker = function (ctx) {\n            var list = this.WTable;\n            var parent = list.find(function (f) { return f.value === \"..\"; }, true);\n            if (parent) {\n                var parentInd = ctx.source.indexOf(parent.id);\n                if (parentInd !== -1)\n                    ctx.source.splice(parentInd, 1);\n            }\n            var files = ctx.source.length;\n            if (!files)\n                return false;\n            if (files === 1)\n                list.select(ctx.source[0]);\n            var firstDragged = list.getItem(ctx.source[0]);\n            var icon;\n            if (firstDragged.type === \"folder\") {\n                icon = folderIcon;\n            }\n            else {\n                icon = this.Icon(firstDragged);\n            }\n            var html = \"<div class='webix_fmanager_grid_drag_zone_list'>\";\n            html += \"<div class=\\\"webix_fmanager_inner_drag_zone_list\\\">\" + icon + firstDragged.value + \"</div>\";\n            html += \"</div>\";\n            if (files > 1) {\n                html = \"<div class='webix_drag_main'>\" + html + \"</div>\";\n                html += \"<div class='webix_badge'>\" + files + \"</div>\";\n                var multiple = \"<div class='webix_drag_multiple'></div>\";\n                if (files > 2)\n                    multiple = \"<div class='webix_drag_multiple_last'></div>\" + multiple;\n                html = multiple + html;\n            }\n            ctx.html = html;\n        };\n        DataViewBase.prototype.AddHotkeys = function () {\n            var _this = this;\n            var ctrlKey = webix.env.isMac ? \"COMMAND\" : \"CTRL\";\n            var operations = [\n                { key: \"DELETE\", oper: \"delete\" },\n                { key: \"BACKSPACE\", oper: \"delete\" },\n                { key: ctrlKey + \"+C\", oper: \"copy\" },\n                { key: ctrlKey + \"+X\", oper: \"cut\" },\n                { key: ctrlKey + \"+V\", oper: \"paste\" },\n                { key: ctrlKey + \"+R\", oper: \"rename\" },\n                { key: ctrlKey + \"+O\", oper: \"open\" },\n                { key: ctrlKey + \"+D\", oper: \"download\" },\n                { key: ctrlKey + \"+Alt+O\", oper: \"locate\" },\n            ];\n            if (this.app.config.editor) {\n                operations.push({ key: ctrlKey + \"+E\", oper: \"edit\" });\n            }\n            var _loop_1 = function (i) {\n                this_1.on(handler(this_1.getRoot()), operations[i].key, function (v, e) {\n                    var params = [operations[i].oper];\n                    _this.app.callEvent(\"app:action\", params);\n                    webix.html.preventEvent(e);\n                });\n            };\n            var this_1 = this;\n            for (var i = 0; i < operations.length; ++i) {\n                _loop_1(i);\n            }\n            this.on(handler(this.getRoot()), ctrlKey + \"+A\", function (v, e) {\n                _this.WTable.selectAll();\n                webix.html.preventEvent(e);\n            });\n        };\n        DataViewBase.prototype.GetSearchStats = function (data) {\n            var all = data.length;\n            var folders = data.filter(function (i) { return i.type === \"folder\"; });\n            this.State.searchStats = {\n                folders: folders ? folders.length : 0,\n                files: all - folders.length,\n            };\n        };\n        DataViewBase.prototype.EmptyClick = function () {\n            if (this.State.isActive !== false)\n                this.WTable.unselectAll();\n            else\n                this.ShiftFocus();\n        };\n        return DataViewBase;\n    }(JetView));\n\n    var CardsView = (function (_super) {\n        __extends(CardsView, _super);\n        function CardsView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        CardsView.prototype.config = function () {\n            var _this = this;\n            var compact = this.getParam(\"compact\", true);\n            var smallSkin = webix.skin.$name === \"mini\" || webix.skin.$name === \"compact\";\n            var itemSize = smallSkin\n                ? {\n                    height: 149,\n                    width: 181,\n                    padding: 16,\n                }\n                : {\n                    height: 197,\n                    width: 236,\n                    padding: 20,\n                };\n            return {\n                view: \"dataview\",\n                localId: \"cards\",\n                drag: !compact,\n                select: true,\n                multiselect: true,\n                css: \"webix_noselect webix_fmanager_cards\",\n                template: function (obj) { return _this.CardTemplate(obj); },\n                type: __assign(__assign({}, itemSize), { type: \"tiles\" }),\n                on: {\n                    onItemDblClick: function () { return _this.Activate(_this.GetSelection()); },\n                    onEnter: function () { return _this.Activate(_this.GetSelection()); },\n                    onBeforeDrag: function (ctx) { return _this.DragMarker(ctx); },\n                    onBeforeDrop: function (ctx) { return _this.MoveFiles(ctx.source, ctx.target); },\n                },\n                onClick: {\n                    webix_fmanager_menu_icon: function (e) {\n                        _this.Menu.Show(e);\n                    },\n                    webix_dataview: function (e, id) {\n                        if (!id)\n                            _this.EmptyClick();\n                    },\n                },\n                onContext: {},\n            };\n        };\n        CardsView.prototype.init = function () {\n            this.WTable = this.$$(\"cards\");\n            _super.prototype.init.call(this);\n        };\n        CardsView.prototype.RenderData = function (data) {\n            var _this = this;\n            this.WTable.sync(data, function () { return _this.WTable.filter(function (f) { return f.value !== \"..\"; }); });\n        };\n        CardsView.prototype.CardTemplate = function (obj) {\n            var _ = this.app.getService(\"locale\")._;\n            var preview, panel;\n            if (obj.type === \"folder\") {\n                preview = \"<div class=\\\"webix_fmanager_card_preview\\\">\" + folderCardIcon + \"</div>\";\n                panel = \"<div class=\\\"webix_fmanager_card_panel\\\">\\n\\t\\t<span class=\\\"webix_fmanager_card_label\\\">\" + _(\"Folder\") + \"</span>\\n\\t\\t<span class=\\\"webix_fmanager_card_name folder\\\">\" + this.SearchTemplate(obj.value) + \"</span>\" + menuIcon + \"\\n\\t\\t</div>\";\n            }\n            else {\n                var skin = webix.skin.$active;\n                var picSize = skin.listItemHeight < 29 ? [163, 92] : [214, 124];\n                var origin_1 = this.app\n                    .getService(\"backend\")\n                    .previewURL(obj, picSize[0], picSize[1]);\n                var img = \"<img height=\\\"\" + picSize[1] + \"\\\" width=\\\"\" + picSize[0] + \"\\\" src=\\\"\" + origin_1 + \"\\\" onerror='this.style.display=\\\"none\\\"'/>\";\n                preview = \"<div class=\\\"webix_fmanager_card_preview file\\\">\" + img + \"</div>\";\n                var fileIcon = this.Icon(obj);\n                panel = \"<div class=\\\"webix_fmanager_card_panel file\\\">\\n\\t\\t<span class=\\\"webix_fmanager_card_name\\\">\" + fileIcon + \"<span class=\\\"file_name_text\\\">\" + this.SearchTemplate(obj.value) + \"</span></span>\" + menuIcon + \"\\n\\t\\t</div>\";\n            }\n            return preview + panel;\n        };\n        CardsView.prototype.SearchTemplate = function (name) {\n            if (this.State.search) {\n                var rex = new RegExp(\"(\" + this.State.search + \")\", \"gi\");\n                return name.replace(rex, \"<span class='webix_fmanager_search_mark'>$1</span>\");\n            }\n            return name;\n        };\n        return CardsView;\n    }(DataViewBase));\n\n    webix.protoUI({\n        name: \"codemirror-editor\",\n        defaults: {\n            mode: \"javascript\",\n            lineNumbers: true,\n            matchBrackets: true,\n            theme: \"default\"\n        },\n        $init: function (config) {\n            this.$view.innerHTML = \"<textarea style='width:100%;height:100%;'></textarea>\";\n            this._textarea = this.$view.firstChild;\n            this._waitEditor = webix.promise.defer();\n            this.$ready.push(this._render_cm_editor);\n        },\n        complex_types: {\n            php: {\n                mode: [\"xml\", \"javascript\", \"css\", \"htmlmixed\", \"clike\"]\n            },\n            htmlembedded: {\n                mode: [\"xml\", \"javascript\", \"css\", \"htmlmixed\"],\n                addon: [\"mode/multiplex\"]\n            },\n            htmlmixed: {\n                mode: [\"xml\", \"javascript\", \"css\"]\n            },\n            dockerfile: {\n                addon: [\"mode/simple\"]\n            }\n        },\n        _render_cm_editor: function () {\n            if (this.config.cdn === false) {\n                this._render_when_ready;\n                return;\n            }\n            var cdn = this.config.cdn || \"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/\";\n            var sources = [\n                cdn + \"/codemirror.css\",\n                cdn + \"/codemirror.js\"\n            ];\n            var mode = this.config.mode ? this.config.mode : \"javascript\";\n            var extras = this.complex_types[mode];\n            if (extras) {\n                if (extras[\"mode\"]) {\n                    extras[\"mode\"].forEach(function (name) {\n                        var path = \"/mode/\" + name + \"/\" + name + \".js\";\n                        sources.push(cdn + path);\n                    });\n                }\n                if (extras[\"addon\"]) {\n                    extras[\"addon\"].forEach(function (name) {\n                        var path = \"/addon/\" + name + \".js\";\n                        sources.push(cdn + path);\n                    });\n                }\n            }\n            sources.push(cdn + \"/mode/\" + mode + \"/\" + mode + \".js\");\n            if (this.config.theme && this.config.theme !== \"default\") {\n                sources.push(cdn + \"/theme/\" + this.config.theme + \".css\");\n            }\n            if (this.config.matchBrackets) {\n                sources.push(cdn + \"/addon/edit/matchbrackets.js\");\n            }\n            webix.require(sources)\n                .then(webix.bind(this._render_when_ready, this))\n                .catch(function (e) {\n                console.log(e);\n            });\n        },\n        _render_when_ready: function () {\n            this._editor = CodeMirror.fromTextArea(this._textarea, {\n                mode: this.config.mode,\n                lineNumbers: this.config.lineNumbers,\n                matchBrackets: this.config.matchBrackets,\n                theme: this.config.theme\n            });\n            this._waitEditor.resolve(this._editor);\n            this.setValue(this.config.value);\n            if (this._focus_await)\n                this.focus();\n        },\n        _set_inner_size: function () {\n            if (!this._editor || !this.$width)\n                return;\n            this._updateScrollSize();\n            this._editor.scrollTo(0, 0);\n        },\n        _updateScrollSize: function () {\n            var box = this._editor.getWrapperElement();\n            var height = (this.$height || 0) + \"px\";\n            box.style.height = height;\n            box.style.width = (this.$width || 0) + \"px\";\n            var scroll = this._editor.getScrollerElement();\n            if (scroll.style.height != height) {\n                scroll.style.height = height;\n                this._editor.refresh();\n            }\n        },\n        $setSize: function (x, y) {\n            if (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n                this._set_inner_size();\n            }\n        },\n        setValue: function (value) {\n            if (!value && value !== 0)\n                value = \"\";\n            this.config.value = value;\n            if (this._editor) {\n                this._editor.setValue(value);\n                if (!this.config.preserveUndoHistory)\n                    this._editor.clearHistory();\n                this._updateScrollSize();\n            }\n        },\n        getValue: function () {\n            return this._editor ? this._editor.getValue() : this.config.value;\n        },\n        focus: function () {\n            this._focus_await = true;\n            if (this._editor)\n                this._editor.focus();\n        },\n        getEditor: function (waitEditor) {\n            return waitEditor ? this._waitEditor : this._editor;\n        },\n        undo: function () {\n            this._editor.undo();\n        },\n        redo: function () {\n            this._editor.redo();\n        },\n        undoLength: function () {\n            return this._editor.historySize().undo;\n        }\n    }, webix.ui.view);\n\n    var typeHash = {\n        css: [\"css\", \"less\"],\n        go: [\"go\"],\n        htmlmixed: [\"html\", \"xml\", \"svg\"],\n        javascript: [\"js\", \"mjs\", \"json\", \"ts\", \"coffee\"],\n        markdown: [\"md\"],\n        php: [\"php\", \"phtml\", \"php3\", \"php4\", \"php5\", \"php7\", \"php-s\", \"pht\", \"phar\"],\n        python: [\"py\", \"pyc\", \"pyd\", \"pyo\", \"pyw\", \"pyz\"],\n        sql: [\"sql\", \"sqlite3\", \"sqlite\", \"db\"],\n        yaml: [\"yaml\", \"yml\"],\n        shell: [\"sh\"],\n    };\n    var EditorView = (function (_super) {\n        __extends(EditorView, _super);\n        function EditorView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        EditorView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            this.File = this.getParam(\"file\");\n            var fileType = this.GetFileType(this.File);\n            return {\n                type: \"wide\",\n                rows: [\n                    {\n                        view: \"toolbar\",\n                        padding: { left: 28, right: 4 },\n                        cols: [\n                            {\n                                view: \"button\",\n                                localId: \"saveBtn\",\n                                type: \"icon\",\n                                label: _(\"Save\"),\n                                icon: \"wxi-check\",\n                                css: \"webix_primary webix_fmanager_editor_save\",\n                                width: 90,\n                                hotkey: \"Ctrl+S\",\n                                click: function () { return _this.Save(); },\n                            },\n                            { width: 10 },\n                            {\n                                view: \"label\",\n                                label: \" \",\n                                localId: \"name\",\n                                css: \"webix_fmanager_editor_name\",\n                            },\n                            { gravity: 0.3 },\n                            {\n                                view: \"icon\",\n                                icon: \"wxi-close\",\n                                hotkey: \"esc\",\n                                click: function () { return _this.Confirm(); },\n                            },\n                        ],\n                    },\n                    {\n                        view: \"codemirror-editor\",\n                        localId: \"editor\",\n                        mode: fileType,\n                        theme: webix.skin.$name === \"contrast\" ? \"monokai\" : \"default\",\n                    },\n                ],\n            };\n        };\n        EditorView.prototype.init = function () {\n            var _this = this;\n            this.$$(\"name\").setValue(\"<div class=\\\"filename\\\">\" + this.ClipName(this.File.id) + \"</div><span class=\\\"extension\\\">.\" + this.File.$ext + \"</span>\");\n            var editor = this.$$(\"editor\");\n            webix.extend(editor, webix.ProgressBar);\n            editor.showProgress({\n                type: \"top\",\n            });\n            this.app\n                .getService(\"operations\")\n                .read(this.File.id)\n                .then(function (text) {\n                _this._oldValue = text;\n                editor.getEditor(true).then(function () {\n                    editor.setValue(text);\n                });\n            })\n                .finally(function () {\n                editor.hideProgress();\n            });\n            editor.getEditor(true).then(function (editorObj) {\n                editorObj.on(\"changes\", function () { return _this.TextChanged(editor); });\n            });\n        };\n        EditorView.prototype.Back = function () {\n            this.show(\"/top\", { params: { state: this.getParam(\"state\") } });\n        };\n        EditorView.prototype.Confirm = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            if (this._changed)\n                webix\n                    .confirm({\n                    text: _(\"Are you sure you want to exit without saving?\"),\n                })\n                    .then(function () { return _this.Back(); });\n            else\n                this.Back();\n        };\n        EditorView.prototype.Save = function () {\n            var content = this.$$(\"editor\").getValue();\n            this.app.getService(\"operations\").write(this.File.id, content);\n            this._oldValue = content;\n            this.ChangeTextState(false);\n        };\n        EditorView.prototype.GetFileType = function (file) {\n            if (file.value === \"Dockerfile\")\n                return \"dockerfile\";\n            if (file.$ext) {\n                for (var type in typeHash) {\n                    if (typeHash[type].indexOf(file.$ext) !== -1) {\n                        return type;\n                    }\n                }\n            }\n            return \"htmlmixed\";\n        };\n        EditorView.prototype.TextChanged = function (editor) {\n            var isEqual = editor.getValue() == this._oldValue;\n            this.ChangeTextState(!isEqual);\n        };\n        EditorView.prototype.ChangeTextState = function (state) {\n            if (state === !!this._changed)\n                return;\n            this._changed = state;\n            var button = this.$$(\"saveBtn\");\n            button.config.icon = state ? \"webix_fmanager_icon fmi-circle\" : \"wxi-check\";\n            button.refresh();\n        };\n        EditorView.prototype.ClipName = function (path) {\n            if (!path)\n                return \"\";\n            var parts = path.split(\".\");\n            return parts.slice(0, parts.length - 1).join(\".\");\n        };\n        return EditorView;\n    }(JetView));\n\n    function fileNameSelectMask(input) {\n        var extIndex = input.value.lastIndexOf(\".\");\n        if (extIndex > -1)\n            input.setSelectionRange(0, extIndex);\n        else\n            input.select();\n    }\n    function iterateAsync(arr, code, ctx) {\n        ctx = ctx || { i: 0, cancel: false };\n        if (ctx.i >= arr.length)\n            return;\n        return code(arr[ctx.i], ctx.i).then(function () {\n            ctx.i += 1;\n            if (!ctx.cancel)\n                return iterateAsync(arr, code, ctx);\n        });\n    }\n    function formatTemplate(size) {\n        if (size >= 1000000000)\n            return (size / 1000000000).toFixed(1) + \" Gb\";\n        if (size >= 1000000)\n            return (size / 1000000).toFixed(1) + \" Mb\";\n        if (size >= 1000)\n            return (size / 1000).toFixed(1) + \" kb\";\n        return size + \" b\";\n    }\n    function ext(path) {\n        if (!path)\n            return \"\";\n        var parts = path.split(\".\");\n        if (parts.length < 2)\n            return \"\";\n        return parts[parts.length - 1];\n    }\n    function getLastSelected(files) {\n        return files.length\n            ? files[files.length - 1]\n            : { type: \"empty\", value: \"Nothing is selected\" };\n    }\n    function safeName(str) {\n        str = str.replace(/[/\\\\:*?\"<>|]/g, \"\").trim();\n        while (str[0] === \".\")\n            str = str.substr(1).trim();\n        return str;\n    }\n    function capitalize(str) {\n        if (!str)\n            return \"\";\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    }\n\n    function prompt(config) {\n        var result = new webix.promise.defer();\n        var p = webix.ui({\n            view: \"window\",\n            css: \"webix_fmanager_prompt\",\n            modal: true,\n            move: true,\n            head: {\n                view: \"toolbar\",\n                padding: { left: 12, right: 4 },\n                borderless: true,\n                elements: [\n                    { view: \"label\", label: config.text },\n                    {\n                        view: \"icon\",\n                        icon: \"wxi-close\",\n                        hotkey: \"esc\",\n                        click: function () {\n                            result.reject(\"prompt cancelled\");\n                            p.close();\n                        },\n                    },\n                ],\n            },\n            position: config.master ? \"\" : \"center\",\n            body: {\n                view: \"form\",\n                padding: { top: 0, left: 12, right: 12, bottom: 12 },\n                rows: [\n                    {\n                        margin: 10,\n                        cols: [\n                            {\n                                view: \"text\",\n                                name: \"name\",\n                                value: config.value,\n                                width: 230,\n                                validate: safeName,\n                                css: \"webix_fmanager_prompt_input\",\n                            },\n                            {\n                                view: \"button\",\n                                value: config.button,\n                                css: \"webix_primary\",\n                                width: 100,\n                                hotkey: \"enter\",\n                                click: function () {\n                                    var popup = this.getTopParentView();\n                                    var form = popup.getBody();\n                                    if (form.validate()) {\n                                        var newname = form.getValues().name;\n                                        result.resolve(newname);\n                                        popup.close();\n                                    }\n                                    else {\n                                        webix.UIManager.setFocus(form);\n                                    }\n                                },\n                            },\n                        ],\n                    },\n                ],\n            },\n            on: {\n                onShow: function () {\n                    var input = this.getBody().elements.name.getInputNode();\n                    input.focus();\n                    if (config.selectMask)\n                        config.selectMask(input);\n                    else\n                        input.select();\n                },\n            },\n        });\n        var position = config.master ? { x: 50 } : null;\n        webix.delay(function () { return p.show(config.master, position); });\n        return result;\n    }\n\n    var AddNewMenuView = (function (_super) {\n        __extends(AddNewMenuView, _super);\n        function AddNewMenuView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        AddNewMenuView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            return {\n                view: \"popup\",\n                width: 198,\n                body: {\n                    view: \"menu\",\n                    autoheight: true,\n                    layout: \"y\",\n                    css: \"webix_fmanager_add_new_menu\",\n                    data: [\n                        {\n                            id: \"makefile\",\n                            value: _(\"Add new file\"),\n                            icon: \"webix_fmanager_icon fmi-file-plus-outline\",\n                        },\n                        {\n                            id: \"makedir\",\n                            value: _(\"Add new folder\"),\n                            icon: \"webix_fmanager_icon fmi-folder-plus-outline\",\n                        },\n                        {\n                            id: \"upload\",\n                            value: _(\"Upload file\"),\n                            icon: \"webix_fmanager_icon fmi-file-upload-outline\",\n                        },\n                    ],\n                    on: {\n                        onMenuItemClick: function (id) {\n                            if (id === \"makefile\" || id === \"makedir\") {\n                                var _1 = _this.app.getService(\"locale\")._;\n                                prompt({\n                                    text: _1(\"Enter a new name\"),\n                                    button: _1(\"Add\"),\n                                    selectMask: fileNameSelectMask,\n                                    value: \"New \" + (id === \"makefile\" ? \"file.txt\" : \"folder\"),\n                                }).then(function (name) {\n                                    _this.app.callEvent(\"app:action\", [id, safeName(name)]);\n                                });\n                            }\n                            else {\n                                _this.app.callEvent(\"app:action\", [id]);\n                            }\n                            _this.getRoot().hide();\n                        },\n                    },\n                },\n            };\n        };\n        AddNewMenuView.prototype.Show = function (target) {\n            this.getRoot().show(target, { x: 20 });\n        };\n        return AddNewMenuView;\n    }(JetView));\n\n    var FoldersView = (function (_super) {\n        __extends(FoldersView, _super);\n        function FoldersView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FoldersView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var button = {\n                view: \"button\",\n                value: _(\"Add New\"),\n                inputWidth: 210,\n                css: \"webix_primary\",\n                align: \"center\",\n                click: function () {\n                    this.$scope.Menu.Show(this.$view);\n                },\n            };\n            var navbar = {\n                view: \"tree\",\n                localId: \"tree\",\n                css: \"webix_fmanager_tree\",\n                select: true,\n                drag: \"target\",\n                type: {\n                    template: function (o, common) {\n                        return \"\" + common.icon(o) + common.folder(o) + \" <span>\" + (o.$level === 1 ? _(o.value) : o.value) + \"</span>\";\n                    },\n                    folder: function (o) { return \"<div class='webix_icon wxi-\" + (o.icon || \"folder\") + \"'></div>\"; },\n                },\n                borderless: true,\n                on: {\n                    onBeforeDrop: function (ctx) { return _this.MoveFiles(ctx.source, ctx.target); },\n                    onBeforeContextMenu: function (id) {\n                        if (id.substr(0, 2) !== \"..\")\n                            _this.Tree.select(id);\n                        else\n                            return false;\n                    },\n                },\n            };\n            var FSStats = {\n                localId: \"fs:stats\",\n                borderless: true,\n                height: 68,\n                css: \"webix_fmanager_fsstats\",\n                template: function (obj) {\n                    var used = Math.floor((obj.used / obj.total) * 100);\n                    var activeSkinAccentColor = webix.skin.$active.timelineColor;\n                    var svg = \"<svg width=\\\"100%\\\" height=\\\"20px\\\">\\n<rect y=\\\"1\\\" rx=\\\"4\\\" width=\\\"100%\\\" height=\\\"8\\\" style=\\\"fill:#DFE2E6;\\\" />\\n<rect y=\\\"1\\\" rx=\\\"4\\\" width=\\\"\" + (used ||\n                        0) + \"%\\\" height=\\\"8\\\" style=\\\"fill:\" + activeSkinAccentColor + \";\\\" /></svg>\";\n                    var label = \"<div class=\\\"webix_fmanager_fsstats_label\\\">\" + formatTemplate(obj.used || 0) + \" \" + _(\"of\") + \" \" + formatTemplate(obj.total || 0) + \" \" + _(\"used\") + \"</div>\";\n                    return svg + label;\n                },\n            };\n            var navpanel = {\n                view: \"proxy\",\n                body: {\n                    rows: [button, navbar, FSStats],\n                    padding: { top: 8, bottom: 4 },\n                },\n            };\n            return navpanel;\n        };\n        FoldersView.prototype.init = function () {\n            var _this = this;\n            this.State = this.getParam(\"state\");\n            this.Tree = this.$$(\"tree\");\n            this.Ready = this.app\n                .getService(\"local\")\n                .folders()\n                .then(function (h) {\n                _this.Tree.sync(h);\n                _this.Subscribe();\n                _this.GetFsStats();\n            });\n            this.Menu = this.ui(AddNewMenuView);\n            this.ContextMenu = this.ui(new (this.app.dynamic(ContextMenuView))(this.app, \"\", {\n                compact: false,\n                tree: true,\n            }));\n            this.ContextMenu.AttachTo(this.Tree, function (e) {\n                var id = _this.Tree.locate(e);\n                return id ? [_this.Tree.getItem(id)] : null;\n            });\n            this.on(this.app, \"reload:fs:stats\", function () { return _this.GetFsStats(true); });\n        };\n        FoldersView.prototype.Subscribe = function () {\n            var _this = this;\n            this.Tree.attachEvent(\"onAfterSelect\", function () {\n                var v = _this.Tree.getSelectedId();\n                if (v.substr(0, 2) == \"..\") {\n                    _this.State.$batch({\n                        source: v.slice(3),\n                        path: \"/\",\n                    });\n                }\n                else {\n                    _this.State.$batch({\n                        source: _this.GetRootId(v).slice(3),\n                        path: v,\n                    });\n                }\n            });\n            this.on(this.State.$changes, \"path\", function (v) {\n                _this.State.path = v;\n                if (_this.Tree.exists(v)) {\n                    _this.Tree.select(v);\n                    var parent = _this.Tree.getParentId(v);\n                    if (parent)\n                        _this.Tree.open(parent);\n                    _this.Tree.showItem(v);\n                }\n                else\n                    _this.Tree.select(\"../\" + _this.State.source);\n            });\n        };\n        FoldersView.prototype.GetFsStats = function (force) {\n            var _this = this;\n            this.app\n                .getService(\"backend\")\n                .getInfo(force)\n                .then(function (data) {\n                _this.$$(\"fs:stats\").setValues(data.stats);\n            });\n        };\n        FoldersView.prototype.MoveFiles = function (source, target) {\n            if (target === \"../files\")\n                target = \"/\";\n            this.app.getService(\"operations\").move(source, target);\n            return false;\n        };\n        FoldersView.prototype.GetRootId = function (path) {\n            var root;\n            while (path) {\n                root = path;\n                path = this.Tree.getParentId(path);\n            }\n            return root;\n        };\n        return FoldersView;\n    }(JetView));\n\n    var GridView = (function (_super) {\n        __extends(GridView, _super);\n        function GridView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        GridView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var compact = this.getParam(\"compact\", true);\n            var grid = {\n                view: \"datatable\",\n                localId: \"table\",\n                css: \"webix_noselect webix_header_border webix_fmanager_filelist\",\n                select: \"row\",\n                multiselect: true,\n                drag: true,\n                resizeColumn: { headerOnly: true },\n                sort: \"multi\",\n                type: {\n                    backIcon: function () { return backIcon; },\n                    backLabel: function () { return _(\"back to parent folder\"); },\n                },\n                on: {\n                    onItemDblClick: function () { return _this.Activate(_this.GetSelection()); },\n                    onEnter: function () { return _this.Activate(_this.GetSelection()); },\n                    onBeforeDrag: function (ctx) { return _this.DragMarker(ctx); },\n                    onBeforeDrop: function (ctx) { return _this.MoveFiles(ctx.source, ctx.target); },\n                    onBeforeSort: function (_by, dir) { return (sortDir = dir === \"asc\" ? 1 : -1); },\n                },\n                onClick: {\n                    webix_ss_center_scroll: function () { return _this.EmptyClick(); },\n                    webix_column: function () { return false; },\n                },\n                columns: [\n                    {\n                        id: \"value\",\n                        header: \"\",\n                        template: function (obj) { return _this.NameTemplate(obj); },\n                        sort: sort(\"value\"),\n                        fillspace: true,\n                    },\n                    {\n                        id: \"size\",\n                        header: _(\"Size\"),\n                        template: function (obj) {\n                            return obj.type !== \"folder\" ? formatTemplate(obj.size) : \"\";\n                        },\n                        sort: sort(\"size\"),\n                    },\n                    {\n                        id: \"date\",\n                        header: _(\"Date\"),\n                        sort: sort(\"date\"),\n                        format: function (date) {\n                            if (date instanceof Date && !isNaN(date))\n                                return webix.i18n.longDateFormatStr(date);\n                            else\n                                return \"\";\n                        },\n                        width: 150,\n                    },\n                ],\n            };\n            if (compact) {\n                grid.columns.splice(1, 2);\n            }\n            return grid;\n        };\n        GridView.prototype.init = function () {\n            var _this = this;\n            this.WTable = this.$$(\"table\");\n            _super.prototype.init.call(this);\n            this.on(this.State.$changes, \"isActive\", function (v) {\n                if (!v) {\n                    _this._Track = false;\n                    _this.WTable.unselect();\n                    _this._Track = true;\n                }\n                else {\n                    _this.SelectActive();\n                    webix.delay(function () { return webix.UIManager.setFocus(_this.WTable); });\n                }\n            });\n            this.on(handler(this.getRoot()), \"TAB\", function () {\n                if (_this.getParam(\"trackActive\", true))\n                    _this.State.isActive = false;\n            });\n        };\n        GridView.prototype.RenderData = function (data) {\n            this.WTable.sync(data);\n        };\n        GridView.prototype.NameTemplate = function (obj) {\n            return obj.type === \"folder\"\n                ? folderIcon + obj.value\n                : this.Icon(obj) + \"<span class=\\\"file-name\\\">\" + obj.value + \"</span>\";\n        };\n        return GridView;\n    }(DataViewBase));\n    var sortDir;\n    function sort(by) {\n        return function (a, b) {\n            if (a.value === \"..\" || (a.type === \"folder\" && b.type !== \"folder\"))\n                return -1 * sortDir;\n            if (b.value === \"..\" || (b.type === \"folder\" && a.type !== \"folder\"))\n                return 1 * sortDir;\n            return a[by] < b[by] ? -1 : a[by] > b[by] ? 1 : 0;\n        };\n    }\n\n    var PreviewPopupView = (function (_super) {\n        __extends(PreviewPopupView, _super);\n        function PreviewPopupView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        PreviewPopupView.prototype.config = function () {\n            return {\n                view: \"window\",\n                head: false,\n                fullscreen: true,\n                body: { $subview: true, branch: true, name: \"preview\" },\n            };\n        };\n        PreviewPopupView.prototype.IsVisible = function () {\n            return this.getRoot().isVisible();\n        };\n        PreviewPopupView.prototype.Show = function (params) {\n            this.show(\"preview\", {\n                target: \"preview\",\n                params: { state: params.state, compact: true },\n            });\n            this.getRoot().show();\n        };\n        PreviewPopupView.prototype.Hide = function () {\n            this.show(\"_blank\", {\n                target: \"preview\",\n            });\n            this.getRoot().hide();\n        };\n        return PreviewPopupView;\n    }(JetView));\n\n    var SideTreeView = (function (_super) {\n        __extends(SideTreeView, _super);\n        function SideTreeView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        SideTreeView.prototype.config = function () {\n            return {\n                view: \"sidemenu\",\n                width: 300,\n                state: function (state) {\n                    var toolbarHeight = webix.skin.$active.toolbarHeight + 14;\n                    state.top = toolbarHeight;\n                    state.height -= toolbarHeight;\n                },\n                body: FoldersView,\n            };\n        };\n        SideTreeView.prototype.IsVisible = function () {\n            return this.getRoot().isVisible();\n        };\n        SideTreeView.prototype.Show = function () {\n            this.getRoot().show();\n        };\n        return SideTreeView;\n    }(JetView));\n\n    var DoublePanelView = (function (_super) {\n        __extends(DoublePanelView, _super);\n        function DoublePanelView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        DoublePanelView.prototype.config = function () {\n            var panels = {\n                type: \"wide\",\n                cols: [\n                    { $subview: true, branch: true, name: \"left\" },\n                    { view: \"resizer\" },\n                    { $subview: true, branch: true, name: \"right\" },\n                ],\n            };\n            return panels;\n        };\n        DoublePanelView.prototype.init = function () {\n            this.State = this.getParam(\"state\");\n            var left = createState({\n                selectedItem: [].concat(this.State.selectedItem),\n                path: this.State.path,\n                source: this.GetSource(\"left\"),\n                mode: \"list\",\n                isActive: true,\n            });\n            left.selectedItem.$noSelect = this.State.selectedItem.$noSelect;\n            var right = createState({\n                selectedItem: [],\n                path: this.State.path,\n                source: this.GetSource(\"right\"),\n                mode: \"list\",\n                isActive: false,\n            });\n            this._TrackChanges(left, right);\n            this._TrackChanges(right, left);\n            this.show(\"panel/list\", {\n                target: \"left\",\n                params: { trackActive: true, state: left },\n            });\n            this.show(\"panel/list\", {\n                target: \"right\",\n                params: { trackActive: true, state: right },\n            });\n        };\n        DoublePanelView.prototype._TrackChanges = function (state, next) {\n            var _this = this;\n            this.on(state.$changes, \"path\", function (v) {\n                if (state.isActive)\n                    _this.State.path = v;\n            });\n            this.on(state.$changes, \"source\", function (v) { return (_this.State.source = v); });\n            this.on(state.$changes, \"selectedItem\", function (v) {\n                if (state.isActive)\n                    _this.State.selectedItem = v;\n            });\n            this.on(state.$changes, \"isActive\", function (v) {\n                if (v)\n                    _this.State.$batch({\n                        path: state.path,\n                        source: state.source,\n                    });\n                next.isActive = !v;\n            });\n            this.on(this.app, \"pathChanged\", function (opath, npath) {\n                if (!state.isActive &&\n                    (state.path === opath || state.path.indexOf(opath + \"/\") === 0)) {\n                    state.path = state.path.replace(opath, npath);\n                }\n            });\n        };\n        DoublePanelView.prototype.GetSource = function () {\n            return this.State.source;\n        };\n        return DoublePanelView;\n    }(JetView));\n\n    var PanelSearchView = (function (_super) {\n        __extends(PanelSearchView, _super);\n        function PanelSearchView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        PanelSearchView.prototype.config = function () {\n            var _this = this;\n            this.State = this.getParam(\"state\");\n            var _ = this.app.getService(\"locale\")._;\n            var back = {\n                view: \"icon\",\n                icon: \"wxi-angle-left\",\n                click: function () {\n                    _this.State.$batch({\n                        search: \"\",\n                        searchStats: null,\n                    });\n                },\n            };\n            var toolbar = {\n                view: \"toolbar\",\n                cols: [\n                    back,\n                    {\n                        localId: \"header\",\n                        type: \"header\",\n                        borderless: true,\n                        css: \"webix_fmanager_path\",\n                        template: function (obj) {\n                            var text = _(\"Search results in\");\n                            var root = _this.app.getService(\"backend\").getRootName();\n                            var path = \"\";\n                            if (obj && obj.path && obj.path !== \"/\") {\n                                path = webix.template.escape(obj.path);\n                            }\n                            return text + \" \" + root + path;\n                        },\n                    },\n                    {},\n                ],\n            };\n            return {\n                rows: [toolbar, { $subview: true, params: { state: this.State } }],\n            };\n        };\n        PanelSearchView.prototype.init = function () {\n            this.$$(\"header\").setValues({ path: this.State.path });\n        };\n        PanelSearchView.prototype.ready = function () {\n            var _this = this;\n            this.on(this.State.$changes, \"search\", function (v) {\n                v = v.trim();\n                if (v) {\n                    _this.State.selectedItem = [];\n                    _this.getSubView().LoadData(_this.State.path, v);\n                }\n            });\n        };\n        return PanelSearchView;\n    }(JetView));\n\n    var PanelView = (function (_super) {\n        __extends(PanelView, _super);\n        function PanelView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        PanelView.prototype.config = function () {\n            var _this = this;\n            var path = {\n                view: \"template\",\n                localId: \"path\",\n                type: \"header\",\n                borderless: true,\n                css: \"webix_fmanager_path\",\n                template: function (obj) { return _this.RenderPath(obj); },\n                onClick: {\n                    webix_fmanager_path_chunk: function (e) { return _this.ChangePath(e); },\n                },\n            };\n            var refresh = {\n                view: \"icon\",\n                icon: \"wxi-sync\",\n                css: \"webix_fmanager_spec_icon\",\n                tooltip: \"Refresh\",\n                click: function () {\n                    _this.app.getService(\"local\").refresh(_this.State.path);\n                },\n            };\n            var toolbar = {\n                view: \"toolbar\",\n                paddingX: 4,\n                cols: [refresh, path],\n            };\n            return {\n                rows: [\n                    toolbar,\n                    { $subview: true, params: { state: this.getParam(\"state\") } },\n                ],\n            };\n        };\n        PanelView.prototype.init = function () {\n            var _this = this;\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"path\", function (v) { return _this.ProcessPath(v); });\n            var uapi = this.app.getService(\"upload\").getUploader();\n            uapi.addDropZone(this.getRoot().$view);\n            this.on(uapi, \"onBeforeFileDrop\", function (files, e) {\n                if (_this.getRoot().$view.contains(e.target))\n                    uapi.config.tempUrlData = { id: _this.State.path };\n            });\n        };\n        PanelView.prototype.ProcessPath = function (v) {\n            var _this = this;\n            this.app\n                .getService(\"local\")\n                .folders()\n                .then(function (dirs) {\n                var path = [\"/\"];\n                if (v !== \"/\") {\n                    var p = v.split(\"/\");\n                    for (var i = 1, id = \"\"; i < p.length; ++i) {\n                        id += \"/\" + p[i];\n                        path.push(dirs.getItem(id).value);\n                    }\n                }\n                _this.$$(\"path\").setValues({ path: path });\n            });\n        };\n        PanelView.prototype.RenderPath = function (obj) {\n            if (obj.path && obj.path.length) {\n                var icon_1 = \"<span class='webix_icon wxi-angle-right'></span>\";\n                var rootName_1 = this.app.getService(\"backend\").getRootName();\n                var htmlPath_1 = \"\";\n                obj.path.forEach(function (chunk, index) {\n                    htmlPath_1 += \"<span class=\\\"webix_fmanager_path_chunk\\\" data-path=\\\"\" + index + \"\\\">\" + (index ? chunk : rootName_1) + \"</span>\";\n                    if (index < obj.path.length - 1)\n                        htmlPath_1 += icon_1;\n                });\n                return htmlPath_1;\n            }\n            return \"\";\n        };\n        PanelView.prototype.ChangePath = function (e) {\n            var chunkInd = e.target.getAttribute(\"data-path\") * 1;\n            var path = this.State.path.split(\"/\");\n            path.splice(chunkInd + 1, path.length - 1);\n            var newPath = path.join(\"/\") || \"/\";\n            this.State.path = newPath;\n        };\n        return PanelView;\n    }(JetView));\n\n    var InfoPreview = (function (_super) {\n        __extends(InfoPreview, _super);\n        function InfoPreview() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        InfoPreview.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var dateTimeFormat = webix.Date.dateToStr(\"%M %j, %Y&nbsp;&nbsp;&nbsp;&nbsp;%H:%i:%s\");\n            var mainInfo = {\n                css: \"webix_fmanager_preview_info\",\n                localId: \"info\",\n                borderless: true,\n                autoheight: true,\n                template: function (obj) {\n                    if (!obj.id)\n                        return \"\";\n                    var _ = _this.app.getService(\"locale\")._;\n                    var keys = (obj.type === \"folder\"\n                        ? [\"Type\", \"Date\"]\n                        : [\"Type\", \"Size\", \"Date\"]).map(function (k) { return \"<div class='key_value_cell''>\" + _(k) + \"</div>\"; });\n                    var keyCol = \"<div class='key_col'>\" + keys.join(\"\") + \"</div>\";\n                    var values = (obj.type === \"folder\"\n                        ? [capitalize(_(obj.type)), dateTimeFormat(obj.date)]\n                        : [\n                            capitalize(_(obj.type)),\n                            formatTemplate(obj.size),\n                            dateTimeFormat(obj.date),\n                        ]).map(function (v) { return \"<div class='key_value_cell'>\" + v + \"</div>\"; });\n                    var valueCol = \"<div class=\\\"value_col\\\">\" + values.join(\"\") + \"</div>\";\n                    return \"<div>\" + keyCol + valueCol + \"</div>\";\n                },\n            };\n            var extraInfo = {\n                css: \"webix_fmanager_preview_info extra\",\n                localId: \"extra:info\",\n                hidden: true,\n                autoheight: true,\n                template: function (obj) {\n                    var tags = Object.keys(obj);\n                    var keyCol = \"<div class='key_col'>\";\n                    for (var i = 0; i < tags.length; ++i) {\n                        keyCol += \"<div class='key_value_cell key'>\" + tags[i] + \"</div>\";\n                    }\n                    keyCol += \"</div>\";\n                    var valueCol = \"<div class='value_col'>\";\n                    for (var val in obj) {\n                        var value = obj[val].trim();\n                        valueCol += \"<div class='key_value_cell'>\" + (value && value != \"0\"\n                            ? value\n                            : \"<span class='webix_fmanager_id3tags-unknown'>Unknown</span>\") + \"</div>\";\n                    }\n                    valueCol += \"</div>\";\n                    return \"<div><div class=\\\"webix_fmanager_info_header\\\">\\n<span class=\\\"webix_fmanager_icon fmi-information-outline\\\"></span>\\n<span class=\\\"webix_fmanager_info_title\\\">Extra info</span>\\n</div>\" + keyCol + valueCol + \"</div>\";\n                },\n            };\n            var counter = {\n                localId: \"search:counter\",\n                css: \"webix_fmanager_preview_info\",\n                height: 104,\n                borderless: true,\n                template: function (o) {\n                    var keys = [_(\"Folders\"), _(\"Files\")].map(function (k) { return \"<div class='key_value_cell''>\" + _(k) + \"</div>\"; });\n                    var keyCol = \"<div class='key_col search'>\" + keys.join(\"\") + \"</div>\";\n                    var values = [o.folders, o.files].map(function (v) { return \"<div class='key_value_cell'>\" + v + \"</div>\"; });\n                    var valueCol = \"<div class=\\\"value_col search\\\">\" + values.join(\"\") + \"</div>\";\n                    return \"<div>\" + keyCol + valueCol + \"</div>\";\n                },\n            };\n            var infoTabs = {\n                localId: \"info:tabs\",\n                view: \"tabview\",\n                css: \"webix_fmanager_info_tab\",\n                cells: [\n                    {\n                        header: _(\"Information\"),\n                        body: {\n                            padding: 14,\n                            margin: 14,\n                            rows: [mainInfo, extraInfo, {}],\n                        },\n                    },\n                    {\n                        header: _(\"Search results\"),\n                        body: {\n                            padding: 14,\n                            margin: 14,\n                            rows: [counter, {}],\n                        },\n                    },\n                ],\n            };\n            return infoTabs;\n        };\n        InfoPreview.prototype.init = function () {\n            var _this = this;\n            this.Tabview = this.$$(\"info:tabs\");\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"selectedItem\", function (v) {\n                _this.ShowInfo(getLastSelected(v));\n            });\n            this.on(this.State.$changes, \"searchStats\", function (v) {\n                if (v) {\n                    _this.$$(\"search:counter\").setValues(v);\n                }\n                else {\n                    if (!_this.State.selectedItem.length)\n                        _this.Tabview.hide();\n                }\n            });\n        };\n        InfoPreview.prototype.ShowInfo = function (v) {\n            var _this = this;\n            var tabbar = this.Tabview.getTabbar();\n            var infoId = tabbar.config.options[0].id;\n            var counterId = tabbar.config.options[1].id;\n            if (v.type !== \"empty\") {\n                this.SetInfo(this.$$(\"info\"), v);\n                this.SwitchTabs(tabbar, counterId, infoId);\n                var extraInfo_1 = this.$$(\"extra:info\");\n                var meta = this.app.getService(\"backend\").getMeta(v);\n                if (!meta)\n                    extraInfo_1.hide();\n                else\n                    meta\n                        .then(function (data) { return _this.SetExtraInfo(extraInfo_1, data); })\n                        .fail(function () { return extraInfo_1.hide(); });\n            }\n            else {\n                if (!this.State.search)\n                    this.Tabview.hide();\n                else\n                    this.SwitchTabs(tabbar, infoId, counterId);\n            }\n        };\n        InfoPreview.prototype.SetExtraInfo = function (view, data) {\n            if (!_isEmpty(data)) {\n                this.SetInfo(view, data);\n            }\n            else\n                view.hide();\n        };\n        InfoPreview.prototype.SetInfo = function (view, data) {\n            view.setValues(data);\n            view.show();\n        };\n        InfoPreview.prototype.SwitchTabs = function (tab, hide, show) {\n            tab.hideOption(hide);\n            tab.setValue(show);\n            tab.showOption(show);\n            this.Tabview.show();\n        };\n        return InfoPreview;\n    }(JetView));\n    function _isEmpty(obj) {\n        for (var i in obj) {\n            if (typeof obj[i] === \"object\")\n                return _isEmpty(obj[i]);\n            else if (obj[i] && obj[i] !== \"0\")\n                return false;\n        }\n        return true;\n    }\n\n    var PreviewView = (function (_super) {\n        __extends(PreviewView, _super);\n        function PreviewView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        PreviewView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var compact = this.getParam(\"compact\");\n            var skin = webix.skin.$active;\n            var toolbar = {\n                view: \"toolbar\",\n                localId: \"toolbar\",\n                height: skin.toolbarHeight + 2,\n                padding: { right: 6 },\n                elements: [\n                    {\n                        view: \"label\",\n                        localId: \"filename:label\",\n                        css: \"webix_fmanager_preview_name\",\n                    },\n                    {\n                        view: \"icon\",\n                        icon: \"wxi-download\",\n                        css: \"webix_fmanager_spec_icon\",\n                        localId: \"download\",\n                        tooltip: _(\"Download file\"),\n                        click: function () {\n                            _this.app.callEvent(\"app:action\", [\"download\", [_this.FileInfo]]);\n                        },\n                    },\n                    {\n                        view: \"icon\",\n                        icon: \"wxi-close\",\n                        hidden: !compact,\n                        click: function () { return _this.app.callEvent(\"app:action\", [\"toggle-preview\"]); },\n                    },\n                ],\n            };\n            var preview = {\n                view: \"proxy\",\n                minHeight: 413,\n                borderless: true,\n                body: {\n                    $subview: true,\n                    name: \"preview\",\n                },\n            };\n            return {\n                margin: 0.1,\n                rows: [\n                    toolbar,\n                    {\n                        view: \"scrollview\",\n                        borderless: true,\n                        body: {\n                            type: \"wide\",\n                            margin: 10,\n                            rows: [preview, InfoPreview],\n                        },\n                    },\n                ],\n            };\n        };\n        PreviewView.prototype.init = function () {\n            var _this = this;\n            this.on(this.getParam(\"state\").$changes, \"selectedItem\", function (v) {\n                var lastSelected = getLastSelected(v);\n                _this.ShowInfo(lastSelected);\n                _this.FileInfo = lastSelected;\n                var downloadIcon = _this.$$(\"download\");\n                if (lastSelected.type === \"folder\") {\n                    downloadIcon.hide();\n                }\n                else {\n                    downloadIcon.show();\n                }\n            });\n        };\n        PreviewView.prototype.ShowInfo = function (v) {\n            var previewUrl = \"preview.template\";\n            var player = this.app.config.player;\n            if (player && (v.type === \"audio\" || v.type === \"video\")) {\n                previewUrl = \"preview.media\";\n            }\n            if (v.type !== \"empty\") {\n                this.$$(\"filename:label\").setValue(v.value);\n                this.$$(\"toolbar\").show();\n            }\n            else {\n                this.$$(\"toolbar\").hide();\n            }\n            this.show(previewUrl, {\n                target: \"preview\",\n                params: {\n                    info: v,\n                },\n            });\n        };\n        return PreviewView;\n    }(JetView));\n\n    webix.protoUI({\n        name: \"plyr-player\",\n        defaults: {\n            config: {},\n            source: {}\n        },\n        $init: function () {\n            this.$view.innerHTML = '<div class=\"webix_player_parent\"><audio></audio></div>';\n            this._container = this.$view.firstChild.firstChild;\n            this.$view.style.overflow = \"visible\";\n            this._waitView = webix.promise.defer();\n            this.$ready.push(this.render);\n        },\n        getPlayer: function (wait) {\n            return wait ? this._waitView : this._player;\n        },\n        render: function () {\n            if (this.config.cdn === false || window.Plyr) {\n                this._initPlyr();\n                return;\n            }\n            var cdn = this.config.cdn ? this.config.cdn : \"https://cdn.plyr.io/3.5.10\";\n            webix.require([\n                cdn + \"/plyr.js\",\n                cdn + \"/plyr.css\"\n            ])\n                .then(webix.bind(this._initPlyr, this))\n                .catch(function (e) {\n                console.log(e);\n            });\n        },\n        _initPlyr: function () {\n            if (this.$view) {\n                var options = webix.extend({}, this.config.config);\n                this._player = new Plyr(this._container, options);\n                this._player.elements.container.setAttribute(\"tabindex\", \"-1\");\n                this.attachEvent(\"onDestroy\", function () {\n                    if (this._player) {\n                        this._player.destroy();\n                    }\n                });\n                this._waitView.resolve(this._player);\n                this._player.on(\"canplay\", webix.bind(function () {\n                    if (this._player.media) {\n                        this._player.media.setAttribute(\"tabindex\", \"-1\");\n                        this._normalizeRatio();\n                    }\n                }, this));\n                this._player.on(\"ready\", webix.bind(function () {\n                    if (this.$view) {\n                        this.$view.querySelector(\".plyr--full-ui\").style[\"min-width\"] = \"0px\";\n                        this._normalizeRatio();\n                    }\n                }, this));\n            }\n        },\n        $setSize: function (x, y) {\n            this.$view.firstChild.style.width = x + \"px\";\n            this.$view.firstChild.style.height = (y - 2) + \"px\";\n            if (this._player)\n                this._normalizeRatio(x, y);\n        },\n        source_setter: function (value) {\n            this._waitView.then(function (player) {\n                if (value)\n                    player.source = value;\n            });\n        },\n        getPlyr: function (wait) {\n            return wait ? this._waitView : this._player;\n        },\n        _gcdRatio: function (x, y) {\n            x = Math.abs(x);\n            y = Math.abs(y);\n            while (y) {\n                var t = y;\n                y = x % y;\n                x = t;\n            }\n            return x;\n        },\n        _normalizeRatio: function (x, y) {\n            if (this.$view) {\n                x = x || this.$view.clientWidth;\n                y = y || this.$view.clientHeight;\n                var div = this._gcdRatio(x, y), ratioX = (x / div).toString(), ratioY = (y / div).toString(), ratio = ratioX + \":\" + ratioY;\n                this._player.ratio = ratio;\n            }\n        }\n    }, webix.ui.view, webix.EventSystem);\n\n    var MediaPreview = (function (_super) {\n        __extends(MediaPreview, _super);\n        function MediaPreview() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        MediaPreview.prototype.config = function () {\n            return {\n                rows: [\n                    {\n                        localId: \"albumArt\",\n                        hidden: true,\n                        css: \"webix_fmanager_preview\",\n                        template: \"<img class=\\\"webix_fmanager_preview_icon\\\" src=\\\"\" + this.app\n                            .getService(\"backend\")\n                            .icon({ type: \"audio\" }, \"big\") + \"\\\" />\",\n                    },\n                    {\n                        view: \"plyr-player\",\n                        css: \"webix_fmanager_player\",\n                        localId: \"player\",\n                        config: {\n                            controls: [\n                                \"play-large\",\n                                \"play\",\n                                \"progress\",\n                                \"current-time\",\n                                \"mute\",\n                                \"volume\",\n                            ],\n                        },\n                    },\n                ],\n            };\n        };\n        MediaPreview.prototype.init = function () {\n            var _this = this;\n            var node = this.$$(\"albumArt\").$view;\n            webix.event(node, \"dblclick\", function () {\n                var info = _this.getParam(\"info\");\n                _this.app.callEvent(\"app:action\", [\"open\", [info]]);\n            });\n        };\n        MediaPreview.prototype.urlChange = function () {\n            var info = this.getParam(\"info\");\n            this.ShowPreview(info);\n        };\n        MediaPreview.prototype.ShowPreview = function (info) {\n            if (!info)\n                return;\n            var url = this.app.getService(\"backend\").directLink(info.id);\n            this.SetMedia(url, info.type, info.$ext);\n            var art = this.$$(\"albumArt\");\n            var player = this.$$(\"player\");\n            if (info.type === \"audio\") {\n                player.config.height = 52;\n                art.show();\n            }\n            else {\n                player.config.height = 0;\n                art.hide();\n            }\n        };\n        MediaPreview.prototype.SetMedia = function (src, type, ext) {\n            var player = this.$$(\"player\");\n            player.define({\n                source: {\n                    type: type,\n                    sources: [\n                        {\n                            src: src,\n                            type: type + \"/\" + ext,\n                        },\n                    ],\n                },\n            });\n        };\n        return MediaPreview;\n    }(JetView));\n\n    var TemplatePreview = (function (_super) {\n        __extends(TemplatePreview, _super);\n        function TemplatePreview() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TemplatePreview.prototype.config = function () {\n            return {\n                view: \"template\",\n                localId: \"preview\",\n                css: \"webix_fmanager_preview\",\n            };\n        };\n        TemplatePreview.prototype.init = function () {\n            var _this = this;\n            var node = this.getRoot().$view;\n            webix.event(node, \"dblclick\", function () {\n                var info = _this.getParam(\"info\");\n                if (info.type === \"code\" && _this.app.config.editor) {\n                    _this.app.callEvent(\"app:action\", [\"edit\", [info]]);\n                }\n                else if (info.type !== \"folder\" && info.type !== \"empty\") {\n                    _this.app.callEvent(\"app:action\", [\"open\", [info]]);\n                }\n            });\n        };\n        TemplatePreview.prototype.urlChange = function () {\n            var info = this.getParam(\"info\");\n            this.ShowPreview(info);\n        };\n        TemplatePreview.prototype.ShowPreview = function (info) {\n            var preview = this.$$(\"preview\");\n            if (info.type === \"folder\") {\n                preview.setHTML(\"<img class=\\\"webix_fmanager_preview_icon\\\" src=\\\"\" + this.app\n                    .getService(\"backend\")\n                    .icon({ type: \"folder\" }, \"big\") + \"\\\" />\");\n            }\n            else if (info.type === \"empty\") {\n                preview.setHTML(\"<img class=\\\"webix_fmanager_preview_icon\\\" src=\\\"\" + this.app\n                    .getService(\"backend\")\n                    .icon({ type: \"none\" }, \"big\") + \"\\\" />\");\n            }\n            else {\n                var origin_1 = this.app.getService(\"backend\").previewURL(info, 464, 407);\n                preview.setHTML(\"<img style='width:100%; height:100%;' src='\" + origin_1 + \"' onerror='this.style.display=\\\"none\\\"'>\");\n            }\n        };\n        return TemplatePreview;\n    }(JetView));\n\n    var ProgressView = (function (_super) {\n        __extends(ProgressView, _super);\n        function ProgressView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        ProgressView.prototype.config = function () {\n            var _this = this;\n            this.Config = this.getParam(\"config\");\n            return {\n                view: \"window\",\n                position: \"center\",\n                modal: true,\n                css: \"webix_fmanager_progress\",\n                head: {\n                    template: this.Config.head,\n                    css: \"webix_fmanager_progress_head\",\n                    height: 54,\n                },\n                body: {\n                    padding: { top: 0, bottom: 20, left: 20, right: 20 },\n                    margin: 10,\n                    rows: [\n                        {\n                            template: function (obj) {\n                                return \"<div class=\\\"webix_fmanager_progress_bar\\\">\\n<div class=\\\"webix_fmanager_progress_counter\\\">\" + obj.done + \" of \" + obj.total + \" items</div>\\n<div class=\\\"webix_fmanager_progress_name\\\">\" + obj.file + \"</div></div>\";\n                            },\n                            localId: \"counter\",\n                            borderless: true,\n                            height: 59,\n                        },\n                        {\n                            view: \"button\",\n                            value: \"Stop\",\n                            css: \"webix_fmanager_progress_cancel\",\n                            click: function () {\n                                _this.State.cancel = true;\n                                _this.getRoot().disable();\n                            },\n                        },\n                    ],\n                },\n            };\n        };\n        ProgressView.prototype.init = function () {\n            var _this = this;\n            this.WaitClose = webix.promise.defer();\n            this.Counter = this.$$(\"counter\");\n            this.Counter.setValues({\n                done: 0,\n                total: this.Config.files.length,\n                file: this.Config.files[0],\n            });\n            webix.extend(this.Counter, webix.ProgressBar);\n            this.State = createState({ i: 0, cancel: false });\n            iterateAsync(this.Config.files, this.Config.code, this.State).finally(function () {\n                return _this.Close();\n            });\n            this.on(this.State.$changes, \"i\", function (i) { return _this.Step(i + 1); });\n        };\n        ProgressView.prototype.Close = function () {\n            this.Counter.showProgress({ type: \"bottom\", position: 1, delay: 100 });\n            this.show(\"_blank\", { target: \"popup\" });\n            this.WaitClose.resolve();\n        };\n        ProgressView.prototype.Step = function (i) {\n            var done = this.Counter.getValues().done;\n            this.Counter.setValues({ done: i, file: this.Config.files[i - 1] }, true);\n            done = (done + 1) / this.Config.files.length;\n            this.Counter.showProgress({\n                type: \"bottom\",\n                position: Math.min(1, done),\n                delay: 100,\n            });\n        };\n        return ProgressView;\n    }(JetView));\n\n    webix.protoUI({\n        name: \"r-layout\",\n        sizeTrigger: function (width, handler, value) {\n            this._compactValue = value;\n            this._compactWidth = width;\n            this._compactHandler = handler;\n            this._checkTrigger(this.$view.width, value);\n        },\n        _checkTrigger: function (x, value) {\n            if (this._compactWidth) {\n                if ((x <= this._compactWidth && !value) ||\n                    (x > this._compactWidth && value)) {\n                    this._compactWidth = null;\n                    this._compactHandler(!value);\n                    return false;\n                }\n            }\n            return true;\n        },\n        $setSize: function (x, y) {\n            if (this._checkTrigger(x, this._compactValue))\n                return webix.ui.layout.prototype.$setSize.call(this, x, y);\n        },\n    }, webix.ui.layout);\n\n    var TopBarView = (function (_super) {\n        __extends(TopBarView, _super);\n        function TopBarView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopBarView.prototype.config = function () {\n            var _this = this;\n            var compact = this.getParam(\"compact\");\n            var skin = webix.skin.$active;\n            var _ = this.app.getService(\"locale\")._;\n            var bar = {\n                view: \"toolbar\",\n                height: skin.toolbarHeight + 12,\n                margin: 20,\n                paddingY: 9,\n                paddingX: 12,\n                cols: [\n                    {\n                        view: \"icon\",\n                        icon: \"webix_fmanager_icon fmi-file-tree\",\n                        click: function () { return _this.app.callEvent(\"app:action\", [\"toggle-folders\"]); },\n                        hidden: !compact,\n                    },\n                    { view: \"label\", label: _(\"Files\"), autowidth: true, hidden: compact },\n                    {\n                        view: \"search\",\n                        width: compact ? 0 : 300,\n                        localId: \"search\",\n                        placeholder: _(\"Search files and folders\"),\n                    },\n                    { hidden: compact },\n                    {\n                        view: \"toggle\",\n                        css: \"webix_fmanager_preview_toggle\",\n                        type: \"icon\",\n                        icon: \"wxi-eye\",\n                        tooltip: _(\"Preview\"),\n                        width: skin.toolbarHeight < 37 ? 48 : 60,\n                        localId: \"previewMode\",\n                        click: function () { return _this.app.callEvent(\"app:action\", [\"toggle-preview\"]); },\n                        hidden: compact,\n                    },\n                    {\n                        view: \"segmented\",\n                        width: 124,\n                        optionWidth: 40,\n                        localId: \"modes\",\n                        tooltip: function (conf) {\n                            switch (conf.id) {\n                                case \"grid\":\n                                    return _(\"Table\");\n                                case \"cards\":\n                                    return _(\"Cards\");\n                                case \"double\":\n                                    return _(\"Total\");\n                                default:\n                                    return capitalize(conf.id + \"\");\n                            }\n                        },\n                        options: [\n                            { value: gridMode, id: \"grid\" },\n                            { value: cardMode, id: \"cards\" },\n                            { value: doubleMode, id: \"double\" },\n                        ],\n                    },\n                ],\n            };\n            return bar;\n        };\n        TopBarView.prototype.init = function () {\n            var common = this.getParam(\"state\");\n            var modes = this.$$(\"modes\");\n            modes.attachEvent(\"onChange\", function (v) {\n                if (v) {\n                    common.$batch({\n                        mode: v,\n                        search: \"\",\n                    });\n                }\n            });\n            this.on(common.$changes, \"mode\", function (v) {\n                if (modes.getOption(v))\n                    modes.setValue(v);\n                else\n                    modes.setValue();\n            });\n            var search = this.$$(\"search\");\n            search.attachEvent(\"onTimedKeyPress\", function () {\n                common.search = search.getValue().trim();\n            });\n            this.on(common.$changes, \"search\", function (s) {\n                s = s.trim();\n                search.setValue(s);\n            });\n            this.on(handler(), (webix.env.isMac ? \"COMMAND\" : \"CTRL\") + \" + F\", function (v, e) {\n                search.focus();\n                webix.html.preventEvent(e);\n            });\n        };\n        return TopBarView;\n    }(JetView));\n\n    var TopView = (function (_super) {\n        __extends(TopView, _super);\n        function TopView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopView.prototype.config = function () {\n            var fCompact = this.getParam(\"forceCompact\");\n            if (typeof fCompact !== \"undefined\")\n                this.setParam(\"compact\", fCompact);\n            this.Compact = this.getParam(\"compact\");\n            var tree = {\n                view: \"proxy\",\n                localId: \"tree\",\n                width: 240,\n                minWidth: 240,\n                maxWidth: 400,\n                hidden: true,\n                borderless: true,\n                body: FoldersView,\n            };\n            var panels = {\n                type: \"wide\",\n                cols: [\n                    { $subview: true, name: \"center\", branch: true },\n                    {\n                        view: \"proxy\",\n                        borderless: true,\n                        width: 470,\n                        hidden: true,\n                        localId: \"r-side\",\n                        body: {\n                            $subview: \"\",\n                            branch: true,\n                            name: \"r-side\",\n                        },\n                    },\n                ],\n            };\n            if (!this.Compact)\n                panels.cols.unshift(tree, { view: \"resizer\" });\n            return {\n                view: typeof fCompact === \"undefined\" ? \"r-layout\" : \"layout\",\n                type: \"wide\",\n                rows: [TopBarView, panels, { $subview: true, popup: true, name: \"popup\" }],\n            };\n        };\n        TopView.prototype.init = function () {\n            var _this = this;\n            var root = this.getRoot();\n            if (root.sizeTrigger)\n                root.sizeTrigger(this.app.config.compactWidth, function (mode) { return _this.SetCompactMode(mode); }, !!this.Compact);\n            var state = this.getParam(\"state\");\n            this.State = state;\n            if (this.Compact) {\n                this.Tree = { show: dummy, hide: dummy };\n                this.SideTree = this.ui(SideTreeView);\n                this.PreviewPopup = this.ui(PreviewPopupView);\n            }\n            else {\n                this.Tree = this.$$(\"tree\");\n            }\n            this.on(this.app, \"app:action\", function (name) {\n                switch (name) {\n                    case \"toggle-preview\":\n                        _this.TogglePreview();\n                        break;\n                    case \"toggle-folders\":\n                        _this.ToggleFolders();\n                        break;\n                }\n            });\n            this.on(state.$changes, \"mode\", function (v, o) { return _this.ShowMode(v, o); });\n            this.on(state.$changes, \"search\", function (v) { return _this.ShowSearch(v); });\n            this.app\n                .getService(\"progress\")\n                .handle(this.getRoot(), this.ShowProgress.bind(this));\n        };\n        TopView.prototype.ShowMode = function (v, o) {\n            var params = { state: this.getParam(\"state\"), compact: this.Compact };\n            if (v === \"grid\") {\n                this.Tree.show();\n                this.show(\"panel/list\", {\n                    target: \"center\",\n                    params: params,\n                });\n            }\n            else if (v === \"cards\") {\n                this.Tree.show();\n                this.show(\"panel/cards\", {\n                    target: \"center\",\n                    params: params,\n                });\n            }\n            else if (v === \"double\") {\n                this.Tree.hide();\n                this.show(\"panel-double\", {\n                    target: \"center\",\n                    params: params,\n                });\n            }\n            else if (v === \"search\") {\n                this.Tree.hide();\n                this.PrevMode = this.PrevMode || o;\n                this.show(\"panel-search/cards\", {\n                    target: \"center\",\n                    params: params,\n                });\n            }\n        };\n        TopView.prototype.ShowProgress = function (params) {\n            var _this = this;\n            return this.show(\"./progress\", {\n                target: \"popup\",\n                params: params,\n            }).then(function () { return _this.getSubView(\"popup\"); });\n        };\n        TopView.prototype.TogglePreview = function () {\n            if (!this.Compact) {\n                var side = this.$$(\"r-side\");\n                if (!side.isVisible()) {\n                    this.show(\"preview\", {\n                        target: \"r-side\",\n                        params: { state: this.State },\n                    });\n                    side.show();\n                }\n                else {\n                    this.show(\"_blank\", { target: \"r-side\" });\n                    side.hide();\n                }\n            }\n            else {\n                if (!this.PreviewPopup.IsVisible()) {\n                    this.PreviewPopup.Show({ state: this.State });\n                }\n                else {\n                    this.PreviewPopup.Hide();\n                }\n            }\n        };\n        TopView.prototype.ToggleFolders = function () {\n            if (!this.SideTree.IsVisible()) {\n                this.SideTree.Show();\n            }\n        };\n        TopView.prototype.ShowSearch = function (value) {\n            if (value) {\n                this.State.mode = \"search\";\n            }\n            else {\n                if (this.State.mode === \"search\")\n                    this.State.mode = this.PrevMode || \"grid\";\n                this.PrevMode = \"\";\n            }\n        };\n        TopView.prototype.SetCompactMode = function (mode) {\n            this.setParam(\"compact\", mode);\n            this.refresh();\n        };\n        return TopView;\n    }(JetView));\n    function dummy() { }\n\n    var views = { JetView: JetView };\n    views[\"cards\"] = CardsView;\n    views[\"editor\"] = EditorView;\n    views[\"folders\"] = FoldersView;\n    views[\"list\"] = GridView;\n    views[\"menus/addnewmenu\"] = AddNewMenuView;\n    views[\"menus/contextmenu\"] = ContextMenuView;\n    views[\"menus/menubody\"] = MenuBodyView;\n    views[\"mobile/previewpopup\"] = PreviewPopupView;\n    views[\"mobile/sidetree\"] = SideTreeView;\n    views[\"panel-double\"] = DoublePanelView;\n    views[\"panel-search\"] = PanelSearchView;\n    views[\"panel\"] = PanelView;\n    views[\"preview\"] = PreviewView;\n    views[\"preview/info\"] = InfoPreview;\n    views[\"preview/media\"] = MediaPreview;\n    views[\"preview/template\"] = TemplatePreview;\n    views[\"progress\"] = ProgressView;\n    views[\"sections/dataview\"] = DataViewBase;\n    views[\"top\"] = TopView;\n    views[\"topbar\"] = TopBarView;\n\n    var en = {\n        Save: \"Save\",\n        Rename: \"Rename\",\n        Open: \"Open\",\n        Edit: \"Edit\",\n        Delete: \"Delete\",\n        Folder: \"Folder\",\n        \"Add New\": \"Add New\",\n        \"My Files\": \"My Files\",\n        Size: \"Size\",\n        Date: \"Date\",\n        \"back to parent folder\": \"back to parent folder\",\n        Download: \"Download\",\n        Type: \"Type\",\n        Information: \"Information\",\n        Files: \"Files\",\n        Table: \"Table\",\n        Cards: \"Cards\",\n        Total: \"Total\",\n        \"Are you sure ?\": \"Are you sure ?\",\n        Details: \"Details\",\n        \"Enter a new name\": \"Enter a new name\",\n        Add: \"Add\",\n        \"Select something\": \"Select something\",\n        \"Download file\": \"Download file\",\n        Preview: \"Preview\",\n        Refresh: \"Refresh\",\n        \"Are you sure you want to exit without saving?\": \"Are you sure you want to exit without saving?\",\n        Copy: \"Copy\",\n        Cut: \"Cut\",\n        Paste: \"Paste\",\n        \"Deleting...\": \"Deleting...\",\n        \"Copying...\": \"Copying...\",\n        \"Moving...\": \"Moving...\",\n        Folders: \"Folders\",\n        \"Search results\": \"Search results\",\n        \"Search results in\": \"Search results in\",\n        \"Search files and folders\": \"Search files and folders\",\n        \"Add new file\": \"Add new file\",\n        \"Add new folder\": \"Add new folder\",\n        \"Upload file\": \"Upload file\",\n        folder: \"folder\",\n        file: \"file\",\n        archive: \"archive\",\n        audio: \"audio\",\n        image: \"image\",\n        video: \"video\",\n        code: \"code\",\n        document: \"document\",\n        of: \"of\",\n        used: \"used\",\n        \"Open item location\": \"Open item location\",\n        \"Are you sure you want to delete\": \"Are you sure you want to delete\",\n        \"these items:\": \"these items:\",\n        \"this item:\": \"this item:\",\n        \"Delete files\": \"Delete files\",\n        and: \"and\",\n        \"more file(s)\": \"more file(s)\",\n    };\n\n    var Backend = (function () {\n        function Backend(app, url) {\n            this.app = app;\n            this._url = url;\n            this._features = { preview: {}, meta: {} };\n        }\n        Backend.prototype.url = function (path) {\n            return this._url + path;\n        };\n        Backend.prototype.search = function (id, search) {\n            id = id || \"/\";\n            return this._files(this.url(\"files\"), { id: id, search: search });\n        };\n        Backend.prototype.files = function (id) {\n            id = id || \"/\";\n            return this._files(this.url(\"files\"), { id: id });\n        };\n        Backend.prototype._files = function (url, params) {\n            var data = webix.ajax(url, params).then(function (res) { return res.json(); });\n            return this.getInfo().then(function () { return data; });\n        };\n        Backend.prototype.folders = function (id) {\n            id = id || \"/\";\n            var data = webix.ajax(this.url(\"folders\"), { id: id });\n            return data.then(function (a) { return a.json(); });\n        };\n        Backend.prototype.icon = function (obj, size) {\n            return this.url(\"icons/\" + (size || \"small\") + \"/\" + obj.type + \"/\" + obj.$ext + \".svg\");\n        };\n        Backend.prototype.upload = function () {\n            return this.url(\"upload\");\n        };\n        Backend.prototype.readText = function (id) {\n            return webix.ajax(this.url(\"text\"), { id: id }).then(function (data) { return data.text(); });\n        };\n        Backend.prototype.writeText = function (id, content) {\n            return webix\n                .ajax()\n                .post(this.url(\"text\"), {\n                id: id,\n                content: content,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.directLink = function (id, download) {\n            return this.url(\"direct?id=\" + encodeURIComponent(id) + (download ? \"&download=true\" : \"\"));\n        };\n        Backend.prototype.previewURL = function (obj, width, height) {\n            if (!this._features.preview[obj.type])\n                return this.icon(obj, \"big\");\n            return this.url(\"preview?width=\" + width + \"&height=\" + height + \"&id=\" + encodeURIComponent(obj.id));\n        };\n        Backend.prototype.remove = function (id) {\n            return webix\n                .ajax()\n                .post(this.url(\"delete\"), {\n                id: id,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.makedir = function (id, name) {\n            return webix\n                .ajax()\n                .post(this.url(\"makedir\"), {\n                id: id,\n                name: name,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.makefile = function (id, name) {\n            return webix\n                .ajax()\n                .post(this.url(\"makefile\"), {\n                id: id,\n                name: name,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.copy = function (id, to) {\n            return webix\n                .ajax()\n                .post(this.url(\"copy\"), {\n                id: id,\n                to: to,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.move = function (id, to) {\n            return webix\n                .ajax()\n                .post(this.url(\"move\"), {\n                id: id,\n                to: to,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.rename = function (id, name) {\n            return webix\n                .ajax()\n                .post(this.url(\"rename\"), {\n                id: id,\n                name: name,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.getRootName = function () {\n            var _ = this.app.getService(\"locale\")._;\n            return _(\"My Files\");\n        };\n        Backend.prototype.getMeta = function (obj) {\n            if (!this._features.meta[obj.type])\n                return false;\n            return webix\n                .ajax(this.url(\"meta\"), {\n                id: obj.id,\n            })\n                .then(function (r) { return r.json(); });\n        };\n        Backend.prototype.getInfo = function (force) {\n            var _this = this;\n            if (this._info && !force)\n                return this._info;\n            return (this._info = webix.ajax(this.url(\"info\")).then(function (resp) {\n                resp = resp.json();\n                _this._features = resp.features;\n                return resp;\n            }));\n        };\n        return Backend;\n    }());\n\n    var Cache = (function () {\n        function Cache(limit) {\n            this._store = new Map();\n            this._limit = limit;\n            this._i = 1;\n        }\n        Cache.prototype.each = function (code) {\n            this._store.forEach(function (a) { return code(a.obj); });\n        };\n        Cache.prototype.set = function (key, obj) {\n            if (this._store.size >= this._limit)\n                this.prune();\n            this._store.set(key, {\n                obj: obj,\n                key: key,\n                t: this._i++,\n            });\n        };\n        Cache.prototype.get = function (key) {\n            var rec = this._store.get(key);\n            if (!rec)\n                return null;\n            rec.t = this._i++;\n            return rec.obj;\n        };\n        Cache.prototype.prune = function () {\n            var temp = [];\n            this._store.forEach(function (a) { return temp.push(a); });\n            temp = temp.sort(function (a, b) { return (a.t > b.t ? -1 : 1); });\n            for (var i = Math.floor(this._limit / 2); i < temp.length; i++) {\n                this._store.delete(temp[i].key);\n            }\n        };\n        Cache.prototype.delete = function (key) {\n            if (this._store.has(key))\n                this._store.delete(key);\n        };\n        Cache.prototype.clear = function () {\n            this._store.clear();\n        };\n        return Cache;\n    }());\n\n    var LocalData = (function () {\n        function LocalData(app, size) {\n            this.app = app;\n            this.fscache = new Cache(size);\n            this.hierarchy = new webix.TreeCollection();\n            this.folders_ready = null;\n        }\n        LocalData.prototype.defaultDir = function (id) {\n            var dir = [];\n            if (id !== \"/\")\n                dir.push({\n                    type: \"folder\",\n                    value: \"..\",\n                    $row: function (obj, common) {\n                        return (common.backIcon() +\n                            (\"<span class='webix_fmanager_back'>\" + common.backLabel() + \"</span>\"));\n                    },\n                });\n            return dir;\n        };\n        LocalData.prototype.files = function (path, sync) {\n            var fs = this.fscache.get(path);\n            if (sync)\n                return fs;\n            if (fs)\n                return Promise.resolve(fs);\n            fs = new webix.DataCollection({\n                scheme: {\n                    $change: this.prepareData,\n                    $serialize: this.serializeData,\n                },\n            });\n            this.fscache.set(path, fs);\n            return this.reload(fs, path);\n        };\n        LocalData.prototype.serializeData = function (a) {\n            if (a.value == \"..\")\n                return false;\n            else {\n                var o = {};\n                for (var f in a) {\n                    if (f.indexOf(\"$\") !== 0)\n                        o[f] = a[f];\n                }\n                return o;\n            }\n        };\n        LocalData.prototype.prepareData = function (a) {\n            if (typeof a.date === \"number\")\n                a.date = new Date(a.date * 1000);\n            if (a.type === \"folder\")\n                a.$css = a.type;\n            else\n                a.$ext = ext(a.value);\n        };\n        LocalData.prototype.reload = function (fs, path) {\n            var _this = this;\n            return this.app\n                .getService(\"backend\")\n                .files(path)\n                .then(function (data) {\n                fs.clearAll();\n                fs.parse(_this.defaultDir(path).concat(data));\n                return fs;\n            });\n        };\n        LocalData.prototype.refresh = function (path) {\n            var fs = this.fscache.get(path);\n            if (fs)\n                return this.reload(fs, path);\n        };\n        LocalData.prototype.addFile = function (id, item) {\n            var fs = this.fscache.get(id);\n            if (fs) {\n                if (!fs.exists(item.id)) {\n                    fs.add(item, this.getFsPosition(fs, item));\n                }\n            }\n            if (item.type === \"folder\") {\n                if (id === \"/\")\n                    id = \"../files\";\n                this.hierarchy.add(item, null, id);\n            }\n        };\n        LocalData.prototype.getFsPosition = function (fs, item) {\n            if (item.type !== \"folder\")\n                return -1;\n            var d = fs.data;\n            return d.order.findIndex(function (a) { return d.getItem(a).type !== \"folder\"; });\n        };\n        LocalData.prototype.deleteFile = function (item) {\n            var _a = this, fscache = _a.fscache, hierarchy = _a.hierarchy;\n            fscache.each(function (fs) {\n                if (fs && fs.exists(item))\n                    fs.remove(item);\n            });\n            fscache.delete(item);\n            if (hierarchy.exists(item))\n                hierarchy.remove(item);\n        };\n        LocalData.prototype.updateFile = function (oldId, data, newId) {\n            var hierarchy = this.hierarchy;\n            this.fscache.each(function (fs) {\n                if (fs && fs.exists(oldId)) {\n                    fs.updateItem(oldId, data);\n                    if (newId && oldId != newId)\n                        fs.data.changeId(oldId, newId);\n                }\n            });\n            if (hierarchy.exists(oldId)) {\n                hierarchy.updateItem(oldId, data);\n                if (newId && oldId != newId) {\n                    hierarchy.data.changeId(oldId, newId);\n                }\n            }\n        };\n        LocalData.prototype.defaultTree = function () {\n            return [{ value: \"My Files\", id: \"../files\", open: true }];\n        };\n        LocalData.prototype.folders = function (force) {\n            var _this = this;\n            var hierarchy = this.hierarchy;\n            if (force || !this.folders_ready) {\n                this.folders_ready = this.app\n                    .getService(\"backend\")\n                    .folders()\n                    .then(function (data) {\n                    hierarchy.clearAll();\n                    hierarchy.parse(_this.defaultTree());\n                    hierarchy.parse({ parent: \"../files\", data: data });\n                    return hierarchy;\n                });\n            }\n            return this.folders_ready;\n        };\n        return LocalData;\n    }());\n\n    var UploadHandler = (function () {\n        function UploadHandler(app, state) {\n            this.initUploader(app);\n            this.initEvents(app, state);\n        }\n        UploadHandler.prototype.initEvents = function (app, state) {\n            app.attachEvent(\"app:action\", function (name, info) {\n                if (name == \"upload\") {\n                    info = info || (state.path || \"/\");\n                    app.getService(\"upload\").fileDialog(info);\n                }\n            });\n        };\n        UploadHandler.prototype.initUploader = function (app) {\n            this.uploader = webix.ui({\n                view: \"uploader\",\n                apiOnly: true,\n                upload: app.getService(\"backend\").upload(),\n                on: {\n                    onAfterFileAdd: function (item) {\n                        item.urlData = this.config.tempUrlData;\n                    },\n                    onFileUpload: function (file, res) {\n                        app.getService(\"local\").addFile(file.urlData.id, res);\n                    },\n                    onUploadComplete: function () {\n                        app.getService(\"progress\").end();\n                        app.callEvent(\"reload:fs:stats\", []);\n                    },\n                },\n            });\n            this.uploader.$updateProgress = function (_, percent) {\n                app.getService(\"progress\").start(percent / 100);\n            };\n        };\n        UploadHandler.prototype.getUploader = function () {\n            return this.uploader;\n        };\n        UploadHandler.prototype.fileDialog = function (id) {\n            this.uploader.config.tempUrlData = { id: id };\n            this.uploader.fileDialog();\n        };\n        return UploadHandler;\n    }());\n\n    var Progress = (function () {\n        function Progress() {\n            this.view = null;\n            this.popup = null;\n        }\n        Progress.prototype.handle = function (view, popup) {\n            this.view = view;\n            webix.extend(view, webix.ProgressBar);\n            this.popup = popup;\n        };\n        Progress.prototype.start = function (size) {\n            var view = this.view;\n            if (!view || view.$destructed)\n                return;\n            view.showProgress({\n                type: \"top\",\n                delay: 3000,\n                hide: true,\n                progress: size || 0,\n            });\n        };\n        Progress.prototype.end = function () {\n            var view = this.view;\n            if (!view || view.$destructed)\n                return;\n            view.hideProgress();\n        };\n        Progress.prototype.files = function (head, files, code) {\n            var _this = this;\n            if (!files.length)\n                return;\n            if (files.length == 1) {\n                this.start();\n                return code(files[0], 0).finally(function () { return _this.end(); });\n            }\n            if (this.popup)\n                return this.popup({\n                    config: { head: head, files: files, code: code },\n                }).then(function (popup) { return popup.WaitClose; });\n        };\n        return Progress;\n    }());\n\n    var Operations = (function () {\n        function Operations(app, state) {\n            this.app = app;\n            this.state = state;\n            this.initEvents();\n        }\n        Operations.prototype.backend = function () {\n            return this.app.getService(\"backend\");\n        };\n        Operations.prototype.local = function () {\n            return this.app.getService(\"local\");\n        };\n        Operations.prototype.initEvents = function () {\n            var _this = this;\n            this.app.attachEvent(\"app:action\", function (name, info) {\n                switch (name) {\n                    case \"open\":\n                        _this.open(info);\n                        break;\n                    case \"download\":\n                        _this.download(info);\n                        break;\n                    case \"edit\":\n                        _this.edit(info);\n                        break;\n                    case \"delete\":\n                        _this.remove(info);\n                        break;\n                    case \"makefile\":\n                        _this.makeFile(info);\n                        break;\n                    case \"makedir\":\n                        _this.makeFolder(info);\n                        break;\n                    case \"rename\":\n                        _this.rename(info);\n                        break;\n                    case \"copy\":\n                    case \"cut\":\n                        _this.addToClipboard(name);\n                        break;\n                    case \"paste\":\n                        _this.paste();\n                        break;\n                    case \"locate\":\n                        _this.goUp(info);\n                }\n            });\n        };\n        Operations.prototype.write = function (id, content) {\n            var _this = this;\n            return this.backend()\n                .writeText(id, content)\n                .then(function (data) {\n                return _this.local().updateFile(id, { size: data.size, date: data.date });\n            });\n        };\n        Operations.prototype.read = function (id) {\n            return this.backend().readText(id);\n        };\n        Operations.prototype.makeFile = function (name) {\n            var _this = this;\n            var id = this.state.path || \"/\";\n            this.backend()\n                .makefile(id, name)\n                .then(function (res) {\n                if (!res.invalid)\n                    _this.local().addFile(id, res);\n            });\n        };\n        Operations.prototype.makeFolder = function (name) {\n            var _this = this;\n            var id = this.state.path || \"/\";\n            this.backend()\n                .makedir(id, name)\n                .then(function (res) {\n                if (!res.invalid)\n                    _this.local().addFile(id, res);\n            });\n        };\n        Operations.prototype.edit = function (f) {\n            var state = this.state;\n            if (!f)\n                f = state.selectedItem;\n            var file = f[0];\n            if (f.length && file.type === \"code\")\n                this.app.show(\"/editor\", {\n                    params: {\n                        file: file,\n                        state: state,\n                    },\n                });\n        };\n        Operations.prototype.open = function (f) {\n            if (!f)\n                f = this.state.selectedItem;\n            for (var i = 0; i < f.length; ++i) {\n                if (f[i].type != \"folder\") {\n                    window.open(this.backend().directLink(f[i].id), \"_blank\");\n                }\n            }\n        };\n        Operations.prototype.download = function (f) {\n            if (!f)\n                f = this.state.selectedItem;\n            window.open(this.backend().directLink(f[0].id, true), \"_self\");\n        };\n        Operations.prototype.remove = function (files) {\n            var _this = this;\n            var state = this.state;\n            files = this.extractIds(files || state.selectedItem);\n            if (!files.length)\n                return;\n            var _ = this.app.getService(\"locale\")._;\n            return webix\n                .confirm({\n                title: _(\"Delete files\"),\n                text: this.removeConfirmMessage(state.selectedItem),\n                css: \"webix_fmanager_confirm\",\n            })\n                .then(function () {\n                return _this.app\n                    .getService(\"progress\")\n                    .files(_(\"Deleting...\"), files, function (f) {\n                    return _this.backend()\n                        .remove(f)\n                        .then(function (res) {\n                        if (!res.invalid) {\n                            _this.local().deleteFile(f);\n                            if (state.path === f) {\n                                state.path = \"/\";\n                            }\n                            _this.app.callEvent(\"pathChanged\", [f, \"/\"]);\n                            _this.app.callEvent(\"reload:fs:stats\", []);\n                        }\n                    });\n                });\n            })\n                .then(function () {\n                if (state.search) {\n                    state.search = state.search + \" \";\n                }\n            });\n        };\n        Operations.prototype.removeConfirmMessage = function (files) {\n            var _ = this.app.getService(\"locale\")._;\n            var message = \"<div class=\\\"question\\\">\" + _(\"Are you sure you want to delete\") + \" \" + (files.length > 1 ? _(\"these items:\") : _(\"this item:\")) + \"</div>\";\n            var i = 0;\n            var icon = \"&#9679;&nbsp;\";\n            for (var limit = files.length < 6 ? files.length : 5; i < limit; ++i) {\n                message += \"<div class=\\\"item\\\">\" + icon + files[i].value + \"</div>\";\n            }\n            if (i < files.length) {\n                message += \"<div>\" + icon + _(\"and\") + \" \" + (files.length - i) + \" \" + _(\"more file(s)\") + \"</div>\";\n            }\n            return message;\n        };\n        Operations.prototype.rename = function (f) {\n            var _this = this;\n            var state = this.state;\n            var file = f ? f[0] : state.selectedItem[0];\n            if (!file)\n                return;\n            var _ = this.app.getService(\"locale\")._;\n            var oldId = file.id;\n            prompt({\n                text: _(\"Enter a new name\"),\n                button: _(\"Rename\"),\n                value: file.value,\n                selectMask: file.type !== \"folder\" ? fileNameSelectMask : null,\n            }).then(function (name) {\n                name = safeName(name);\n                if (name && name !== file.value)\n                    _this.backend()\n                        .rename(oldId, name)\n                        .then(function (res) {\n                        _this.local().updateFile(oldId, { value: name }, res.id);\n                        if (file.type === \"folder\")\n                            _this.reloadBranch(res.id).then(function () {\n                                if (state.path === oldId) {\n                                    state.path = res.id;\n                                }\n                                _this.app.callEvent(\"pathChanged\", [oldId, res.id]);\n                            });\n                        if (state.search) {\n                            state.search = state.search + \" \";\n                        }\n                    });\n            });\n        };\n        Operations.prototype.reloadBranch = function (id) {\n            var hierarchy = this.local().hierarchy;\n            return this.app\n                .getService(\"backend\")\n                .folders(id)\n                .then(function (data) {\n                var toRemove = [];\n                hierarchy.data.eachChild(id, function (obj) { return toRemove.push(obj.id); });\n                hierarchy.parse({ parent: id, data: data });\n                hierarchy.remove(toRemove);\n            });\n        };\n        Operations.prototype.copy = function (files, targetFolder) {\n            var _this = this;\n            if (!files.length)\n                return;\n            var local = this.local();\n            var _ = this.app.getService(\"locale\")._;\n            return this.app.getService(\"progress\").files(_(\"Copying...\"), files, function (f) {\n                return _this.backend()\n                    .copy(f, targetFolder)\n                    .then(function (res) {\n                    if (!res.invalid) {\n                        local.addFile(targetFolder, res);\n                    }\n                });\n            });\n        };\n        Operations.prototype.move = function (files, targetFolder) {\n            var _this = this;\n            if (!files.length || !targetFolder)\n                return;\n            var local = this.local();\n            var tfs = local.files(targetFolder, true);\n            if (tfs)\n                files = files.filter(function (a) { return !tfs.exists(a); });\n            files = files.filter(function (a) { return a != targetFolder; });\n            if (!files.length)\n                return;\n            var _ = this.app.getService(\"locale\")._;\n            return this.app.getService(\"progress\").files(_(\"Moving...\"), files, function (f) {\n                return _this.backend()\n                    .move(f, targetFolder)\n                    .then(function (res) {\n                    if (!res.invalid) {\n                        local.deleteFile(f);\n                        local.addFile(targetFolder, res);\n                        if (_this.state.path === f) {\n                            _this.state.path = res.id;\n                        }\n                        _this.app.callEvent(\"pathChanged\", [f, res.id]);\n                    }\n                });\n            });\n        };\n        Operations.prototype.extractIds = function (files) {\n            if (!files.length || typeof files[0] == \"string\")\n                return files;\n            var ids = [];\n            for (var i = 0; i < files.length; ++i) {\n                ids.push(files[i].id);\n            }\n            return ids;\n        };\n        Operations.prototype.addToClipboard = function (mode) {\n            var ids = this.extractIds(this.state.selectedItem);\n            if (ids.length)\n                this.state.clipboard = {\n                    files: ids,\n                    mode: mode,\n                };\n        };\n        Operations.prototype.clearClipboard = function () {\n            this.state.clipboard = null;\n        };\n        Operations.prototype.paste = function () {\n            var state = this.state;\n            if (!state.clipboard)\n                return;\n            if (state.clipboard.mode === \"copy\") {\n                this.copy(state.clipboard.files, state.path);\n            }\n            else if (state.clipboard.mode === \"cut\") {\n                this.move(state.clipboard.files, state.path);\n            }\n            this.clearClipboard();\n        };\n        Operations.prototype.goUp = function (files) {\n            var state = this.state;\n            if (state.search) {\n                var file = files ? files[0] : state.selectedItem[0];\n                if (!file)\n                    return;\n                var up = file.id.split(\"/\");\n                var path = \"/\" + up.slice(1, up.length - 1).join(\"/\");\n                state.$batch({\n                    search: \"\",\n                    searchStats: null,\n                    path: path,\n                });\n            }\n        };\n        return Operations;\n    }());\n\n    var App = (function (_super) {\n        __extends(App, _super);\n        function App(config) {\n            var _this = this;\n            var state = createState({\n                mode: config.mode || \"grid\",\n                selectedItem: [],\n                search: \"\",\n                searchStats: null,\n                path: config.path || \"/\",\n                source: config.source || \"files\",\n                clipboard: null,\n            });\n            var defaults = {\n                router: EmptyRouter,\n                version: \"8.0.0\",\n                debug: true,\n                start: \"/top\",\n                params: { state: state, forceCompact: config.compact },\n                editor: true,\n                player: true,\n                compactWidth: 640,\n            };\n            _this = _super.call(this, __assign(__assign({}, defaults), config)) || this;\n            _this.setService(\"backend\", new (_this.dynamic(Backend))(_this, _this.config.url));\n            _this.setService(\"local\", new (_this.dynamic(LocalData))(_this, 10));\n            _this.setService(\"progress\", new (_this.dynamic(Progress))(_this));\n            _this.setService(\"upload\", new (_this.dynamic(UploadHandler))(_this, state));\n            _this.setService(\"operations\", new (_this.dynamic(Operations))(_this, state));\n            _this.use(plugins.Locale, _this.config.locale || {\n                lang: \"en\",\n                webix: {\n                    en: \"en-US\",\n                    zh: \"zh-CN\",\n                },\n            });\n            return _this;\n        }\n        App.prototype.dynamic = function (obj) {\n            return this.config.override ? this.config.override.get(obj) || obj : obj;\n        };\n        App.prototype.require = function (type, name) {\n            if (type === \"jet-views\")\n                return views[name];\n            else if (type === \"jet-locales\")\n                return locales[name];\n            return null;\n        };\n        App.prototype.getState = function () {\n            return this.config.params.state;\n        };\n        return App;\n    }(JetApp));\n    webix.protoUI({\n        name: \"filemanager\",\n        app: App,\n        getState: function () {\n            return this.$app.getState();\n        },\n        getService: function (name) {\n            return this.$app.getService(name);\n        },\n        $init: function () {\n            var state = this.$app.getState();\n            for (var key in state) {\n                link(state, this.config, key);\n            }\n        },\n    }, webix.ui.jetapp);\n    var services = { Backend: Backend, LocalData: LocalData, Upload: UploadHandler, Progress: Progress, Operations: Operations };\n    var locales = { en: en };\n\n    exports.App = App;\n    exports.locales = locales;\n    exports.services = services;\n    exports.views = views;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","var index = 1;\nfunction uid() {\n\treturn index++;\n}\n\nvar empty = undefined;\n\nexport function ignoreInitial(code) {\n\tlet init = false;\n\treturn function() {\n\t\tif (init) return code.apply(this, arguments);\n\t\telse init = true;\n\t};\n}\n\nvar context = null;\nexport function withContext(value, code) {\n\tcontext = value;\n\tcode();\n\tcontext = null;\n}\n\nexport function filter(rule, handler) {\n\treturn function(v, o, obj, meta) {\n\t\tif (rule(v, meta)) handler.apply(this, arguments);\n\t};\n}\n\nexport function link(source, target, key) {\n\tObject.defineProperty(target, key, {\n\t\tget: () => source[key],\n\t\tset: value => (source[key] = value),\n\t});\n}\n\nexport function debounce(handler, delay) {\n\tdelay = delay || 200;\n\tlet timer = null;\n\tlet data = null;\n\treturn function() {\n\t\tdata = arguments;\n\t\tif (!timer) {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = null;\n\n\t\t\t\thandler.apply(this, data);\n\t\t\t}, delay);\n\t\t}\n\t};\n}\n\nexport function createState(data, config) {\n\tconfig = config || {};\n\tconst handlers = {};\n\tconst out = {};\n\n\tconst observe = function(mask, handler) {\n\t\tvar key = uid();\n\t\thandlers[key] = { mask, handler };\n\t\tif (mask === \"*\") handler(out, empty, mask);\n\t\telse handler(out[mask], empty, mask);\n\n\t\treturn key;\n\t};\n\n\tconst observeEnd = function(id) {\n\t\tdelete handlers[id];\n\t};\n\n\tconst queue = [];\n\tlet waitInQueue = false;\n\n\tvar batch = function(code) {\n\t\tif (typeof code !== \"function\") {\n\t\t\tconst values = code;\n\t\t\tcode = () => {\n\t\t\t\tfor (const key in values) out[key] = values[key];\n\t\t\t};\n\t\t}\n\n\t\twaitInQueue = true;\n\t\tcode(out);\n\t\twaitInQueue = false;\n\t\twhile (queue.length) {\n\t\t\tconst obj = queue.shift();\n\t\t\tnotify.apply(this, obj);\n\t\t}\n\t};\n\n\tconst notify = function(key, old, value, meta) {\n\t\tif (waitInQueue) {\n\t\t\tqueue.push([key, old, value, meta]);\n\t\t\treturn;\n\t\t}\n\n\t\tconst list = Object.keys(handlers);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst obj = handlers[list[i]];\n\t\t\tif (!obj) continue;\n\t\t\tif (obj.mask === \"*\" || obj.mask === key) {\n\t\t\t\tobj.handler(value, old, key, meta);\n\t\t\t}\n\t\t}\n\t};\n\n\t// normal js object\n\tfor (const key2 in data) {\n\t\tif (data.hasOwnProperty(key2)) {\n\t\t\tconst test = data[key2];\n\t\t\tif (config.nested && typeof test === \"object\" && test) {\n\t\t\t\tout[key2] = createState(test, config);\n\t\t\t} else {\n\t\t\t\treactive(out, test, key2, notify);\n\t\t\t}\n\t\t}\n\t}\n\n\tObject.defineProperty(out, \"$changes\", {\n\t\tvalue: {\n\t\t\tattachEvent: observe,\n\t\t\tdetachEvent: observeEnd,\n\t\t},\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$observe\", {\n\t\tvalue: observe,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$batch\", {\n\t\tvalue: batch,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\n\treturn out;\n}\n\nfunction reactive(obj, val, key, notify) {\n\tObject.defineProperty(obj, key, {\n\t\tget: function() {\n\t\t\treturn val;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar changed = false;\n\t\t\tif (val === null || value === null) {\n\t\t\t\tchanged = val !== value;\n\t\t\t} else {\n\t\t\t\tchanged = val.valueOf() != value.valueOf();\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tvar old = val;\n\t\t\t\tval = value;\n\t\t\t\tnotify(key, old, value, context);\n\t\t\t}\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t});\n}","export const folderCardIcon =\n\t\"<span class='webix_icon wxi-folder webix_fmanager_folder_icon'></span>\";\nexport const menuIcon =\n\t\"<span class='webix_icon wxi-dots webix_fmanager_menu_icon'></span>\";\nexport const suggestIcon = \"<span class='webix_icon wxi-menu-down'></span>\";\nexport const upIcon = \"<span class='webix_icon wxi-menu-up'></span>\";\nexport const downIcon = \"<span class='webix_icon wxi-menu-down'></span>\";\nexport const folderIcon = \"<span class='webix_icon wxi-folder'></span>\";\nexport const deleteIcon =\n\t\"<span class='webix_fmanager_remove_user webix_icon wxi-trash'></span>\";\n","export default function handler(view) {\n\treturn {\n\t\tattachEvent: (key, handler) => {\n\t\t\twebix.UIManager.addHotKey(key, handler, view);\n\t\t\treturn { key, handler };\n\t\t},\n\t\tdetachEvent: ({ key, handler }) =>\n\t\t\twebix.UIManager.removeHotKey(key, handler, view),\n\t};\n}\n","import hotkey from \"jet-hotkey\";\n\nfunction MoveFiles(files, target) {\n\tif (this.State.source === \"files\") {\n\t\tthis.app.getService(\"operations\").move(files, this.GetTargetFolder(target));\n\t} else if (this.State.source === \"trash\") {\n\t\tthis.app.callEvent(\"app:action\", [\"delete\", files]);\n\t}\n\n\treturn false;\n}\n\nfunction AddHotkeys() {\n\tconst ctrlKey = webix.env.isMac ? \"COMMAND\" : \"CTRL\";\n\n\t// \"delete\" means \"put to trash\", \"remove\" means \"remove from the trash\"\n\tconst operations = [\n\t\t{ key: \"DELETE\", oper: \"delete\", trash: \"remove\" },\n\t\t{ key: \"BACKSPACE\", oper: \"delete\", trash: \"remove\" },\n\t\t{ key: `${ctrlKey}+C`, oper: \"copy\" },\n\t\t{ key: `${ctrlKey}+X`, oper: \"cut\", trash: \"trashed\" },\n\t\t{ key: `${ctrlKey}+V`, oper: \"paste\", trash: \"paste\" },\n\t\t{ key: `${ctrlKey}+R`, oper: \"rename\" },\n\t\t{ key: `${ctrlKey}+O`, oper: \"open\" },\n\t\t{ key: `${ctrlKey}+E`, oper: \"edit\" },\n\t\t{ key: `${ctrlKey}+D`, oper: \"download\" },\n\t];\n\n\tfor (let i = 0; i < operations.length; ++i) {\n\t\tthis.on(hotkey(this.getRoot()), operations[i].key, (v, e) => {\n\t\t\tconst source = this.State.source;\n\t\t\tconst action =\n\t\t\t\tsource !== \"trash\" ? operations[i].oper : operations[i].trash;\n\t\t\tif (action) this.app.callEvent(\"app:action\", [action]);\n\t\t\twebix.html.preventEvent(e);\n\t\t});\n\t}\n}\n\nfunction SourceHandlers() {\n\tthis.on(this.State.$changes, \"source\", (v, o) => {\n\t\tif (o) {\n\t\t\tif (this.State.source !== \"files\") {\n\t\t\t\tthis.State.selectedItem = [];\n\t\t\t\tthis.LoadData(this.State.path, \"\", v);\n\t\t\t} else {\n\t\t\t\tthis.LoadData(this.State.path);\n\t\t\t}\n\t\t}\n\t});\n}\nfunction HandleDrag(ctx) {\n\tconst source = this.State.source;\n\tif (source !== \"files\" && source !== \"trash\") return false;\n\telse {\n\t\tctx.stateSource = source;\n\t\treturn this.__proto__.DragMarker.call(this, ctx);\n\t}\n}\nfunction HandleDrop(ctx) {\n\tif (ctx.stateSource === \"trash\") {\n\t\tif (this.State.source === \"trash\") return false;\n\t\tthis.app.callEvent(\"app:action\", [\n\t\t\t\"restore\",\n\t\t\tctx.source,\n\t\t\tthis.GetTargetFolder(ctx.target),\n\t\t]);\n\t} else return this.MoveFiles(ctx.source, ctx.target);\n}\n\nfunction LoadData(path, search, source) {\n\tif (!source) this.__proto__.LoadData.call(this, path, search);\n\telse {\n\t\tthis._Track = false;\n\t\tconst table = this.WTable;\n\t\tif (table.data.url !== path) {\n\t\t\ttable.clearAll();\n\t\t\tthis.app\n\t\t\t\t.getService(\"local\")\n\t\t\t\t.files(path, false, source)\n\t\t\t\t.then(data => {\n\t\t\t\t\tthis.RenderData(data);\n\t\t\t\t\tthis.SelectActive();\n\t\t\t\t});\n\t\t}\n\t\tthis._Track = true;\n\t}\n}\n\nfunction Activate(item) {\n\tif (!(this.State.source === \"trash\" && item.id !== \"/\")) {\n\t\tif (!item) return; // nothing selected - ignore\n\n\t\tif (item.type === \"folder\") {\n\t\t\tthis.ShowSubFolder(item.value === \"..\" ? item.value : item.id);\n\t\t} else {\n\t\t\tif (\n\t\t\t\titem.type === \"code\" ||\n\t\t\t\t(item.$ext === \"xls\" || item.$ext === \"xlsx\")\n\t\t\t) {\n\t\t\t\tthis.app.callEvent(\"app:action\", [\"edit\", [item]]);\n\t\t\t} else {\n\t\t\t\tthis.app.callEvent(\"app:action\", [\"open\", [item]]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction ShowSubFolder(id) {\n\tthis.__proto__.ShowSubFolder.call(this, id);\n\tthis.State.source = \"files\";\n}\n\nfunction DragMark() {\n\twebix.extend(\n\t\tthis.WTable,\n\t\t{\n\t\t\t$dragMark: ctx => {\n\t\t\t\tif (this.WTable._marked && this.WTable._marked != ctx.target) {\n\t\t\t\t\tthis.WTable.removeCss(this.WTable._marked, \"webix_drag_over\");\n\t\t\t\t}\n\n\t\t\t\tif (ctx.target && this.State.source !== \"trash\") {\n\t\t\t\t\tthis.WTable.addCss(ctx.target, \"webix_drag_over\");\n\t\t\t\t\tthis.WTable._marked = ctx.target;\n\t\t\t\t} else if (\n\t\t\t\t\tthis.State.source == \"trash\" &&\n\t\t\t\t\tctx.stateSource &&\n\t\t\t\t\tctx.stateSource !== \"trash\"\n\t\t\t\t) {\n\t\t\t\t\twebix.html.addCss(this.WTable.$view, \"webix_drag_over\");\n\t\t\t\t}\n\t\t\t},\n\t\t\t$dragOut: (src, ot, nt) => {\n\t\t\t\tif (this.State.source == \"trash\" && ot !== nt) {\n\t\t\t\t\twebix.html.removeCss(this.WTable.$view, \"webix_drag_over\");\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\ttrue\n\t);\n}\n\nexport default function DataviewMixin(node) {\n\tnode.MoveFiles = MoveFiles;\n\tnode.AddHotkeys = AddHotkeys;\n\tnode.SourceHandlers = SourceHandlers;\n\tnode.ShowSubFolder = ShowSubFolder;\n\tnode.Activate = Activate;\n\tnode.LoadData = LoadData;\n\tnode.HandleDrag = HandleDrag;\n\tnode.HandleDrop = HandleDrop;\n\tnode.DragMark = DragMark;\n}\n","import { views } from \"@xbs/filemanager\";\nimport { menuIcon, folderCardIcon } from \"../helpers/icons\";\nimport DataviewMixin from \"helpers/dataview\";\n\nexport default class CardsView extends views[\"cards\"] {\n\tconfig() {\n\t\tDataviewMixin(this);\n\t\treturn this.app\n\t\t\t.getService(\"localusers\")\n\t\t\t.users()\n\t\t\t.then(users => {\n\t\t\t\tthis.Users = users;\n\n\t\t\t\tconst ui = super.config();\n\t\t\t\tui.on.onBeforeDrag = ctx => this.HandleDrag(ctx);\n\t\t\t\tui.on.onBeforeDrop = ctx => this.HandleDrop(ctx);\n\n\t\t\t\treturn ui;\n\t\t\t});\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.SourceHandlers();\n\t\tthis.DragMark();\n\t\twebix.TooltipControl.addTooltip(this.WTable.$view);\n\t}\n\tRenderData(data) {\n\t\tthis.WTable.sync(data, () =>\n\t\t\tthis.WTable.filter(f => f.value && f.value !== \"..\")\n\t\t);\n\t}\n\tCardTemplate(obj) {\n\t\tlet shared = \"\";\n\t\tif (obj.users && obj.users.length) {\n\t\t\tshared = \"<div class='webix_fmanager_card_shared'>\";\n\t\t\tconst circles = [];\n\t\t\tconst offst = obj.users.length > 4 ? 1 : 0;\n\n\t\t\tfor (let i = 0; i < obj.users.length; ++i) {\n\t\t\t\tif (i < 3 || (i === 3 && i - obj.users.length === -1)) {\n\t\t\t\t\tconst user = this.Users.getItem(obj.users[i]);\n\t\t\t\t\tcircles.push(\n\t\t\t\t\t\t`<img class=\"shared_user_name user_${offst + i}\" webix_tooltip=\"${\n\t\t\t\t\t\t\tuser.name\n\t\t\t\t\t\t}<br>(${user.email})\" src=\"${this.app\n\t\t\t\t\t\t\t.getService(\"users\")\n\t\t\t\t\t\t\t.avatarUrl(user.id, user.avatar)}\" />`\n\t\t\t\t\t);\n\t\t\t\t} else break;\n\t\t\t}\n\t\t\tif (offst)\n\t\t\t\tcircles.unshift(\n\t\t\t\t\t`<span class=\"shared_user_name user_plus\">+${obj.users.length -\n\t\t\t\t\t\t3}</span>`\n\t\t\t\t);\n\t\t\tshared += circles.reverse().join(\"\");\n\t\t\tshared += \"</div>\";\n\t\t}\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst star =\n\t\t\tobj.star && this.State.source !== \"trash\"\n\t\t\t\t? \"<div class='webix_fmanager_star'><span class='webix_docmanager_icon dmi-star'></span></div>\"\n\t\t\t\t: \"\";\n\n\t\tlet preview, panel;\n\t\tif (obj.type === \"folder\") {\n\t\t\tpreview = `<div class=\"webix_fmanager_card_preview\">${star}${folderCardIcon}</div>`;\n\n\t\t\tpanel = `<div class=\"webix_fmanager_card_panel\">\n\t\t<span class=\"webix_fmanager_card_label\">${_(\"Folder\")}</span>\n\t\t<span class=\"webix_fmanager_card_name folder\">${this.SearchTemplate(\n\t\t\tobj.value\n\t\t)}</span>${menuIcon}\n\t\t</div>`;\n\t\t} else {\n\t\t\tconst skin = webix.skin.$active;\n\t\t\tconst picSize = skin.listItemHeight < 29 ? [163, 92] : [214, 124];\n\n\t\t\tconst origin = this.app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.previewURL(obj, picSize[0], picSize[1]);\n\t\t\tconst img = `<img height=\"${picSize[1]}\" width=\"${\n\t\t\t\tpicSize[0]\n\t\t\t}\" src=\"${origin}\" onerror='this.style.display=\"none\"'/>`;\n\n\t\t\tpreview = `<div class=\"webix_fmanager_card_preview file\">${star}${img}${shared}</div>`;\n\n\t\t\tconst fileIcon = this.Icon(obj);\n\n\t\t\tpanel = `<div class=\"webix_fmanager_card_panel file\">\n\t\t<span class=\"webix_fmanager_card_name\">${fileIcon}<span class=\"file_name_text\">${this.SearchTemplate(\n\t\t\t\tobj.value\n\t\t\t)}</span></span>${menuIcon}\n\t\t</div>`;\n\t\t}\n\n\t\treturn `<div class=\"webix_fmanager_card_outer\"><div class=\"webix_fmanager_card\" webix_l_id=\"${\n\t\t\tobj.id\n\t\t}\">${preview + panel}</div></div>`;\n\t}\n\n\tSearchTemplate(name) {\n\t\tlet search = this.State.search;\n\n\t\t// remove tags\n\t\tsearch = search.replace(/(#\\w+\\b)/g, \"\").trim();\n\n\t\tif (search) {\n\t\t\t// highlight all words\n\t\t\tconst rex = new RegExp(\"(\" + search.replace(/ +/g, \")|(\") + \")\", \"gi\");\n\n\t\t\treturn name.replace(\n\t\t\t\trex,\n\t\t\t\t\"<span class='webix_fmanager_search_mark'>$&</span>\"\n\t\t\t);\n\t\t}\n\n\t\treturn name;\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\nimport { createState } from \"jet-restate\";\n\nexport default class EditorView extends views[\"editor\"] {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst ui = super.config();\n\n\t\tconst bar = ui.rows[0];\n\n\t\t// Save and Close button to batch \"editor\"\n\t\tbar.visibleBatch = \"editor\";\n\t\tbar.cols[0].batch = \"editor\";\n\t\tbar.cols[bar.cols.length - 1].batch = \"editor\";\n\n\t\tbar.cols.splice(\n\t\t\tbar.cols.length - 1,\n\t\t\t0,\n\t\t\t{\n\t\t\t\tlocalId: \"versionsBtn\",\n\t\t\t\tview: \"button\",\n\t\t\t\ttype: \"icon\",\n\t\t\t\ticon: \"wxi-clock\",\n\t\t\t\tcss: \"webix_transparent webix_fmanager_versions\",\n\t\t\t\tautowidth: true,\n\t\t\t\ttooltip: _(\"Show version history\"),\n\t\t\t\tbatch: \"editor\",\n\t\t\t\thidden: true,\n\t\t\t\tclick: () => this.ConfirmHistory(),\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"restoreBtn\",\n\t\t\t\thidden: true,\n\t\t\t\tvalue: \"Restore this version\",\n\t\t\t\tcss: \"webix_primary\",\n\t\t\t\twidth: 296,\n\t\t\t\tinputWidth: 200,\n\t\t\t\tclick: () => this.RestoreVersion(),\n\t\t\t}\n\t\t);\n\n\t\tconst editor = ui.rows[1];\n\t\tconst main = {\n\t\t\ttype: \"wide\",\n\t\t\tcols: [\n\t\t\t\teditor,\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\thidden: true,\n\t\t\t\t\tlocalId: \"r-side\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\t$subview: true,\n\t\t\t\t\t\tname: \"r-side\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tui.rows[1] = main;\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\t\tthis.OnInit();\n\t}\n\n\tOnInit() {\n\t\tthis.Editor = this.$$(\"editor\");\n\n\t\tthis.State = createState({\n\t\t\tversion: 0,\n\t\t\tcurrent: true,\n\t\t\tdate: null,\n\t\t\tdiff: true,\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"current\", v => {\n\t\t\tif (v) this.$$(\"restoreBtn\").hide();\n\t\t\telse this.$$(\"restoreBtn\").show();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"date\", v => {\n\t\t\tif (v) {\n\t\t\t\tconst barLabel = this.$$(\"name\");\n\t\t\t\tconst old = barLabel.getValue().split(\", \");\n\t\t\t\told[1] = `<span class=\"date\">${this.DateFormat(v).date}</span>`;\n\t\t\t\tbarLabel.setValue(old.join(\", \"));\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"history:close\", () => {\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tDateFormat(date) {\n\t\tif (!date) date = this.File.date;\n\t\tlet format = \"\",\n\t\t\tprep = \"on\";\n\t\tconst today = webix.Date.datePart(new Date()),\n\t\t\tedit = webix.Date.datePart(date, true);\n\n\t\tif (webix.Date.equal(today, edit)) {\n\t\t\tformat = \"%H:%i:%s\";\n\t\t\tprep = \"at\";\n\t\t} else if (edit.getYear() === today.getYear()) {\n\t\t\tformat = \"%F %j\";\n\t\t} else {\n\t\t\tformat = \"%F %j, %Y\";\n\t\t}\n\t\treturn { prep, date: webix.Date.dateToStr(format)(date) };\n\t}\n\n\tSetVersionsButton() {\n\t\tconst btn = this.$$(\"versionsBtn\");\n\t\tif (!this.State.version) {\n\t\t\tif (!btn.isVisible()) btn.show();\n\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tconst format = this.DateFormat();\n\t\t\tbtn.config.label = `${_(`Last edited ${format.prep}`)} ${format.date}`;\n\t\t\tbtn.resize();\n\t\t\tbtn.refresh();\n\t\t}\n\t}\n\n\tConfirmHistory() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (this._changed)\n\t\t\twebix\n\t\t\t\t.confirm(_(\"Unsaved changes will be lost. Are you sure?\"))\n\t\t\t\t.then(() => this.ShowHistory());\n\t\telse this.ShowHistory();\n\t}\n\n\tShowHistory() {\n\t\tthis.show(\"history\", {\n\t\t\ttarget: \"r-side\",\n\t\t\tparams: { file: this.File, state: this.State },\n\t\t});\n\t\tthis.$$(\"r-side\").show();\n\n\t\tthis.SetBatch(\"history\");\n\t}\n\n\tSetBatch(batch) {\n\t\tthis.getRoot()\n\t\t\t.queryView(\"toolbar\")\n\t\t\t.showBatch(batch);\n\t\tthis.Editor.hide();\n\t}\n\n\tRestoreVersion() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix.confirm(_(\"Are you sure ?\")).then(() => {\n\t\t\tthis.app\n\t\t\t\t.getService(\"versions\")\n\t\t\t\t.restore(this.File.id, this.State.version * 1)\n\t\t\t\t.then(data => {\n\t\t\t\t\tthis.File.date = new Date(data.date * 1000);\n\t\t\t\t\tthis.setParam(\"file\", this.File);\n\t\t\t\t\tthis.refresh();\n\t\t\t\t});\n\t\t});\n\t}\n\n\tChangeTextState(state) {\n\t\tsuper.ChangeTextState(state);\n\n\t\tif (!state) this.SetVersionsButton();\n\t}\n\n\tSave() {\n\t\tconst content = this.$$(\"editor\").getValue();\n\t\tif (this._changed) {\n\t\t\tthis.app\n\t\t\t\t.getService(\"operations\")\n\t\t\t\t.write(this.File.id, content)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis._oldValue = content;\n\t\t\t\t\tthis.ChangeTextState(false);\n\t\t\t\t});\n\t\t}\n\t}\n}\n","import EditorView from \"./editor.js\";\nimport hotkey from \"jet-hotkey\";\n\nexport default class SpreadsheetView extends EditorView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tui.rows[1].cols[0] = {\n\t\t\tview: \"excelviewer\",\n\t\t\teditable: true,\n\t\t\teditaction: \"dblclick\",\n\t\t\tcss: \"webix_data_border\",\n\t\t\tareaselect: true,\n\t\t\theader: false,\n\t\t\tlocalId: \"editor\",\n\t\t};\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\t// logic from dm-editor excluding logic from fm-editor\n\t\tthis.OnInit();\n\n\t\tthis.$$(\"name\").setValue(\n\t\t\t`<div class=\"filename\">${this.ClipName(\n\t\t\t\tthis.File.id\n\t\t\t)}</div><span class=\"extension\">.${this.File.$ext}</span>`\n\t\t);\n\n\t\twebix.extend(this.Editor, webix.ProgressBar);\n\t\tthis.Editor.showProgress({ type: \"top\" });\n\n\t\tconst path = this.app.getService(\"backend\").directLink(this.File.id);\n\t\tthis.Editor.load(`binary->${path}`, \"excel\").then(() => {\n\t\t\tthis.Editor.hideProgress();\n\t\t\tthis.SetVersionsButton();\n\t\t});\n\n\t\tthis.on(this.Editor, \"onAfterEditStop\", v => {\n\t\t\tif (v.value != v.old) this.ChangeTextState(true);\n\t\t});\n\n\t\tthis.on(hotkey(this.Editor), \"any\", () => {\n\t\t\tconst sel = this.Editor.getSelectedId();\n\t\t\tif (sel) this.Editor.edit(sel);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"version\", v =>\n\t\t\tthis.ParseVersion(v, this.State.diff)\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"diff\", v =>\n\t\t\tthis.ResetDiffStyle(this.State.version, v)\n\t\t);\n\t}\n\n\tResetDiffStyle(v, diff) {\n\t\tif (v) {\n\t\t\tconst id = this.getSubView(\"r-side\").GetPrevVersion(v);\n\t\t\tif (id) {\n\t\t\t\tthis.StyleDiffCells(diff);\n\t\t\t}\n\t\t\tthis.ResetTotalDiff(id ? false : diff);\n\t\t}\n\t}\n\n\tParseVersion(v, diff) {\n\t\tif (v) {\n\t\t\tthis.Editor.showProgress({ type: \"top\" });\n\t\t\tthis.Editor.clearAll();\n\n\t\t\tconst path = this.app.getService(\"versions\").directLink(v);\n\t\t\tconst id = this.getSubView(\"r-side\").GetPrevVersion(v);\n\n\t\t\tthis.ResetTotalDiff(id ? false : diff);\n\n\t\t\tif (diff && id) {\n\t\t\t\tlet prevPath = this.app.getService(\"versions\").directLink(id);\n\t\t\t\twebix.promise\n\t\t\t\t\t.all([this.ParseExcel(prevPath), this.ParseExcel(path)])\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconst older = res[0];\n\t\t\t\t\t\tconst target = res[1];\n\t\t\t\t\t\tthis.Diffs = this.CollectDiffs(older.data, target.data);\n\t\t\t\t\t\tthis.Editor.parse(target);\n\t\t\t\t\t\tthis.StyleDiffCells(true);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.Editor.load(`binary->${path}`, \"excel\").then(() => {\n\t\t\t\t\tthis.Editor.hideProgress();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tResetTotalDiff(mode) {\n\t\tconst method = mode ? \"addCss\" : \"removeCss\";\n\t\twebix.html[method](this.Editor.$view, \"webix_fmanager_diff_all\");\n\t}\n\n\tParseExcel(url) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.response(\"arraybuffer\")\n\t\t\t.get(url)\n\t\t\t.then(data =>\n\t\t\t\twebix.DataDriver.excel.toObject({\n\t\t\t\t\tdata,\n\t\t\t\t\toptions: { ext: this.File.$ext },\n\t\t\t\t})\n\t\t\t);\n\t}\n\n\tCollectDiffs(old, target) {\n\t\tconst diffs = [];\n\t\tfor (let row = 0; row < target.length; ++row) {\n\t\t\tfor (let col = 0; col < target[row].length; ++col) {\n\t\t\t\tif (target[row][col] != old[row][col]) {\n\t\t\t\t\tdiffs.push([row, col]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn diffs;\n\t}\n\n\tStyleDiffCells(mode) {\n\t\tthis.Editor.showProgress({ type: \"top\" });\n\n\t\tconst method = mode ? \"addCellCss\" : \"removeCellCss\";\n\t\tthis.Diffs.forEach(d => {\n\t\t\tconst colId = this.Editor.columnId(d[1]);\n\t\t\tthis.Editor[method](\n\t\t\t\tthis.Editor.getIdByIndex(d[0]),\n\t\t\t\tcolId,\n\t\t\t\t\"webix_docmanager_diff_excel\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t});\n\n\t\tthis.Editor.render();\n\t\tthis.Editor.hideProgress();\n\t}\n\n\tSave() {\n\t\tthis.Editor.editStop();\n\t\tif (this._changed) {\n\t\t\treturn webix\n\t\t\t\t.toExcel(this.Editor, {\n\t\t\t\t\tdownload: false,\n\t\t\t\t\tstyles: true,\n\t\t\t\t\tspans: true,\n\t\t\t\t\theights: true,\n\t\t\t\t\theader: false,\n\t\t\t\t})\n\t\t\t\t.then(data => {\n\t\t\t\t\treturn this.app\n\t\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t\t.writeBinary(this.File.id, this.File.value, data)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.ChangeTextState(false);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t}\n\t}\n\n\tSetBatch(batch) {\n\t\tthis.getRoot()\n\t\t\t.queryView(\"toolbar\")\n\t\t\t.showBatch(batch);\n\t\tthis.Editor.define(\"editable\", false);\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class FoldersView extends views.folders {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tconst navbar = ui.body.rows[1];\n\t\tnavbar.type.folder = o => {\n\t\t\tconst iconPrefix = o.icon ? o.icon.slice(0, 3) : \"\";\n\t\t\tlet icl = iconPrefix === \"dmi\" ? \"webix_docmanager_icon\" : \"webix_icon\";\n\t\t\treturn `<div class='${icl} ${o.icon || \"wxi-folder\"}'></div>`;\n\t\t};\n\n\t\tnavbar.on.onBeforeDrop = ctx => this.HandleDrop(ctx);\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.DragMark();\n\t}\n\tDragMark() {\n\t\twebix.extend(\n\t\t\tthis.Tree,\n\t\t\t{\n\t\t\t\t$dragMark: ctx => {\n\t\t\t\t\tif (this.Tree._marked && this.Tree._marked != ctx.target) {\n\t\t\t\t\t\tthis.Tree.removeCss(this.Tree._marked, \"webix_drag_over\");\n\t\t\t\t\t}\n\n\t\t\t\t\tif (ctx.target) {\n\t\t\t\t\t\tconst trashing =\n\t\t\t\t\t\t\tctx.target === \"../trash\" && ctx.stateSource !== \"trash\";\n\t\t\t\t\t\tconst toGroupFolder =\n\t\t\t\t\t\t\tctx.target.indexOf(\"..\") === 0 && ctx.target !== \"../files\";\n\t\t\t\t\t\tif (!toGroupFolder || trashing) {\n\t\t\t\t\t\t\tthis.Tree.addCss(ctx.target, \"webix_drag_over\");\n\t\t\t\t\t\t\tthis.Tree._marked = ctx.target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\tHandleDrop(ctx) {\n\t\tif (!ctx.target) return false;\n\n\t\tif (ctx.target === \"../files\") ctx.target = \"/\";\n\n\t\tconst fromTrash = ctx.stateSource === \"trash\";\n\t\tconst toGroupFolder = ctx.target.indexOf(\"..\") === 0;\n\n\t\tif (!toGroupFolder) {\n\t\t\tif (fromTrash) {\n\t\t\t\tthis.app.callEvent(\"app:action\", [\"restore\", ctx.source, ctx.target]);\n\t\t\t} else {\n\t\t\t\tthis.app.getService(\"operations\").move(ctx.source, ctx.target);\n\t\t\t}\n\t\t} else if (ctx.target === \"../trash\" && !fromTrash) {\n\t\t\tthis.app.callEvent(\"app:action\", [\"delete\", ctx.source]);\n\t\t}\n\t\treturn false;\n\t}\n\tSubscribe() {\n\t\tsuper.Subscribe();\n\n\t\tthis.on(this.State.$changes, \"source\", v => {\n\t\t\tif (this.State.path === \"/\") this.Tree.select(\"../\" + v);\n\t\t\tconst addButton = this.getRoot().queryView(\"button\");\n\t\t\tif (v !== \"files\") {\n\t\t\t\taddButton.disable();\n\t\t\t} else {\n\t\t\t\taddButton.enable();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class HistoryView extends views.JetView {\n\tconfig() {\n\t\tthis.File = this.getParam(\"file\");\n\t\tthis.State = this.getParam(\"state\");\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn this.app\n\t\t\t.getService(\"localusers\")\n\t\t\t.users()\n\t\t\t.then(users => {\n\t\t\t\tconst toolbar = {\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\tcss: \"webix_fmanager_history_back\",\n\t\t\t\t\t\t\ticon: \"dmi-arrow-left\",\n\t\t\t\t\t\t\ttooltip: _(\"Back to editor\"),\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tthis.app.callEvent(\"history:close\", []);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\tlabel: _(\"Version history\"),\n\t\t\t\t\t\t\talign: \"center\",\n\t\t\t\t\t\t\tcss: \"webix_fmanager_history_bar\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t};\n\n\t\t\t\tconst check = {\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlocalId: \"diffCheck\",\n\t\t\t\t\tlabelWidth: 12,\n\t\t\t\t\tlabelRight: _(\"Show changes\"),\n\t\t\t\t\tvalue: this.State.diff,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => (this.State.diff = !!v),\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tconst list = {\n\t\t\t\t\ttype: \"form\",\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\trows: [\n\t\t\t\t\t\ttoolbar,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\t\tlocalId: \"list\",\n\t\t\t\t\t\t\twidth: 300,\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tscheme: {\n\t\t\t\t\t\t\t\t$init: this.PrepareDates,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj, users),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonAfterSelect: id => this.SetVersion(id),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcheck,\n\t\t\t\t\t\t{ height: 12 },\n\t\t\t\t\t],\n\t\t\t\t};\n\n\t\t\t\tconst diff = {\n\t\t\t\t\tlocalId: \"diff\",\n\t\t\t\t\tscroll: \"auto\",\n\t\t\t\t\thidden: this.File.type !== \"code\",\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_docmanager_editor_diff\",\n\t\t\t\t};\n\n\t\t\t\tconst ui = { type: \"wide\", cols: [diff, list] };\n\n\t\t\t\treturn ui;\n\t\t\t});\n\t}\n\tinit() {\n\t\tthis.List = this.$$(\"list\");\n\t\tthis.Diff = this.$$(\"diffCheck\");\n\n\t\tthis.dateFormat = webix.Date.dateToStr(\"%F %j, %Y %H:%i:%s\");\n\n\t\tthis.on(this.State.$changes, \"version\", v =>\n\t\t\tthis.GetVersion(v, this.State.diff)\n\t\t);\n\t\tthis.on(this.State.$changes, \"diff\", v =>\n\t\t\tthis.GetVersion(this.List.getSelectedId(), v)\n\t\t);\n\n\t\tthis.LoadData();\n\t}\n\n\tLoadData() {\n\t\tthis.app\n\t\t\t.getService(\"versions\")\n\t\t\t.versions(this.File.id)\n\t\t\t.then(res => {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(res);\n\t\t\t\tthis.List.select(this.List.getFirstId());\n\t\t\t});\n\t}\n\n\tPrepareDates(o) {\n\t\tif (o && typeof o.date === \"string\") o.date = new Date(o.date);\n\t\tif (o && typeof o.origin === \"string\") o.origin = new Date(o.origin);\n\t}\n\n\tListTemplate(obj, users) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet dateline = `<div class=\"webix_fmanager_version_date\">${this.dateFormat(\n\t\t\tobj.date\n\t\t)}</div>`;\n\t\tif (obj.origin) {\n\t\t\tdateline += `<div class=\"webix_fmanager_restore_date\">${_(\n\t\t\t\t\"Restored from\"\n\t\t\t)} ${this.dateFormat(obj.origin)}</div>`;\n\t\t}\n\n\t\tconst user = users.getItem(obj.user);\n\t\tconst face = `<img class=\"webix_fmanager_version_face\" webix_tooltip=\"${\n\t\t\tuser.name\n\t\t}<br>(${user.email})\" src=\"${this.app\n\t\t\t.getService(\"users\")\n\t\t\t.avatarUrl(user.id, user.avatar)}\" />`;\n\t\tconst authorline = `<div class=\"webix_fmanager_version_author\">${face}<span class=\"webix_fmanager_version_name\">${user.name}</span></div>`;\n\n\t\treturn `<div class=\"webix_fmanager_version\">${dateline}${authorline}</div>`;\n\t}\n\n\tSetVersion(id) {\n\t\tconst version = this.List.getItem(id);\n\n\t\tthis.State.$batch({\n\t\t\tversion: id,\n\t\t\tcurrent: webix.Date.equal(this.File.date, version.date),\n\t\t\tdate: version.date,\n\t\t});\n\t}\n\n\tGetVersion(v, diff) {\n\t\tif (v && this.File.type === \"code\") {\n\t\t\tthis.app\n\t\t\t\t.getService(\"versions\")\n\t\t\t\t.readText(v, diff)\n\t\t\t\t.then(text => {\n\t\t\t\t\tif (v == this.List.getLastId() && diff) {\n\t\t\t\t\t\ttext = `<span class=\"webix_docmanager_diff_insert\">${text}</span>`;\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$(\"diff\").setHTML(text);\n\t\t\t\t});\n\t\t}\n\t}\n\n\tGetPrevVersion(curr) {\n\t\treturn this.List.getNextId(curr);\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\nimport DataviewMixin from \"helpers/dataview\";\nimport { folderIcon } from \"helpers/icons\";\n\nexport default class GridView extends views.list {\n\tconfig() {\n\t\tDataviewMixin(this);\n\n\t\tconst grid = super.config();\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tgrid.type.backToFiles = () =>\n\t\t\t_(\"back to \") + this.app.getService(\"backend\").getRootName();\n\n\t\tgrid.on.onBeforeDrag = ctx => this.HandleDrag(ctx);\n\t\tgrid.on.onBeforeDrop = ctx => this.HandleDrop(ctx);\n\n\t\treturn grid;\n\t}\n\tNameTemplate(obj) {\n\t\tconst star =\n\t\t\tobj.star && this.State.source !== \"trash\"\n\t\t\t\t? \"<div class='webix_fmanager_star'><span class='webix_docmanager_icon dmi-star'></span></div>\"\n\t\t\t\t: \"\";\n\t\treturn (\n\t\t\tstar +\n\t\t\t(obj.type === \"folder\"\n\t\t\t\t? folderIcon + obj.value\n\t\t\t\t: `${this.Icon(obj)}<span class=\"file-name\">${obj.value}</span>`)\n\t\t);\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.SourceHandlers();\n\t\tthis.DragMark();\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\n// copy of constants from fm\nconst FOLDER = 0x01;\nconst MANY = 0x02;\nconst TEXT = 0x04;\nconst VIEW = 0x08;\nconst FULL = 0x10;\nconst TREE = 0x20;\nconst SEARCH = 0x40;\n\nconst STAR = 0x80;\nconst TRASH = 0x7f;\n\nexport default class MenuBodyView extends views[\"menus/menubody\"] {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name, config);\n\t\tthis.state = config.state;\n\t}\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst menu = super.config();\n\n\t\tconst options = [\n\t\t\t{\n\t\t\t\t$template: \"Separator\",\n\t\t\t\tshow: TREE,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"favorite\",\n\t\t\t\tshow: FOLDER | TREE | STAR,\n\t\t\t\tvalue: _(\"Add to favorites\"),\n\t\t\t\ticon: \"dmi-star-outline\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"unfavorite\",\n\t\t\t\tshow: FOLDER | TREE | STAR,\n\t\t\t\tvalue: _(\"Remove from favorites\"),\n\t\t\t\ticon: \"dmi-star\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"share\",\n\t\t\t\tvalue: _(\"Share\"),\n\t\t\t\tshow: TREE,\n\t\t\t\ticon: \"dmi-share\",\n\t\t\t},\n\t\t];\n\n\t\tmenu.data.splice(10, 0, ...options);\n\n\t\tmenu.data = menu.data.concat([\n\t\t\t{\n\t\t\t\tid: \"restore\",\n\t\t\t\tvalue: _(\"Restore\"),\n\t\t\t\tshow: TRASH,\n\t\t\t\ticon: \"dmi-delete-restore\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"remove\",\n\t\t\t\tvalue: _(\"Delete from trash\"),\n\t\t\t\tshow: TRASH,\n\t\t\t\ticon: \"dmi-delete-empty\",\n\t\t\t\thotkey: \"Del / &#8592;\",\n\t\t\t},\n\t\t]);\n\n\t\tmenu.template = obj => {\n\t\t\treturn (\n\t\t\t\t(obj.icon\n\t\t\t\t\t? `<span class=\"webix_list_icon webix_icon ${obj.icon}\"></span>`\n\t\t\t\t\t: \"\") +\n\t\t\t\tobj.value +\n\t\t\t\t(obj.hotkey\n\t\t\t\t\t? `<span class=\"webix_fmanager_context-menu-hotkey\">${obj.hotkey}</span>`\n\t\t\t\t\t: \"\")\n\t\t\t);\n\t\t};\n\n\t\treturn menu;\n\t}\n\tFilterOptions(files) {\n\t\tconst source = this.state ? this.state.source : null;\n\t\tconst menu = this.getRoot();\n\t\tthis.Files = files;\n\n\t\tif (source !== \"trash\") {\n\t\t\t// here we fully copy and slightly change super.FilterOptions\n\t\t\tconst file = files[0];\n\t\t\tconst many = files.length > 1;\n\n\t\t\tconst vtypes = [\"image\", \"audio\", \"video\", \"code\", \"pdf\"];\n\t\t\tconst viewable = vtypes.find(t => t === file.type || t === file.$ext);\n\t\t\tconst editable =\n\t\t\t\tfile.type === \"code\" || (file.$ext === \"xls\" || file.$ext === \"xlsx\");\n\t\t\tconst search = this.app.getState().search;\n\n\t\t\tthis.getRoot().define(\"width\", search && !many ? 270 : 200);\n\n\t\t\tthis.getRoot().filter(o => {\n\t\t\t\treturn !(\n\t\t\t\t\t(many && !(o.show & MANY)) ||\n\t\t\t\t\t(file.type === \"folder\" && !(o.show & FOLDER)) ||\n\t\t\t\t\t(o.show & TEXT && !editable) ||\n\t\t\t\t\t(o.show & VIEW && !viewable) ||\n\t\t\t\t\t(o.show & FULL && !this.compact) ||\n\t\t\t\t\t(o.show & TREE && this.tree) ||\n\t\t\t\t\t(o.show & SEARCH && !search) ||\n\t\t\t\t\t(o.show & STAR && file.star\n\t\t\t\t\t\t? o.id === \"favorite\"\n\t\t\t\t\t\t: o.id === \"unfavorite\")\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t// filter out copy-cut-paste section for group folders\n\t\t\tthis.FilterCopyPaste(source, menu);\n\t\t} else {\n\t\t\tmenu.define(\"width\", 250);\n\t\t\tmenu.filter(o => o.id === \"remove\" || o.id === \"restore\");\n\t\t}\n\t}\n\tFilterCopyPaste(source, menu) {\n\t\tif (source !== \"files\") {\n\t\t\tmenu.filter(\n\t\t\t\to => {\n\t\t\t\t\treturn o.show ^ (FOLDER | MANY | TREE) && o.show ^ (FOLDER | TREE);\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class PopupView extends views.JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\");\n\t\tconst label = _(this.getParam(\"label\"));\n\n\t\tconst header = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: { left: 12, right: 4 },\n\t\t\tborderless: true,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\ttemplate: () => label,\n\t\t\t\t\theight: 36,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tcss: \"webix_fmanager_shared_title\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tcss: \"webix_fmanager_shared_close\",\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Hide(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst win = {\n\t\t\tview: \"window\",\n\t\t\tcss: \"webix_fmanager_popup\",\n\t\t\tposition: \"center\",\n\t\t\thead: header,\n\t\t\tmodal: true,\n\t\t\tbody: { $subview: true },\n\t\t};\n\n\t\tif (compact) {\n\t\t\twin.fullscreen = true;\n\t\t} else {\n\t\t\tconst small = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\t\twin.width = small ? 400 : 540;\n\t\t}\n\n\t\treturn win;\n\t}\n\n\tHide() {\n\t\tthis.show(\"_blank\", { target: \"popup\" });\n\t}\n}\n","export function getAvatar(name) {\n\tlet result = \"\";\n\tlet style = stylesheet[Math.floor(Math.random() * stylesheet.length)];\n\tif (typeof name !== \"string\") name = \"\";\n\n\tname = name.split(\" \");\n\n\tfor (let i = 0; i < name.length && result.length < 2; i++)\n\t\tif (name[i]) result += name[i].charAt(0);\n\n\treturn `<div class=\"default_avatar\" style=\"background:${style.bg}; color:${\n\t\tstyle.c\n\t};\">${result || \"no\"}</div>`;\n}\n\nconst stylesheet = [\n\t{ bg: \"#2EADC2\", c: \"#FFFFFF\" },\n\t{ bg: \"#3B3ABB\", c: \"#FFFFFF\" },\n\t{ bg: \"#813EBB\", c: \"#FFFFFF\" },\n\t{ bg: \"#B442A8\", c: \"#FFFFFF\" },\n\t{ bg: \"#B43D64\", c: \"#FFFFFF\" },\n\t{ bg: \"#D25640\", c: \"#FFFFFF\" },\n\t{ bg: \"#DBA10D\", c: \"#FFFFFF\" },\n\t{ bg: \"#7BBD48\", c: \"#FFFFFF\" },\n\t{ bg: \"#5EBD90\", c: \"#FFFFFF\" },\n];\n","import { views } from \"@xbs/filemanager\";\n\nimport { getAvatar } from \"helpers/avatar\";\nimport { deleteIcon } from \"helpers/icons\";\n\nexport default class SharePopupView extends views.JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst input = {\n\t\t\tlocalId: \"users\",\n\t\t\tview: \"text\",\n\t\t\tplaceholder: _(\"Invite someone...\"),\n\t\t\tsuggest: {\n\t\t\t\ttemplate: \"#email#\",\n\t\t\t\tbody: {\n\t\t\t\t\tcss: \"webix_fmanager_user_list\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\ttemplate: obj => this.InputListTemplate(obj),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst label = {\n\t\t\tlocalId: \"counter\",\n\t\t\tborderless: true,\n\t\t\ttemplate: obj => {\n\t\t\t\tif (!obj) return \"&nbsp;\";\n\t\t\t\treturn obj.users\n\t\t\t\t\t? _(\"Available to\") + \" \" + obj.users + \" \" + _(\"user(s)\")\n\t\t\t\t\t: _(\"No users\");\n\t\t\t},\n\t\t\tautoheight: true,\n\t\t};\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"list\",\n\t\t\tcss: \"webix_fmanager_shared_list\",\n\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\ttype: { height: webix.skin.$active.rowHeight },\n\t\t\tautoheight: true,\n\t\t\tyCount: compact ? 0 : 4,\n\t\t\tonClick: {\n\t\t\t\twebix_fmanager_remove_user: (_e, id) => this.RemoveUser(id * 1),\n\t\t\t},\n\t\t};\n\n\t\tconst body = {\n\t\t\tborderless: true,\n\t\t\tpadding: 12,\n\t\t\tmargin: 4,\n\t\t\trows: [\n\t\t\t\tinput,\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Invite\"),\n\t\t\t\t\tinputWidth: 140,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t\tlabel,\n\t\t\t\tlist,\n\t\t\t],\n\t\t};\n\n\t\treturn body;\n\t}\n\tinit() {\n\t\tthis.List = this.$$(\"list\");\n\t\tthis.Input = this.$$(\"users\");\n\t\tthis.File = this.getParam(\"info\", true)[0];\n\n\t\tthis.app\n\t\t\t.getService(\"localusers\")\n\t\t\t.users()\n\t\t\t.then(data => {\n\t\t\t\tthis.Data = data;\n\t\t\t\tconst list = webix.$$(this.Input.config.suggest).getList();\n\t\t\t\tlist.clearAll();\n\t\t\t\tlist.sync(data);\n\n\t\t\t\tlet users = this.File.users;\n\t\t\t\tif (users && users.length) {\n\t\t\t\t\tthis.List.parse(users.map(u => data.getItem(u)));\n\t\t\t\t}\n\t\t\t\tthis.UpdateCounter(users);\n\t\t\t});\n\n\t\tthis.Input.focus();\n\t\twebix.TooltipControl.addTooltip(this.List.$view);\n\t}\n\tRemoveUser(id) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix.confirm(_(\"Are you sure ?\")).then(() =>\n\t\t\tthis.app\n\t\t\t\t.getService(\"operations\")\n\t\t\t\t.removeUser(this.File, id)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.List.remove(id);\n\t\t\t\t\tthis.UpdateCounter(this.File.users);\n\t\t\t\t})\n\t\t);\n\t}\n\tClearInput() {\n\t\tthis.Input.setValue(\"\");\n\t}\n\n\tDone() {\n\t\tlet email = this.Input.getValue();\n\t\tif (email) {\n\t\t\tconst user = this.Data.find(a => a.email === email, true);\n\n\t\t\tif (user && !this.List.find(a => a.id === user.id, true)) {\n\t\t\t\treturn this.app\n\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t.share(this.File, user.id)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.List.add(user);\n\t\t\t\t\t\tthis.List.showItem(user.id);\n\t\t\t\t\t\tthis.ClearInput();\n\t\t\t\t\t\tthis.UpdateCounter(this.File.users);\n\t\t\t\t\t});\n\t\t\t} else this.ClearInput();\n\t\t}\n\t}\n\tListTemplate(obj) {\n\t\tconst avatar = obj.avatar\n\t\t\t? `<img class=\"avatar_img\" webix_tooltip=\"${\n\t\t\t\t\tobj.email\n\t\t\t  }\" src=\"${this.app.getService(\"users\").avatarUrl(obj.id, obj.avatar)}\">`\n\t\t\t: getAvatar(obj.name);\n\n\t\treturn (\n\t\t\tavatar +\n\t\t\t`<span webix_tooltip=\"${obj.email}\">${obj.name}</span>` +\n\t\t\tdeleteIcon\n\t\t);\n\t}\n\tInputListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.name +\n\t\t\t\"&nbsp;\" +\n\t\t\t`<span class=\"webix_fmanager_user_email\">${obj.email}</span>`\n\t\t);\n\t}\n\tUpdateCounter(users) {\n\t\tthis.$$(\"counter\").setValues({ users: users ? users.length : 0 });\n\t\tif (users && users.length) {\n\t\t\twebix.html.removeCss(this.List.$view, \"no-border\");\n\t\t} else {\n\t\t\twebix.html.addCss(this.List.$view, \"no-border\");\n\t\t}\n\t}\n}\n","export function randomColor() {\n\treturn palette[Math.floor(Math.random() * 4)][Math.floor(Math.random() * 4)];\n}\n\nexport const palette = [\n\t[\"#00a037\", \"#13a1aa\", \"#df282f\", \"#fd772c\"],\n\t[\"#6d4bce\", \"#b26bd3\", \"#c87095\", \"#90564d\"],\n\t[\"#eb2f89\", \"#ea77c0\", \"#777676\", \"#a9a8a8\"],\n\t[\"#9bb402\", \"#e7a90b\", \"#0bbed7\", \"#038cd9\"],\n];\n","import { views } from \"@xbs/filemanager\";\nimport { randomColor, palette } from \"../../helpers/common\";\n\nexport default class TagsPopupView extends views.JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst search = {\n\t\t\tmargin: 4,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search a tag\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonTimedKeyPress: () => this.FilterTags(),\n\t\t\t\t\t\tonChange: v => !v && this.FilterTags(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Add\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\twidth: 90,\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.AddTag();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst size = webix.skin.$active.propertyItemHeight + 1;\n\t\tconst list = {\n\t\t\tlocalId: \"tags\",\n\t\t\tview: \"datatable\",\n\t\t\teditable: true,\n\t\t\theader: false,\n\t\t\tyCount: compact ? 0 : 4,\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"name\",\n\t\t\t\t\teditor: \"text\",\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: obj => this.SearchTemplate(obj.name),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"color\",\n\t\t\t\t\teditor: \"color\",\n\t\t\t\t\twidth: 50,\n\t\t\t\t\ttemplate: obj => this.TaglistTemplate(obj),\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\tcss: \"webix_fmanager_palette\",\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\t\t\tpalette,\n\t\t\t\t\t\t\twidth: 4 * size,\n\t\t\t\t\t\t\theight: 4 * size,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 50,\n\t\t\t\t\ttemplate:\n\t\t\t\t\t\t\"<span class='webix_fmanager_remove_tag webix_icon wxi-trash'></span>\",\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonBeforeEditStop: (values, editor) => {\n\t\t\t\t\tif (values.value !== values.old) {\n\t\t\t\t\t\tconst data = this.$$(\"tags\").getItem(editor.row);\n\t\t\t\t\t\tdata[editor.column] = values.value;\n\n\t\t\t\t\t\tthis.UpdateTag(editor.row, {\n\t\t\t\t\t\t\tname: data.name,\n\t\t\t\t\t\t\tcolor: data.color,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"data->onSyncApply\": () => {\n\t\t\t\t\t// workaround for refilter of slave after CRUD on master\n\t\t\t\t\tthis.FilterTags();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_fmanager_remove_tag: (e, id) => {\n\t\t\t\t\tthis.RemoveTag(id.row);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst body = {\n\t\t\tborderless: true,\n\t\t\tpadding: 12,\n\t\t\tmargin: 0,\n\t\t\ttype: \"clean\",\n\t\t\trows: [search, list],\n\t\t};\n\n\t\treturn body;\n\t}\n\tinit() {\n\t\tthis.List = this.$$(\"tags\");\n\t\tthis.Search = this.$$(\"search\");\n\t\tthis.SetTaglistOverlay();\n\t\tthis.app\n\t\t\t.getService(\"localtags\")\n\t\t\t.tags()\n\t\t\t.then(data => {\n\t\t\t\tthis.List.parse(data);\n\t\t\t\tthis.Search.focus();\n\t\t\t});\n\t}\n\n\tFilterTags() {\n\t\tthis._Input = this.Search.getValue()\n\t\t\t.trim()\n\t\t\t.toLowerCase();\n\t\tthis.List.filter(t => t.name.toLowerCase().indexOf(this._Input) !== -1);\n\t}\n\n\tAddTag() {\n\t\tconst tag = { name: \"New\", color: randomColor() };\n\t\tthis.app\n\t\t\t.getService(\"operations\")\n\t\t\t.addTag(tag)\n\t\t\t.then(id => {\n\t\t\t\tthis.Search.setValue(\"\");\n\t\t\t\tthis.List.editCell(id, \"name\", false, true);\n\t\t\t});\n\t}\n\n\tUpdateTag(id, data) {\n\t\tthis.app\n\t\t\t.getService(\"operations\")\n\t\t\t.updateTag(id, data)\n\t\t\t.then(() => {\n\t\t\t\tthis.List.blockEvent();\n\t\t\t\tthis.List.editStop();\n\t\t\t\tthis.List.unblockEvent();\n\t\t\t});\n\t}\n\n\tRemoveTag(id) {\n\t\tthis.app.getService(\"operations\").removeTag(id);\n\t}\n\n\tSetTaglistOverlay() {\n\t\twebix.extend(this.List, webix.OverlayBox);\n\n\t\tthis.on(this.List.data, \"onAfterFilter\", () => this.ToggleOverlay());\n\t\tthis.on(this.List.data, \"onStoreUpdated\", () => this.ToggleOverlay());\n\t}\n\n\tToggleOverlay() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (!this.List.count()) {\n\t\t\tthis.List.showOverlay(_(\"Click Add to create a new tag\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tTaglistTemplate(obj) {\n\t\treturn `<span class=\"webix_fmanager_tag_color\" style=\"background-color: ${obj.color};\">&nbsp;</span>`;\n\t}\n\n\tSearchTemplate(name) {\n\t\tif (this._Input) {\n\t\t\tconst rex = new RegExp(\"(\" + this._Input + \")\", \"gi\");\n\t\t\treturn name.replace(\n\t\t\t\trex,\n\t\t\t\t\"<span class='webix_fmanager_search_mark'>$1</span>\"\n\t\t\t);\n\t\t}\n\n\t\treturn name;\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class DoublePanel extends views[\"panel-double\"] {\n\tGetSource(mode) {\n\t\treturn mode === \"left\" ? this.State.source : \"files\";\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class PanelView extends views.panel {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tconst refreshIcon = ui.rows[0].cols[0];\n\t\trefreshIcon.click = () => {\n\t\t\tconst source = this.State.source !== \"files\" ? this.State.source : \"\";\n\t\t\tthis.app.getService(\"local\").refresh(this.State.path, source);\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tconst uapi = this.app.getService(\"upload\").getUploader();\n\t\tthis.on(uapi, \"onBeforeFileDrop\", (_files, e) => {\n\t\t\tif (\n\t\t\t\tthis.getRoot().$view.contains(e.target) &&\n\t\t\t\tthis.State.source !== \"files\"\n\t\t\t)\n\t\t\t\treturn false;\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"source\", v => this.ProcessSource(v));\n\t}\n\n\tProcessPath(v) {\n\t\tif (this.State.path !== \"/\") super.ProcessPath(v);\n\t}\n\n\tProcessSource(v) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.app\n\t\t\t.getService(\"local\")\n\t\t\t.folders()\n\t\t\t.then(dirs => {\n\t\t\t\tconst source = _(dirs.getItem(\"../\" + v).value);\n\t\t\t\tthis.$$(\"path\").setValues({ source });\n\t\t\t});\n\t}\n\n\tRenderPath(obj) {\n\t\tif (obj.path) return super.RenderPath(obj);\n\t\telse if (obj.source) return this.RenderSource(obj);\n\t\treturn \"\";\n\t}\n\n\tRenderSource(obj) {\n\t\treturn `<span class=\"webix_fmanager_path_chunk\" data-path=\"0\">${obj.source}</span>`;\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class CommentsView extends views.JetView {\n\tconfig() {\n\t\tconst backend = this.app.getService(\"users\");\n\t\treturn this.app\n\t\t\t.getService(\"localusers\")\n\t\t\t.users()\n\t\t\t.then(users => {\n\t\t\t\treturn {\n\t\t\t\t\tlocalId: \"comments\",\n\t\t\t\t\tview: \"comments\",\n\t\t\t\t\tcss: \"webix_fmanager_comments\",\n\t\t\t\t\tmentions: true,\n\t\t\t\t\tusers: users,\n\t\t\t\t\tcurrentUser: 1,\n\t\t\t\t\tscheme: {\n\t\t\t\t\t\t$init: this.PrepareComments,\n\t\t\t\t\t},\n\t\t\t\t\tlistItem: {\n\t\t\t\t\t\ttemplateAvatar: function(obj) {\n\t\t\t\t\t\t\tvar user = users.getItem(obj.user_id);\n\t\t\t\t\t\t\treturn `<div class=\"webix_comments_avatar\"><img class=\"webix_comments_avatar_image\" src=\"${backend.avatarUrl(\n\t\t\t\t\t\t\t\tuser.id,\n\t\t\t\t\t\t\t\tuser.avatar\n\t\t\t\t\t\t\t)}\" /></div>`;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t}\n\tinit() {\n\t\tthis.Comments = this.$$(\"comments\");\n\t\tthis.on(this.Comments, \"onBeforeAdd\", (_id, obj) => this.AddComment(obj));\n\t\tthis.on(\n\t\t\tthis.Comments.queryView(\"list\").data,\n\t\t\t\"onDataUpdate\",\n\t\t\t(id, obj, old) => this.UpdateComment(id, obj, old)\n\t\t);\n\t\tthis.on(this.Comments, \"onBeforeDelete\", id => this.RemoveComment(id));\n\n\t\twebix.extend(this.Comments.queryView(\"list\"), webix.OverlayBox);\n\t}\n\turlChange() {\n\t\tconst file = this.getParam(\"file\");\n\t\tthis.LoadComments(file);\n\t}\n\tLoadComments(v) {\n\t\tthis.File = v;\n\t\tthis.app\n\t\t\t.getService(\"users\")\n\t\t\t.comments(v.id)\n\t\t\t.then(data => {\n\t\t\t\tthis.Comments.clearAll();\n\t\t\t\tthis.Comments.parse(data);\n\t\t\t\tthis.ChangeListState();\n\t\t\t});\n\t}\n\tChangeListState() {\n\t\tif (this.Comments.count()) {\n\t\t\tthis.Comments.queryView(\"list\").hideOverlay();\n\t\t} else {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.Comments.queryView(\"list\").showOverlay(\n\t\t\t\t`<div class=\"webix_fmanager_overlay\">${_(\"No comments yet\")}</div>`\n\t\t\t);\n\t\t}\n\t}\n\tPrepareComments(o) {\n\t\tif (o && typeof o.date === \"string\") o.date = new Date(o.date);\n\t}\n\tAddComment(obj) {\n\t\tthis.app\n\t\t\t.getService(\"users\")\n\t\t\t.addComment(this.File.id, obj.text)\n\t\t\t.then(res => {\n\t\t\t\tobj.id = res.id * 1;\n\t\t\t\tthis.Silently(\"add\", [obj]);\n\t\t\t\tthis.ChangeListState();\n\t\t\t});\n\t\treturn false;\n\t}\n\tUpdateComment(id, obj, old) {\n\t\tthis.app\n\t\t\t.getService(\"users\")\n\t\t\t.updateComment(id, obj.text)\n\t\t\t.fail(() => {\n\t\t\t\tthis.Comments.getItem(id).text = old.text;\n\t\t\t\tthis.Comments.refresh(id);\n\t\t\t});\n\t}\n\tRemoveComment(id) {\n\t\tthis.app\n\t\t\t.getService(\"users\")\n\t\t\t.deleteComment(id)\n\t\t\t.then(res => {\n\t\t\t\tthis.Silently(\"remove\", [res.id]);\n\t\t\t\tthis.ChangeListState();\n\t\t\t});\n\t\treturn false;\n\t}\n\tSilently(operation, params) {\n\t\tconst comments = this.Comments;\n\t\tcomments.blockEvent();\n\t\tcomments[operation](...params);\n\t\tcomments.unblockEvent();\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class PreviewView extends views.preview {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst ui = super.config();\n\n\t\tconst toolbar = webix.copy(ui.rows[0]);\n\n\t\treturn {\n\t\t\trows: [\n\t\t\t\ttoolbar,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"tabview\",\n\t\t\t\t\tview: \"tabview\",\n\t\t\t\t\tcss: \"webix_fmanager_preview_tabs\",\n\t\t\t\t\tcells: [\n\t\t\t\t\t\t{ header: _(\"Preview\"), body: ui.rows[1] },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\theader: _(\"Comments\"),\n\t\t\t\t\t\t\tbody: { $subview: true, name: \"comments\" },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tShowInfo(v) {\n\t\tsuper.ShowInfo(v);\n\n\t\tconst tabbar = this.$$(\"tabview\").getTabbar();\n\t\tif (v.type === \"empty\") {\n\t\t\ttabbar.setValue(tabbar.config.options[0].id);\n\t\t\ttabbar.hide();\n\t\t} else {\n\t\t\ttabbar.show();\n\t\t\tthis.show(\"preview.comments\", {\n\t\t\t\ttarget: \"comments\",\n\t\t\t\tparams: { file: v },\n\t\t\t});\n\t\t}\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\nimport { randomColor } from \"../../helpers/common\";\n\nexport default class InfoPreview extends views[\"preview/info\"] {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst tags = {\n\t\t\tcss: \"webix_fmanager_tags_line\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tcss: \"webix_fmanager_info_title\",\n\t\t\t\t\tlabel: _(\"Tags\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"multicombo\",\n\t\t\t\t\t\t\tlocalId: \"tags:combo\",\n\t\t\t\t\t\t\tcss: \"preview_tags\",\n\t\t\t\t\t\t\tplaceholder: _(\"Add a tag\"),\n\t\t\t\t\t\t\tnewValues: true,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\ttemplate: \"#name#\",\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\tdata: [],\n\t\t\t\t\t\t\t\t\ttemplate: obj => this.TaglistTemplate(obj),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonItemClick: (_id, e) => this.SearchTag(e.target),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_fmanager_tags_plus\",\n\t\t\t\t\t\t\t\t\t\t\ttooltip: _(\"Add a tag\"),\n\t\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst tags = this.$$(\"tags:combo\");\n\t\t\t\t\t\t\t\t\t\t\t\ttags.getInputNode().click();\n\t\t\t\t\t\t\t\t\t\t\t\ttags.getList().show(tags.$view);\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\t\t\ticon: \"dmi-cog\",\n\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_fmanager_tag_settings\",\n\t\t\t\t\t\t\t\t\t\t\ttooltip: _(\"Open tag settings\"),\n\t\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"app:action\", [\"tags\"]);\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst ui = super.config();\n\t\tconst info = ui.cells[0].body;\n\t\tinfo.css = \"webix_fmanager_info\";\n\t\tinfo.rows.splice(0, 0, tags);\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\n\t\tconst tags = this.$$(\"tags:combo\");\n\t\tthis.HandleTagUpdate(tags);\n\t\tthis.HandleColoring(tags);\n\t\tthis.HandleTagCreation(tags);\n\n\t\tthis.on(this.app, \"current:tags:updated\", () => this.ReloadTags());\n\t}\n\tShowInfo(v) {\n\t\tsuper.ShowInfo(v);\n\n\t\tif (v.type !== \"empty\") {\n\t\t\tthis.File = v;\n\t\t\tconst tags = this.$$(\"tags:combo\");\n\t\t\tconst all = this.app.getService(\"localtags\").tags();\n\t\t\tconst ftags = this.app.getService(\"tags\").getTags(v.id);\n\t\t\twebix.promise.all([all, ftags]).then(result => {\n\t\t\t\ttags.getList().parse(result[0]);\n\t\t\t\tthis.SetTagsSilent(tags, result[1]);\n\t\t\t});\n\t\t}\n\t}\n\tHandleTagUpdate(mc) {\n\t\tthis.on(mc, \"onChange\", (nt, ot) => {\n\t\t\tif (this.File) {\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"tags\")\n\t\t\t\t\t.setTags(this.File.id, nt.join())\n\t\t\t\t\t.fail(() => {\n\t\t\t\t\t\tthis.SetTagsSilent(mc, ot);\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\tSetTagsSilent(tags, value) {\n\t\ttags.blockEvent();\n\t\ttags.setValue(value);\n\t\ttags.unblockEvent();\n\t}\n\n\tHandleColoring(tags) {\n\t\tconst smallSkin =\n\t\t\twebix.skin.$name === \"mini\" || webix.skin.$name === \"compact\";\n\t\tconst material =\n\t\t\twebix.skin.$name === \"material\" || webix.skin.$name === \"mini\";\n\n\t\ttags.$renderTag = function(text, height, value) {\n\t\t\tconst data = this.getList().getItem(value);\n\n\t\t\tconst content = `<span>${text}</span><span class='webix_multicombo_delete' role='button' aria-label='${\n\t\t\t\twebix.i18n.aria.removeItem\n\t\t\t}'>${material ? \"&nbsp;&nbsp;\" : \"x\"}</span>`;\n\t\t\treturn `<li class='webix_multicombo_value' style='line-height: ${height +\n\t\t\t\t(smallSkin ? 2 : 0)}px; background-color: ${\n\t\t\t\tdata.color\n\t\t\t};' optvalue='${webix.template.escape(value)}'>${content}</li>`;\n\t\t};\n\t}\n\n\tReloadTags() {\n\t\tthis.app\n\t\t\t.getService(\"tags\")\n\t\t\t.getTags(this.File.id)\n\t\t\t.then(res => {\n\t\t\t\tthis.SetTagsSilent(this.$$(\"tags:combo\"), res);\n\t\t\t});\n\t}\n\n\tSearchTag(target) {\n\t\tconst tags = this.$$(\"tags:combo\");\n\t\ttags.getPopup().hide();\n\n\t\tconst node =\n\t\t\ttarget.className === \"webix_multicombo_value\"\n\t\t\t\t? target\n\t\t\t\t: target.parentNode.className === \"webix_multicombo_value\"\n\t\t\t\t? target.parentNode\n\t\t\t\t: null;\n\t\tif (!node) return;\n\n\t\tconst value = node.getAttribute(\"optvalue\");\n\t\tthis.getParam(\"state\").search = \"#\" + tags.getList().getItem(value).value;\n\t}\n\n\tSwitchTabs(tab, hide, show) {\n\t\tthis.State.search && !this.State.selectedItem.length\n\t\t\t? tab.show()\n\t\t\t: tab.hide();\n\t\tsuper.SwitchTabs(tab, hide, show);\n\t}\n\n\tHandleTagCreation(mc) {\n\t\tconst popupList = mc.getList();\n\t\tthis.on(popupList, \"onBeforeAdd\", (id, data) => {\n\t\t\tconst old = mc.getValue();\n\t\t\tthis.AddTag({ name: data.value, tags: old });\n\t\t\treturn false;\n\t\t});\n\n\t\tthis.SetTaglistOverlay(popupList);\n\t}\n\n\tAddTag(data) {\n\t\tconst tag = { name: data.name, color: randomColor() };\n\t\tthis.app\n\t\t\t.getService(\"operations\")\n\t\t\t.addTag(tag, data.tags)\n\t\t\t.then(() => {\n\t\t\t\tthis.ReloadTags();\n\t\t\t});\n\t}\n\n\tSetTaglistOverlay(list) {\n\t\twebix.extend(list, webix.OverlayBox);\n\n\t\tthis.on(list.data, \"onAfterFilter\", () => this.ToggleOverlay(list));\n\t\tthis.on(list.getTopParentView(), \"onShow\", () => this.ToggleOverlay(list));\n\t}\n\n\tToggleOverlay(list) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (!list.count()) {\n\t\t\tlist.define({\n\t\t\t\tyCount: 1,\n\t\t\t\tautoheight: false,\n\t\t\t});\n\n\t\t\tlist.showOverlay(_(\"Press Enter to create a new tag\"));\n\t\t} else {\n\t\t\tlist.define({ autoheight: true, yCount: 5 });\n\t\t\tlist.hideOverlay();\n\t\t}\n\t\tlist.resize();\n\t}\n\n\tTaglistTemplate(obj) {\n\t\tconst lih = webix.skin.$active.listItemHeight;\n\t\tconst color = `<span class=\"webix_fmanager_tag_marker\" style=\"background-color:${\n\t\t\tobj.color\n\t\t}; height:${lih - 12}px; width:${lih - 12}px; margin-top:${lih /\n\t\t\t10}px;\">&nbsp;</span>`;\n\t\treturn obj.name + color;\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class TopView extends views.top {\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.on(this.app, \"app:action\", (name, info) => {\n\t\t\tif (name === \"share\") {\n\t\t\t\tthis.show(\"./menus.popup/menus.sharepopup\", {\n\t\t\t\t\ttarget: \"popup\",\n\t\t\t\t\tparams: { info, compact: this.Compact, label: \"Share File\" },\n\t\t\t\t});\n\t\t\t} else if (name === \"tags\") {\n\t\t\t\tthis.show(\"./menus.popup/menus.tagspopup\", {\n\t\t\t\t\ttarget: \"popup\",\n\t\t\t\t\tparams: { compact: this.Compact, label: \"Manage Tags\" },\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n","import { views } from \"@xbs/filemanager\";\n\nexport default class TopBarView extends views.topbar {\n\tconfig() {\n\t\tconst bar = super.config();\n\t\tconst skin = webix.skin.$active;\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst preview = bar.cols.find(c => c.localId === \"previewMode\");\n\t\tpreview.icon = \"dmi-gesture-double-tap\";\n\n\t\tbar.cols.splice(5, 0, {\n\t\t\tlocalId: \"emptyTrash\",\n\t\t\tcss: \"webix_fmanager_empty_trash\",\n\t\t\tview: \"button\",\n\t\t\ttype: \"icon\",\n\t\t\ticon: \"dmi-delete-empty\",\n\t\t\ttooltip: _(\"Empty trash\"),\n\t\t\twidth: skin.toolbarHeight < 37 ? 48 : 60,\n\t\t\thidden: true,\n\t\t\tclick: () => this.app.callEvent(\"app:action\", [\"remove\", \"all\"]),\n\t\t});\n\n\t\treturn bar;\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tconst common = this.getParam(\"state\");\n\t\tthis.on(common.$changes, \"source\", (v, o) => {\n\t\t\tif (v === \"trash\") {\n\t\t\t\tthis.$$(\"emptyTrash\").show();\n\t\t\t\tthis.$$(\"previewMode\").hide();\n\t\t\t} else if (o === \"trash\") {\n\t\t\t\tthis.$$(\"emptyTrash\").hide();\n\t\t\t\tif (!this.getParam(\"compact\")) this.$$(\"previewMode\").show();\n\t\t\t}\n\t\t});\n\t}\n}\n","import m0 from \"views/cards\";\nimport m1 from \"views/editor\";\nimport m2 from \"views/excel\";\nimport m3 from \"views/folders\";\nimport m4 from \"views/history\";\nimport m5 from \"views/list\";\nimport m6 from \"views/menus/menubody\";\nimport m7 from \"views/menus/popup\";\nimport m8 from \"views/menus/sharepopup\";\nimport m9 from \"views/menus/tagspopup\";\nimport m10 from \"views/panel-double\";\nimport m11 from \"views/panel\";\nimport m12 from \"views/preview/comments\";\nimport m13 from \"views/preview/index.js\";\nimport m14 from \"views/preview/info\";\nimport m15 from \"views/top\";\nimport m16 from \"views/topbar\";\n\nconst views = {};\nviews[\"cards\"] = m0;\nviews[\"editor\"] = m1;\nviews[\"excel\"] = m2;\nviews[\"folders\"] = m3;\nviews[\"history\"] = m4;\nviews[\"list\"] = m5;\nviews[\"menus/menubody\"] = m6;\nviews[\"menus/popup\"] = m7;\nviews[\"menus/sharepopup\"] = m8;\nviews[\"menus/tagspopup\"] = m9;\nviews[\"panel-double\"] = m10;\nviews[\"panel\"] = m11;\nviews[\"preview/comments\"] = m12;\nviews[\"preview\"] = m13;\nviews[\"preview/info\"] = m14;\nviews[\"top\"] = m15;\nviews[\"topbar\"] = m16;\n\nexport default views;\n","import { services } from \"@xbs/filemanager\";\n\nexport default class Backend extends services.Backend {\n\tfiles(id, source) {\n\t\tif (!source) return super.files(id);\n\t\telse {\n\t\t\treturn this._files(this.url(\"files\"), { id, source });\n\t\t}\n\t}\n\tremovePermanent(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(`delete?id=${encodeURIComponent(id)}`))\n\t\t\t.then(r => r.json());\n\t}\n\trestore(id, target) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"delete\"), {\n\t\t\t\tid,\n\t\t\t\ttarget,\n\t\t\t})\n\t\t\t.then(r => r.json());\n\t}\n\tfavour(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"favorite\"), {\n\t\t\t\tid,\n\t\t\t})\n\t\t\t.then(r => r.json());\n\t}\n\tunfavour(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(`favorite?id=${encodeURIComponent(id)}`))\n\t\t\t.then(r => r.json());\n\t}\n\twriteBinary(id, filename, upload) {\n\t\tconst fd = new FormData();\n\t\tfd.append(\"upload\", upload, filename);\n\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(`direct?id=${encodeURIComponent(id)}`), fd)\n\t\t\t.then(r => r.json());\n\t}\n}\n","import { services } from \"@xbs/filemanager\";\n\nexport default class LocalData extends services.LocalData {\n\tfiles(path, sync, source) {\n\t\tif (!source) return super.files(path, sync);\n\t\telse {\n\t\t\tlet fs = this.fscache.get(source);\n\t\t\tif (sync) return fs;\n\t\t\tif (fs) return Promise.resolve(fs);\n\n\t\t\tfs = new webix.DataCollection({\n\t\t\t\tscheme: {\n\t\t\t\t\t$change: this.prepareData,\n\t\t\t\t\t$serialize: this.serializeData,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.fscache.set(source, fs);\n\t\t\treturn this.reload(fs, path, source);\n\t\t}\n\t}\n\trefresh(path, source) {\n\t\tconst fs = this.fscache.get(source || path);\n\t\tif (fs) return this.reload(fs, path, source);\n\t}\n\treload(fs, path, source) {\n\t\tif (!source) return super.reload(fs, path);\n\t\telse {\n\t\t\treturn this.app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.files(path, source)\n\t\t\t\t.then(data => {\n\t\t\t\t\tfs.clearAll();\n\t\t\t\t\tfs.parse(this.backToFiles().concat(data));\n\t\t\t\t\treturn fs;\n\t\t\t\t});\n\t\t}\n\t}\n\tbackToFiles() {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttype: \"folder\",\n\t\t\t\tid: \"/\",\n\t\t\t\tvalue: \"..\",\n\t\t\t\t$row: (_obj, common) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tcommon.backIcon() +\n\t\t\t\t\t\t`<span class='webix_fmanager_back'>${common.backToFiles()}</span>`\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\n\tdefaultTree() {\n\t\treturn [\n\t\t\t{ value: \"My Files\", id: \"../files\", open: true },\n\t\t\t{\n\t\t\t\tvalue: \"Favorite\",\n\t\t\t\t$css: { \"margin-top\": \"20px\" },\n\t\t\t\tid: \"../favorite\",\n\t\t\t\ticon: \"dmi-star\",\n\t\t\t},\n\t\t\t{ value: \"Recent\", id: \"../recent\", icon: \"dmi-history\" },\n\t\t\t{ value: \"Shared\", id: \"../shared\", icon: \"dmi-share-all\" },\n\t\t\t{\n\t\t\t\tvalue: \"Trash\",\n\t\t\t\t$css: { \"margin-top\": \"20px\" },\n\t\t\t\tid: \"../trash\",\n\t\t\t\ticon: \"wxi-trash\",\n\t\t\t},\n\t\t];\n\t}\n\n\taddFile(id, item) {\n\t\tif (!this.hierarchy.exists(id)) id = \"/\";\n\t\tsuper.addFile(id, item);\n\t}\n}\n","import { services } from \"@xbs/filemanager\";\n\nexport default class Operations extends services.Operations {\n\tinitEvents() {\n\t\tsuper.initEvents();\n\n\t\tthis.app.attachEvent(\"app:action\", (name, info, target) => {\n\t\t\tswitch (name) {\n\t\t\t\tcase \"trashed\":\n\t\t\t\t\tthis.addToClipboard(name);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"restore\":\n\t\t\t\t\tthis.restore(info, target);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"remove\":\n\t\t\t\t\tthis.removePermanent(info);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"favorite\":\n\t\t\t\tcase \"unfavorite\":\n\t\t\t\t\tthis.favour(info);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\tremove(files) {\n\t\tif (files || this.state.selectedItem.length)\n\t\t\tsuper.remove(files).then(() => {\n\t\t\t\tthis.local().refresh(\"/\", \"trash\");\n\t\t\t});\n\t}\n\trestore(files, target) {\n\t\tconst state = this.state;\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (!files) files = state.selectedItem;\n\t\tif (!files.length) return;\n\n\t\tfiles = this.extractIds(files);\n\n\t\tthis.app.getService(\"progress\").files(_(\"Restoring...\"), files, f => {\n\t\t\treturn this.backend()\n\t\t\t\t.restore(f, target)\n\t\t\t\t.then(res => {\n\t\t\t\t\tconst local = this.local();\n\t\t\t\t\tlocal.deleteFile(f);\n\t\t\t\t\tlocal.addFile(this.dir(res.id), res);\n\t\t\t\t});\n\t\t});\n\t}\n\tremovePermanent(files) {\n\t\tconst state = this.state;\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tif (files === \"all\") {\n\t\t\tfiles = this.local()\n\t\t\t\t.files(\"/\", true, \"trash\")\n\t\t\t\t.serialize();\n\t\t} else {\n\t\t\tif (!files) files = state.selectedItem;\n\t\t}\n\t\tif (!files.length) return;\n\n\t\tfiles = this.extractIds(files);\n\n\t\treturn webix.confirm(_(\"Are you sure ?\")).then(() => {\n\t\t\tthis.app.getService(\"progress\").files(_(\"Deleting...\"), files, f => {\n\t\t\t\treturn this.backend()\n\t\t\t\t\t.removePermanent(f)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tif (!res.invalid) {\n\t\t\t\t\t\t\tthis.local().deleteFile(f);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\taddToClipboard(mode) {\n\t\tif (this.state.source === \"files\" || this.state.source === \"trash\")\n\t\t\tsuper.addToClipboard(mode);\n\t}\n\tpaste() {\n\t\tconst state = this.state;\n\t\tif (!state.clipboard) return;\n\n\t\tif (state.source === \"files\") {\n\t\t\tif (state.clipboard.mode === \"trashed\")\n\t\t\t\tthis.restore(state.clipboard.files, state.path);\n\t\t\telse super.paste();\n\t\t} else if (state.source === \"trash\" && state.clipboard.mode === \"cut\") {\n\t\t\tthis.remove(state.clipboard.files);\n\t\t}\n\t}\n\n\tfavour(files) {\n\t\tconst file = files[0];\n\t\tconst star = !file.star;\n\t\tconst backend = this.backend();\n\t\tconst method = star ? backend.favour : backend.unfavour;\n\t\tmethod.call(backend, file.id).then(res => {\n\t\t\tif (!res.invalid) {\n\t\t\t\tthis.local().updateFile(res.id, { star });\n\t\t\t\tthis.local().refresh(\"/\", \"favorite\");\n\t\t\t}\n\t\t});\n\t}\n\n\tdir(path) {\n\t\treturn path.slice(0, path.lastIndexOf(\"/\")) || \"/\";\n\t}\n\n\tedit(f) {\n\t\tconst state = this.state;\n\t\tif (!f) f = state.selectedItem;\n\t\tconst file = f[0];\n\n\t\tlet path;\n\n\t\tif (f.length) {\n\t\t\tif (file.$ext === \"xls\" || file.$ext === \"xlsx\") {\n\t\t\t\tpath = \"/excel\";\n\t\t\t} else if (file.type === \"code\") {\n\t\t\t\tpath = \"/editor\";\n\t\t\t}\n\n\t\t\tif (path) {\n\t\t\t\tthis.app.show(path, {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tfile,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\twriteBinary(id, filename, file) {\n\t\treturn this.backend()\n\t\t\t.writeBinary(id, filename, file)\n\t\t\t.then(data => {\n\t\t\t\treturn this.local().updateFile(id, {\n\t\t\t\t\tsize: data.size,\n\t\t\t\t\tdate: data.date,\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tusers() {\n\t\treturn this.app.getService(\"users\");\n\t}\n\n\tshare(file, uid) {\n\t\treturn this.users()\n\t\t\t.share(file.id, uid)\n\t\t\t.then(res => {\n\t\t\t\treturn this.local().updateFile(res.id, {\n\t\t\t\t\tusers: (file.users || []).concat(uid),\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tremoveUser(file, uid) {\n\t\treturn this.users()\n\t\t\t.removeUser(file.id, uid)\n\t\t\t.then(res => {\n\t\t\t\treturn this.local().updateFile(res.id, {\n\t\t\t\t\tusers: file.users.filter(u => u !== uid),\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\ttags() {\n\t\treturn this.app.getService(\"tags\");\n\t}\n\tlocaltags() {\n\t\treturn this.app.getService(\"localtags\");\n\t}\n\taddTag(data, tags) {\n\t\treturn this.tags()\n\t\t\t.addTag(data)\n\t\t\t.then(res => {\n\t\t\t\tif (tags !== undefined) {\n\t\t\t\t\tconst files = this.state.selectedItem;\n\t\t\t\t\tconst file = files[files.length - 1];\n\t\t\t\t\tthis.tags()\n\t\t\t\t\t\t.setTags(file.id, tags + \",\" + res.id)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.app.callEvent(\"current:tags:updated\");\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this.localtags().addTag(res);\n\t\t\t});\n\t}\n\tupdateTag(id, data) {\n\t\treturn this.tags()\n\t\t\t.updateTag(id, data)\n\t\t\t.then(res => {\n\t\t\t\tthis.app.callEvent(\"current:tags:updated\");\n\t\t\t\tthis.localtags().updateTag(id, res);\n\t\t\t});\n\t}\n\tremoveTag(id) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix.confirm(_(\"Are you sure ?\")).then(() => {\n\t\t\tthis.tags()\n\t\t\t\t.removeTag(id)\n\t\t\t\t.then(res => {\n\t\t\t\t\tthis.app.callEvent(\"current:tags:updated\");\n\t\t\t\t\tthis.localtags().removeTag(res.id);\n\t\t\t\t});\n\t\t});\n\t}\n}\n","export default class Users {\n\tconstructor(_app, url) {\n\t\tthis._url = url;\n\t}\n\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\n\tusers() {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(\"users/all\"))\n\t\t\t.then(r => r.json());\n\t}\n\tavatarUrl(id, name) {\n\t\treturn this.url(`${name.slice(1)}`);\n\t}\n\tshare(id, user) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"share\"), {\n\t\t\t\tid,\n\t\t\t\tuser,\n\t\t\t})\n\t\t\t.then(r => r.json());\n\t}\n\tremoveUser(id, user) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(`share?id=${encodeURIComponent(id)}&user=${user}`))\n\t\t\t.then(r => r.json());\n\t}\n\tcomments(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(`comments?id=${encodeURIComponent(id)}`))\n\t\t\t.then(res => res.json());\n\t}\n\taddComment(id, value) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(`comments?id=${encodeURIComponent(id)}`), {\n\t\t\t\tvalue,\n\t\t\t})\n\t\t\t.then(res => res.json());\n\t}\n\tupdateComment(id, value) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(`comments/${id}`), {\n\t\t\t\tvalue,\n\t\t\t})\n\t\t\t.then(res => res.json());\n\t}\n\tdeleteComment(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(`comments/${id}`))\n\t\t\t.then(res => res.json());\n\t}\n}\n","export default class LocalUsers {\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.userlist = new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: o => {\n\t\t\t\t\to.value = o.name;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tthis.users_ready = null;\n\t}\n\tusers(force) {\n\t\tconst users = this.userlist;\n\n\t\tif (force || !this.users_ready) {\n\t\t\tthis.users_ready = this.app\n\t\t\t\t.getService(\"users\")\n\t\t\t\t.users()\n\t\t\t\t.then(data => {\n\t\t\t\t\tusers.clearAll();\n\t\t\t\t\tusers.parse(data);\n\n\t\t\t\t\treturn users;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.users_ready;\n\t}\n}\n","export default class Tags {\n\tconstructor(_app, url) {\n\t\tthis._url = url;\n\t}\n\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\ttags() {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(\"tags/all\"))\n\t\t\t.then(r => r.json());\n\t}\n\tgetTags(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(`tags?id=${encodeURIComponent(id)}`))\n\t\t\t.then(r => r.json());\n\t}\n\tsetTags(id, value) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tags\"), {\n\t\t\t\tid,\n\t\t\t\tvalue,\n\t\t\t})\n\t\t\t.then(r => r.json());\n\t}\n\taddTag(data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"tags\"), data)\n\t\t\t.then(res => res.json());\n\t}\n\tupdateTag(id, data) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(`tags/${id}`), data)\n\t\t\t.then(res => res.json());\n\t}\n\tremoveTag(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(`tags/${id}`))\n\t\t\t.then(res => res.json());\n\t}\n}\n","export default class LocalTags {\n\tconstructor(app) {\n\t\tthis.app = app;\n\n\t\tthis.taglist = new webix.DataCollection({});\n\t\tthis.tags_ready = null;\n\t}\n\ttags(force) {\n\t\tconst tags = this.taglist;\n\n\t\tif (force || !this.tags_ready) {\n\t\t\tthis.tags_ready = this.app\n\t\t\t\t.getService(\"tags\")\n\t\t\t\t.tags()\n\t\t\t\t.then(data => {\n\t\t\t\t\ttags.clearAll();\n\t\t\t\t\ttags.parse(data);\n\n\t\t\t\t\treturn tags;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.tags_ready;\n\t}\n\taddTag(data) {\n\t\treturn this.taglist.add(data);\n\t}\n\tupdateTag(id, data) {\n\t\tif (this.taglist.exists(id)) this.taglist.updateItem(id, data);\n\t}\n\tremoveTag(id) {\n\t\tif (this.taglist.exists(id)) this.taglist.remove(id);\n\t}\n}\n","export default class Versions {\n\tconstructor(_app, url) {\n\t\tthis._url = url;\n\t}\n\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\n\tversions(id) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(\"versions\"), { id })\n\t\t\t.then(r => r.json());\n\t}\n\n\treadText(id, diff) {\n\t\tconst params = { mode: \"text\" };\n\t\tif (diff) params.diff = true;\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.get(this.url(`versions/${id}`), params)\n\t\t\t.then(r => r.text());\n\t}\n\n\trestore(id, version) {\n\t\treturn webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"versions\"), { id, version })\n\t\t\t.then(r => r.json());\n\t}\n\n\tdirectLink(id) {\n\t\treturn this.url(`versions/${id}?mode=binary`);\n\t}\n}\n","import * as fm from \"@xbs/filemanager\";\nimport { link } from \"jet-restate\";\n\nimport views from \"./export_views\";\nimport en from \"locales/en\";\n\nimport Backend from \"./models/Backend\";\nimport LocalData from \"./models/LocalData\";\nimport Operations from \"./models/Operations\";\nimport Users from \"./models/Users\";\nimport LocalUsers from \"./models/LocalUsers\";\nimport Tags from \"./models/Tags\";\nimport LocalTags from \"./models/LocalTags\";\nimport Versions from \"./models/Versions\";\n\nexport class App extends fm.App {\n\tconstructor(config) {\n\t\tconst defaults = {\n\t\t\tversion: VERSION,\n\t\t};\n\n\t\tconst override = new Map([\n\t\t\t[fm.views[\"top\"], views[\"top\"]],\n\t\t\t[fm.views[\"cards\"], views[\"cards\"]],\n\t\t\t[fm.views[\"editor\"], views[\"editor\"]],\n\t\t\t[fm.views[\"folders\"], views[\"folders\"]],\n\t\t\t[fm.views[\"list\"], views[\"list\"]],\n\t\t\t[fm.views[\"menus/menubody\"], views[\"menus/menubody\"]],\n\t\t\t[fm.views[\"panel\"], views[\"panel\"]],\n\t\t\t[fm.views[\"panel-double\"], views[\"panel-double\"]],\n\t\t\t[fm.views[\"preview/info\"], views[\"preview/info\"]],\n\t\t\t[fm.views[\"preview\"], views[\"preview\"]],\n\t\t\t[fm.views[\"topbar\"], views[\"topbar\"]],\n\t\t\t[fm.services.Backend, services.Backend],\n\t\t\t[fm.services.LocalData, services.LocalData],\n\t\t\t[fm.services.Operations, services.Operations],\n\t\t]);\n\n\t\tif (config.override) config.override.forEach((v, k) => override.set(k, v));\n\n\t\tsuper({ ...defaults, ...config, override });\n\n\t\tthis.setService(\"users\", new (this.dynamic(Users))(this, this.config.url));\n\t\tthis.setService(\"localusers\", new (this.dynamic(LocalUsers))(this));\n\t\tthis.setService(\"tags\", new (this.dynamic(Tags))(this, this.config.url));\n\t\tthis.setService(\"localtags\", new (this.dynamic(LocalTags))(this));\n\t\tthis.setService(\n\t\t\t\"versions\",\n\t\t\tnew (this.dynamic(Versions))(this, this.config.url)\n\t\t);\n\t}\n\trequire(type, name) {\n\t\tif (type === \"jet-views\") return views[name];\n\t\telse if (type === \"jet-locales\") return locales[name];\n\n\t\treturn null;\n\t}\n\tdynamic(obj) {\n\t\tconst override = this.config.override;\n\t\tif (override) {\n\t\t\tlet s;\n\t\t\twhile (obj) {\n\t\t\t\ts = obj;\n\t\t\t\tobj = override.get(obj);\n\t\t\t}\n\t\t\treturn s;\n\t\t}\n\t\treturn obj;\n\t}\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"docmanager\",\n\t\tapp: App,\n\t\tgetState() {\n\t\t\treturn this.$app.getState();\n\t\t},\n\t\tgetService(name) {\n\t\t\treturn this.$app.getService(name);\n\t\t},\n\t\t$init() {\n\t\t\tconst state = this.$app.getState();\n\t\t\tfor (let key in state) {\n\t\t\t\tlink(state, this.config, key);\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.jetapp\n);\n\n// re-export for customization\nwebix.extend(views, fm.views);\nconst services = {\n\tLocalData,\n\tBackend,\n\tOperations,\n\tUsers,\n\tLocalUsers,\n\tTags,\n\tLocalTags,\n\tVersions,\n\tProgress: fm.services.Progress,\n\tUpload: fm.services.Upload,\n};\nconst locales = { en: webix.extend(en, fm.locales.en) };\n\nexport { views, locales, services };\n","export default {\n\tFavorite: \"Favorite\",\n\tRecent: \"Recent\",\n\tShared: \"Shared\",\n\tTrash: \"Trash\",\n\t\"Add to favorites\": \"Add to favorites\",\n\t\"Remove from favorites\": \"Remove from favorites\",\n\tShare: \"Share\",\n\tTags: \"Tags\",\n\tComments: \"Comments\",\n\t\"Can view\": \"Can view\",\n\t\"Can edit\": \"Can edit\",\n\t\"Share File\": \"Share File\",\n\t\"Invite someone...\": \"Invite someone...\",\n\tInvite: \"Invite\",\n\tRestore: \"Restore\",\n\t\"Delete from trash\": \"Delete from trash\",\n\t\"Restoring...\": \"Restoring...\",\n\t\"Empty trash\": \"Empty trash\",\n\t\"back to \": \"back to \",\n\t\"Select a user\": \"Select a user\",\n\t\"Add a tag\": \"Add a tag\",\n\t\"No comments yet\": \"No comments yet\",\n\t\"No users\": \"No users\",\n\t\"Available to\": \"Available to\",\n\t\"user(s)\": \"user(s)\",\n\t\"Manage Tags\": \"Manage Tags\",\n\t\"Press Enter to create a new tag\": \"Press Enter to create a new tag\",\n\t\"Click Add to create a new tag\": \"Click Add to create a new tag\",\n\t\"Open tag settings\": \"Open tag settings\",\n\t\"Type to search a tag\": \"Type to search a tag\",\n\t\"Show version history\": \"Show version history\",\n\t\"Unsaved changes will be lost. Are you sure?\":\n\t\t\"Unsaved changes will be lost. Are you sure?\",\n\t\"Last edited at\": \"Last edited at\",\n\t\"Last edited on\": \"Last edited on\",\n\t\"Back to editor\": \"Back to editor\",\n\t\"Version history\": \"Version history\",\n\t\"Show changes\": \"Show changes\",\n\t\"Restored from\": \"Restored from\",\n};\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","exports","NavigationBlocked","JetBase","webix","config","webixJet","_events","_subs","_data","params","extend","getRoot","_root","destructor","_detachEvents","_destroySubs","_container","app","_parent","setParam","id","value","url","_segment","update","show","getParam","parent","view","getParentView","getUrl","suburl","getUrlString","toString","$$","root_1","queryView","obj","localId","$scope","on","name","code","attachEvent","push","contains","key","kid","getSubView","sub","getSubViewInfo","subview","popup","events","detachEvent","subView","_init_url_data","current","_getDefaultSub","default","branch","child","_routed_view","parse","substr","parts","split","chunks","test","result","pos","indexOf","_i","params_1","dchunk","decodeURIComponent","page","isNew","url2str","stack","stack_1","chunk","obj2str","join","str","encodeURIComponent","Route","route","index","_next","path","next","slice","shift","setParams","old","refresh","_join","kids","reset","concat","append","_this","Promise","res","rej","redirect","confirm","resolve","callEvent","catch","err","then","size","JetView","_super","_children","ui","container","jetview","createView","render","parent_1","target","_renderFrameLock","_show","segment","_urlChange","linkRouter","getRouter","set","silent","init","_$view","_$","ready","_$url","message","urlChange","destroy","_destroyKids","use","plugin","tagName","_render","root","document","body","toNode","cfg","_render_final","response","slot","reject","copyConfig","oldui","parent_2","asWin","setPosition","isVisible","_init","_initUrl","e","_initError","waits","frame","wait","all","lock","_renderFrame","_createSubView","_override","error","createFromURL","uis","JetViewRaw","_ui","SubRouter","cb","a","get","_once","JetAppBase","window","version","start","_services","EventSystem","_subSegment","getService","setService","handler","$subview","addSubView","isArray","method","point","DataCollection","RegExp","Map","Date","copy","$router","clickHandler","srcElement","getAttribute","trigger_1","_forView","trigger","cancelBubble","preventDefault","route_1","parentNode","loadView","views","_loadError","Error","hidden","replace","require","module","__esModule","_loadViewDynamic","over","override","dv","router","rest","data","action","bind","er","debug","console","text","innerHTML","type","expire","event","_first_start","top","base","setTimeout","animation","node_1","html","addCss","removeCss","now","urlString","template","uid","HashRouter","_detectPrefix","onpopstate","routes","compare","history","pushState","prefix","sufix","_getRaw","routerPrefix","location","href","isPatched","patch","w","win","promise","freeze","some","$freeze","resize","baseAdd","baselayout","addView","baseRemove","removeView","jview_1","subs_1","_loop_1","subs","layout","protoUI","$init","$app","$ready","proxy","JetApp","EmptyRouter","UrlRouter","pathname","search","_$config","has","store","forEach","context","warn","x","String","russianPluralGroups","end","pluralTypes","arabic","lastTwo","bosnian_serbian","chinese","croatian","french","german","russian","lithuanian","czech","polish","icelandic","slovenian","pluralTypeToLanguages","pluralTypeName","locale","ret","langToPluralType","langs","lang","en","escape","token","dollarRegex","defaultTokenRegex","transformPhrase","phrase","substitutions","tokenRegex","TypeError","interpolationRegex","options","smart_count","texts","count","pluralTypeIndex","expression","argument","Polyglot","opts","phrases","currentLocale","allowMissing","onMissingKey","suffix","RangeError","constructTokenRegex","interpolation","newLocale","morePhrases","prefixedKey","unset","clear","newPhrases","_","webixPolyglot","webix$1","plugins","_view","storage","setLangData","pconfig","polyglot","poly","service","put","locName","i18n","setLocale","setLang","getLang","link","source","defineProperty","createState","handlers","out","observe","mask","undefined","queue","waitInQueue","notify","meta","list","keys","key2","nested","reactive","enumerable","configurable","values_1","val","valueOf","UIManager","addHotKey","_a","removeHotKey","folderIcon","menuIcon","MenuBodyView","compact","tree","icon","hotkey","$template","FULL","FOLDER","editor","splice","css","autoheight","onMenuItemClick","Files","FilterOptions","files","file","many","viewable","find","$ext","getState","define","filter","o","ContextMenuView","_config","dynamic","onBeforeShow","_Locate","hide","AttachTo","master","locate","attachTo","Show","trg","offsetX","y","offsetHeight","offsetY","DataViewBase","State","_Track","WTable","ShiftFocus","newIDs","getSelectedId","map","getItem","selectedItem","$noSelect","$changes","v","$batch","searchStats","folders","hierarchy","GetPrevLocation","LoadData","m","SelectActive","AddHotkeys","Menu","state","item","isSelected","select","sel","isActive","Activate","ShowSubFolder","h","exists","getParentId","date","GetTargetFolder","targetItem","table","getFirstId","delay","setFocus","GetSelection","clearAll","GetSearchStats","RenderData","MoveFiles","move","Icon","DragMarker","ctx","f","parentInd","firstDragged","multiple","ctrlKey","env","isMac","operations","oper","this_1","preventEvent","selectAll","EmptyClick","unselectAll","CardsView","smallSkin","skin","$name","drag","multiselect","CardTemplate","height","width","padding","onItemDblClick","onEnter","onBeforeDrag","onBeforeDrop","onClick","webix_fmanager_menu_icon","webix_dataview","onContext","sync","preview","panel","SearchTemplate","picSize","$active","listItemHeight","origin_1","previewURL","rex","defaults","mode","lineNumbers","matchBrackets","theme","$view","_textarea","firstChild","_waitEditor","defer","_render_cm_editor","complex_types","php","htmlembedded","addon","htmlmixed","dockerfile","cdn","sources","extras","_render_when_ready","log","_editor","CodeMirror","fromTextArea","setValue","_focus_await","focus","_set_inner_size","$width","_updateScrollSize","scrollTo","box","getWrapperElement","$height","style","scroll","getScrollerElement","$setSize","preserveUndoHistory","clearHistory","getValue","getEditor","waitEditor","undo","redo","undoLength","historySize","typeHash","go","javascript","markdown","python","sql","yaml","shell","EditorView","File","fileType","GetFileType","rows","left","right","cols","label","click","Save","gravity","Confirm","ClipName","ProgressBar","showProgress","read","_oldValue","finally","hideProgress","editorObj","TextChanged","Back","_changed","content","write","ChangeTextState","isEqual","button","fileNameSelectMask","input","extIndex","lastIndexOf","setSelectionRange","formatTemplate","toFixed","getLastSelected","safeName","trim","capitalize","charAt","toUpperCase","prompt","modal","head","borderless","elements","close","position","bottom","margin","validate","getTopParentView","form","getBody","newname","getValues","onShow","getInputNode","selectMask","sortDir","AddNewMenuView","_1","FoldersView","inputWidth","align","common","folder","$level","onBeforeContextMenu","Tree","Math","floor","used","total","timelineColor","Ready","Subscribe","GetFsStats","ContextMenu","GetRootId","open","showItem","force","getInfo","setValues","stats","GridView","grid","resizeColumn","headerOnly","sort","backIcon","backLabel","onBeforeSort","_by","dir","webix_ss_center_scroll","webix_column","columns","header","NameTemplate","fillspace","format","isNaN","longDateFormatStr","unselect","by","PreviewPopupView","fullscreen","IsVisible","Hide","SideTreeView","toolbarHeight","DoublePanelView","GetSource","_TrackChanges","trackActive","opath","npath","PanelSearchView","getRootName","PanelView","paddingX","tooltip","RenderPath","webix_fmanager_path_chunk","ChangePath","ProcessPath","uapi","getUploader","addDropZone","tempUrlData","dirs","rootName_1","htmlPath_1","chunkInd","newPath","InfoPreview","dateTimeFormat","dateToStr","mainInfo","k","extraInfo","tags","keyCol","valueCol","counter","cells","Tabview","ShowInfo","tabbar","getTabbar","infoId","counterId","SetInfo","SwitchTabs","extraInfo_1","getMeta","SetExtraInfo","fail","_isEmpty","tab","hideOption","showOption","PreviewView","FileInfo","minHeight","lastSelected","downloadIcon","previewUrl","player","info","overflow","_waitView","getPlayer","_player","Plyr","_initPlyr","setAttribute","media","_normalizeRatio","querySelector","source_setter","getPlyr","_gcdRatio","abs","clientWidth","clientHeight","div","ratio","MediaPreview","controls","node","ShowPreview","directLink","SetMedia","art","src","ext","TemplatePreview","setHTML","ProgressView","Config","done","cancel","disable","WaitClose","Counter","iterateAsync","arr","Close","Step","min","sizeTrigger","_compactValue","_compactWidth","_compactHandler","_checkTrigger","TopBarView","paddingY","autowidth","placeholder","optionWidth","conf","modes","getOption","TopView","fCompact","Compact","minWidth","maxWidth","panels","unshift","compactWidth","SetCompactMode","dummy","SideTree","PreviewPopup","TogglePreview","ToggleFolders","ShowMode","ShowSearch","handle","ShowProgress","PrevMode","side","Backend","_url","_features","_files","ajax","json","upload","readText","writeText","post","r","download","remove","makedir","makefile","to","rename","_info","resp","features","Cache","limit","_store","_limit","each","prune","rec","temp","delete","LocalData","fscache","TreeCollection","folders_ready","defaultDir","$row","fs","scheme","$change","prepareData","$serialize","serializeData","reload","$css","addFile","add","getFsPosition","order","findIndex","deleteFile","updateFile","oldId","newId","updateItem","changeId","defaultTree","UploadHandler","initUploader","initEvents","fileDialog","uploader","apiOnly","onAfterFileAdd","urlData","onFileUpload","onUploadComplete","$updateProgress","percent","Progress","$destructed","progress","Operations","backend","local","edit","makeFile","makeFolder","addToClipboard","paste","goUp","invalid","extractIds","title","removeConfirmMessage","reloadBranch","toRemove","eachChild","targetFolder","tfs","ids","clipboard","clearClipboard","up","App","forceCompact","zh","locales","jetapp","services","Upload","Rename","Open","Edit","Delete","Folder","Add New","My Files","Size","back to parent folder","Download","Type","Information","Table","Cards","Total","Are you sure ?","Details","Enter a new name","Add","Select something","Download file","Preview","Refresh","Are you sure you want to exit without saving?","Copy","Cut","Paste","Deleting...","Copying...","Moving...","Folders","Search results","Search results in","Search files and folders","Add new file","Add new folder","Upload file","archive","audio","image","video","of","Open item location","Are you sure you want to delete","these items:","this item:","Delete files","and","more file(s)","factory","trash","SourceHandlers","HandleDrag","stateSource","HandleDrop","DragMark","$dragMark","_marked","$dragOut","ot","nt","DataviewMixin","users","Users","TooltipControl","addTooltip","shared","circles","offst","user","email","avatarUrl","avatar","reverse","star","bar","visibleBatch","batch","ConfirmHistory","RestoreVersion","main","OnInit","Editor","diff","barLabel","DateFormat","prep","today","datePart","equal","getYear","btn","ShowHistory","SetBatch","showBatch","restore","SetVersionsButton","SpreadsheetView","editable","editaction","areaselect","load","ParseVersion","ResetDiffStyle","GetPrevVersion","StyleDiffCells","ResetTotalDiff","prevPath","ParseExcel","older","Diffs","CollectDiffs","DataDriver","excel","toObject","diffs","row","col","colId","columnId","getIdByIndex","editStop","toExcel","styles","spans","heights","writeBinary","navbar","trashing","fromTrash","addButton","enable","HistoryView","toolbar","check","labelWidth","labelRight","onChange","PrepareDates","ListTemplate","onAfterSelect","SetVersion","List","Diff","dateFormat","GetVersion","versions","origin","dateline","getLastId","curr","getNextId","backToFiles","menu","il","j","jl","file_1","many_1","viewable_1","editable_1","search_1","FilterCopyPaste","PopupView","small","stylesheet","bg","c","SharePopupView","suggest","InputListTemplate","rowHeight","yCount","webix_fmanager_remove_user","_e","RemoveUser","Done","Input","Data","getList","u","UpdateCounter","removeUser","user_1","share","ClearInput","random","getAvatar","randomColor","palette","TagsPopupView","onTimedKeyPress","FilterTags","AddTag","propertyItemHeight","TaglistTemplate","onBeforeEditStop","values","column","UpdateTag","color","data->onSyncApply","webix_fmanager_remove_tag","RemoveTag","Search","SetTaglistOverlay","_Input","toLowerCase","tag","addTag","editCell","updateTag","blockEvent","unblockEvent","removeTag","OverlayBox","ToggleOverlay","hideOverlay","showOverlay","DoublePanel","ProcessSource","RenderSource","CommentsView","mentions","currentUser","PrepareComments","listItem","templateAvatar","user_id","Comments","_id","AddComment","UpdateComment","RemoveComment","LoadComments","comments","ChangeListState","addComment","Silently","updateComment","deleteComment","operation","newValues","onItemClick","SearchTag","HandleTagUpdate","HandleColoring","HandleTagCreation","ReloadTags","tags_1","ftags","getTags","SetTagsSilent","mc","setTags","material","$renderTag","aria","removeItem","getPopup","className","popupList","lih","topbar","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","m16","del","filename","fd","FormData","_obj","margin-top","removePermanent","favour","serialize","unfavour","localtags","_app","userlist","users_ready","LocalUsers","Tags","taglist","tags_ready","LocalTags","Versions","fm.views","fm.services","fm.App","Favorite","Recent","Shared","Trash","Add to favorites","Remove from favorites","Share","Can view","Can edit","Share File","Invite someone...","Invite","Restore","Delete from trash","Restoring...","Empty trash","back to ","Select a user","Add a tag","No comments yet","No users","Available to","user(s)","Manage Tags","Press Enter to create a new tag","Click Add to create a new tag","Open tag settings","Type to search a tag","Show version history","Unsaved changes will be lost. Are you sure?","Last edited at","Last edited on","Back to editor","Version history","Show changes","Restored from","fm.locales"],"mappings":"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"}